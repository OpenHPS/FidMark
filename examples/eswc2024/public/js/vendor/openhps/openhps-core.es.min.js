/*! For license information please see openhps-core.es.min.js.LICENSE.txt */
var __webpack_modules__={25:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>DataSerializer});var events__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(187),events__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_0__),typedjson__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(606),_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(434),_Deserializer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(446),_Serializer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(141);typedjson__WEBPACK_IMPORTED_MODULE_1__.WR.getFromConstructor=function(e){if(!e)return;const t=e.prototype;if(null==t)return;let r;if(Object.prototype.hasOwnProperty.call(t,_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.META_FIELD))r=t[_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.META_FIELD];else{const t=Object.getPrototypeOf(e.prototype);if(!t)return;r=typedjson__WEBPACK_IMPORTED_MODULE_1__.WR.getFromConstructor(t.constructor)}if(!0===(null==r?void 0:r.isExplicitlyMarked))return r;if(typedjson__WEBPACK_IMPORTED_MODULE_1__.WR.doesHandleWithoutAnnotation(e)){const t=new typedjson__WEBPACK_IMPORTED_MODULE_1__.WR(e);return t.isExplicitlyMarked=!0,t}};class DataSerializer{static registerType(e,t){if(DataSerializer.knownTypes.set(e.name,e),t&&(DataSerializer.serializer.setSerializationStrategy(e,(e=>t.serializer(e,{fallback:(e,t)=>DataSerializer.serializer.convertSingleValue(e,t)}))),DataSerializer.deserializer.setDeserializationStrategy(e,(e=>t.deserializer(e,{fallback:(e,t)=>DataSerializer.deserializer.convertSingleValue(e,t,DataSerializer.knownTypes)}))),"Object"!==e.name)){const t=new typedjson__WEBPACK_IMPORTED_MODULE_1__.WR(e);t.isExplicitlyMarked=!0,e.prototype[_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.META_FIELD]=t}DataSerializer.eventEmitter.emit("registerType",e,t)}static getMetadata(e){return _DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.getMetadata(e)}static getRootMetadata(e){return _DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.getRootMetadata(e)}static findRootMetaInfo(e){return _DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.getRootMetadata(e)}static unregisterType(e){DataSerializer.knownTypes.delete(e.name),DataSerializer.eventEmitter.emit("unregisterType",e)}static findTypeByName(e){return DataSerializer.knownTypes.get(e)}static clone(e,t){return DataSerializer.deserialize(DataSerializer.serialize(e),t)}static serialize(e,t={}){var r;if(null==e)return;const i=Object.getPrototypeOf(e).constructor;if(!DataSerializer.findTypeByName(i.name)&&Array.isArray(e))return e.map(DataSerializer.serialize.bind(DataSerializer));return(null!==(r=t.serializer)&&void 0!==r?r:DataSerializer.serializer).convertSingleValue(e,_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.ensureTypeDescriptor(i),void 0,void 0,t)}static deserialize(e,t,r={}){var i;if("object"!=typeof e&&"function"!=typeof e||!e)return e;if(Array.isArray(e))return e.map((e=>DataSerializer.deserialize(e)));const n=null!==(i=r.deserializer)&&void 0!==i?i:DataSerializer.deserializer,s=null!=t?t:n.getTypeResolver()(e,DataSerializer.knownTypes);return n.convertSingleValue(e,_DataSerializerUtils__WEBPACK_IMPORTED_MODULE_2__.jL.ensureTypeDescriptor(s),DataSerializer.knownTypes,void 0,void 0,r)}}DataSerializer.knownTypes=new Map,DataSerializer.serializer=new _Serializer__WEBPACK_IMPORTED_MODULE_3__.e,DataSerializer.deserializer=new _Deserializer__WEBPACK_IMPORTED_MODULE_4__.Z,DataSerializer.eventEmitter=new events__WEBPACK_IMPORTED_MODULE_0__.EventEmitter,(()=>{DataSerializer.registerType(Object,{serializer:e=>Object.assign(Object.assign({},Object.keys(e).map((t=>({[t]:"function"==typeof e[t]?{function:e[t].toString(),__type:"Function"}:DataSerializer.serialize(e[t])}))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})),{__type:"Object"}),deserializer:objectJson=>Object.keys(objectJson).map((key=>"__type"===key?{}:{[key]:"object"==typeof objectJson[key]&&"Function"===objectJson[key].__type?eval(objectJson[key].function):DataSerializer.deserialize(objectJson[key])})).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})})})()},434:(e,t,r)=>{r.d(t,{eh:()=>TypeDescriptor,h2:()=>ConcreteTypeDescriptor,jL:()=>DataSerializerUtils});var i=r(606);class DataSerializerUtils{static get META_FIELD(){return"__typedJsonJsonObjectMetadataInformation__"}static getOwnMetadata(e){return i.WR.getFromConstructor(e instanceof Function?e:e.constructor)}static getMetadata(e){var t;return null!==(t=DataSerializerUtils.getOwnMetadata(e))&&void 0!==t?t:DataSerializerUtils.getRootMetadata(e)}static createMetadata(e){if(Object.prototype.hasOwnProperty.call(e,this.META_FIELD))return e[this.META_FIELD];const t=new i.WR(e.constructor),r=e[this.META_FIELD];return void 0!==r&&(r.dataMembers.forEach(((e,r)=>{t.dataMembers.set(r,e)})),r.knownTypes.forEach((r=>{r!==e.constructor&&r.prototype instanceof e.constructor&&t.knownTypes.add(r)})),r.knownTypes.add(t.classType),t.typeResolver=r.typeResolver,t.typeHintEmitter=r.typeHintEmitter),Object.defineProperty(e,this.META_FIELD,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}static getRootMetadata(e){const t=e instanceof Function?e.prototype:Object.getPrototypeOf(e);return t&&t[DataSerializerUtils.META_FIELD]?DataSerializerUtils.getRootMetadata(t):e[DataSerializerUtils.META_FIELD]}static ensureTypeDescriptor(e){return e instanceof TypeDescriptor?e:new ConcreteTypeDescriptor(e)}static getMemberOptions(e,t){const r=DataSerializerUtils.getMetadata(e);if(!r)return;const i=r.dataMembers.get(t);return i?i.options:void 0}static getIdentifierMemberOptions(e){const t=DataSerializerUtils.getMetadata(e);if(t)return Array.from(t.dataMembers.values()).filter((e=>e&&e.primaryKey))[0]}}class TypeDescriptor{constructor(e){this.ctor=e}getTypes(){return[this.ctor]}hasFriendlyName(){return"Object"!==this.ctor.name}}class ConcreteTypeDescriptor extends TypeDescriptor{constructor(e){super(e)}}},446:(e,t,r)=>{r.d(t,{Z:()=>Deserializer});var i=r(188),n=r(665),s=r(606),o=r(651),a=r(77),c=r(750);class Deserializer extends i.Z{typeResolver(e,t){var r;return void 0!==e.__type?t.get(e.__type):null!==(r=e.constructor)&&void 0!==r?r:Object}constructor(){super(),this.errorHandler=e=>{throw e.message=e.message.replace("@jsonObject","@SerializableObject()"),e.message=e.message.replace("@jsonMember","@SerializableMember()"),e.message=e.message.replace("@jsonSetMember","@SerializableSetMember()"),e.message=e.message.replace("@jsonMapMember","@SerializableMapMember()"),e.message=e.message.replace("@jsonArrayMember","@SerializableArrayMember()"),e},this.setDeserializationStrategy(Map,this.convertAsMap.bind(this)),this.setDeserializationStrategy(Array,this.convertAsArray.bind(this)),this.setDeserializationStrategy(Set,this.convertAsSet.bind(this)),this.setDeserializationStrategy(Uint8Array,c.o.fromHexString)}convertSingleValue(e,t,r,i,n,s){return this._convertSingleValue.bind(this)(e,t,r,i,n,s)}_convertSingleValue(e,t,r,i,n,s){if(this.retrievePreserveNull(n)&&null===e)return null;if(!(0,a.Jf)(e))return;const o=this.deserializationStrategy.get(t.ctor);if(void 0!==o)return o(e,t,r,i,this,n,s);if("object"==typeof e)return this.convertAsObject(e,t,r,i,this,n,s);let c=`Could not deserialize '${i}'; don't know how to deserialize type`;t.hasFriendlyName()&&(c+=` '${t.ctor.name}'`),this.errorHandler(new TypeError(`${c}.`))}convertAsObject(e,t,r,i,c,u,l){if("object"!=typeof e||null===e)return void c.getErrorHandler()(new TypeError(`Cannot deserialize ${i}: 'sourceObject' must be a defined object.`));let h=t.ctor,p=s.WR.getFromConstructor(h),_=c.getTypeResolver();void 0!==p&&null!=p.typeResolver&&(_=p.typeResolver);const d=_(e,r);if(null!=d&&(0,a.me)(d,h)&&(h=d,p=s.WR.getFromConstructor(d)),!0===(null==p?void 0:p.isExplicitlyMarked)){const t=p,s={},u=(0,o.JH)(c.options,t.options);let _;if(t.dataMembers.forEach(((i,h)=>{const p=e[h],_=`${(0,a.$0)(t.classType)}.${h}`,d=(0,o.JH)(u,i.options);let y;if(null!=i.deserializer)y=i.deserializer(p,{fallback:(e,t)=>c.convertSingleValue(e,(0,n._k)(t),r)});else{if(null==i.type)throw new TypeError(`Cannot deserialize ${_} there is no constructor nor deserialization function to use.`);y=c.convertSingleValue(p,i.type(),r,_,d,l)}(0,a.Jf)(y)||c.retrievePreserveNull(d)&&null===y?s[i.key]=y:!0===i.isRequired&&c.getErrorHandler()(new TypeError(`Missing required member '${_}'.`))})),"function"==typeof p.initializerCallback)try{if(_=p.initializerCallback(s,e),null==_)throw new TypeError(`Cannot deserialize ${i}: 'initializer' function returned undefined/null, but '${(0,a.$0)(p.classType)}' was expected.`);if(!(_ instanceof p.classType))throw new TypeError(`Cannot deserialize ${i}:'initializer' returned '${(0,a.$0)(_.constructor)}', but '${(0,a.$0)(p.classType)}' was expected, and '${(0,a.$0)(_.constructor)}' is not a subtype of '${(0,a.$0)(p.classType)}'`)}catch(e){return void c.getErrorHandler()(e)}else _=c.instantiateType(h);Object.assign(_,s);const d=p.onDeserializedMethodName;return null!=d&&("function"==typeof _[d]?_[d]():"function"==typeof _.constructor[d]?_.constructor[d]():c.getErrorHandler()(new TypeError(`onDeserialized callback'${(0,a.$0)(p.classType)}.${d}' is not a method.`))),_}{const t={};return Object.keys(e).forEach((i=>{t[i]=c.convertSingleValue(e[i],new n.h2(e[i].constructor),r,i,u,l)})),t}}convertAsArray(e,t,r,i,s,o,a){if(!(t instanceof n.GJ))throw new TypeError(`Could not deserialize ${i} as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);return Array.isArray(e)?null==t.elementType?(s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Array: missing constructor reference of Array elements.`)),[]):e.map(((e,n)=>{try{return s.convertSingleValue(e,t.elementType,r,`${i}[${n}]`,o,a)}catch(e){return void s.getErrorHandler()(e)}})):(s.getErrorHandler()(new TypeError(this.makeTypeErrorMessage(Array,e.constructor,i))),[])}convertAsSet(e,t,r,i,s,o,a){if(!(t instanceof n.do))throw new TypeError(`Could not deserialize ${i} as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(!Array.isArray(e))return s.getErrorHandler()(new TypeError(this.makeTypeErrorMessage(Array,e.constructor,i))),new Set;if(null==t.elementType)return s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Set: missing constructor reference of Set elements.`)),new Set;const c=new Set;return e.forEach(((e,n)=>{try{c.add(s.convertSingleValue(e,t.elementType,r,`${i}[${n}]`,o,a))}catch(e){s.getErrorHandler()(e)}})),c}convertAsMap(e,t,r,i,s,o,c){if(!(t instanceof n.br))throw new TypeError(`Could not deserialize ${i} as Map: incorrect TypeDescriptor detected,please use proper annotation or function for this type`);const u=t.getCompleteOptions().shape;if(!this.isExpectedMapShape(e,u)){const t=0===u?Array:Object;return s.getErrorHandler()(new TypeError(this.makeTypeErrorMessage(t,e.constructor,i))),new Map}if(null==t.keyType)return s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Map: missing key constructor.`)),new Map;if(null==t.valueType)return s.getErrorHandler()(new TypeError(`Could not deserialize ${i} as Map: missing value constructor.`)),new Map;const l=`${i}[].key`,h=`${i}[].value`,p=new Map;return"OBJECT"===u.name?Object.keys(e).forEach((i=>{try{const n=s.convertSingleValue(i,t.keyType,r,l,o,c);(0,a.Jf)(n)&&p.set(n,s.convertSingleValue(e[i],t.valueType,r,h,o,c))}catch(e){s.getErrorHandler()(e)}})):e.forEach((e=>{try{const i=s.convertSingleValue(e.key,t.keyType,r,l,o,c);(0,a.Jf)(i)&&p.set(i,s.convertSingleValue(e.value,t.valueType,r,h,o,c))}catch(e){s.getErrorHandler()(e)}})),p}isExpectedMapShape(e,t){return 0===t&&Array.isArray(e)||1===t&&"object"==typeof e}makeTypeErrorMessage(e,t,r){return`Could not deserialize ${r}: expected '${"function"==typeof e?(0,a.$0)(e):e}', got '${"function"==typeof t?(0,a.$0)(t):t}'.`}}},141:(e,t,r)=>{r.d(t,{e:()=>Serializer});var i=r(844),n=r(665),s=r(606),o=r(77),a=r(651),c=r(750);class Serializer extends i.e{constructor(){super(),this.errorHandler=e=>{throw e.message=e.message.replace("@jsonObject","@SerializableObject()"),e.message=e.message.replace("@jsonMember","@SerializableMember()"),e.message=e.message.replace("@jsonSetMember","@SerializableSetMember()"),e.message=e.message.replace("@jsonMapMember","@SerializableMapMember()"),e.message=e.message.replace("@jsonArrayMember","@SerializableArrayMember()"),e},this.setSerializationStrategy(Map,this.convertAsMap.bind(this)),this.setSerializationStrategy(Array,this.convertAsArray.bind(this)),this.setSerializationStrategy(Set,this.convertAsSet.bind(this)),this.setSerializationStrategy(Uint8Array,c.o.toHexString)}convertSingleValue(e,t,r,i,n){const s=this._convertSingleValue.bind(this)(e,t,r,i,n);return void 0===r&&"object"==typeof s&&(s.__type=t.ctor.name),s}_convertSingleValue(e,t,r,i,n){if(this.retrievePreserveNull(i)&&null===e)return null;if(!(0,o.Jf)(e))return;if(!(0,o.V9)(e,t.ctor)){const i=(0,o.$0)(t.ctor),n=(0,o.$0)(e.constructor);return void this.errorHandler(new TypeError(`Could not serialize '${r}': expected '${i}', got '${n}'.`))}const s=this.serializationStrategy.get(t.ctor);if(void 0!==s)return s(e,t,r,this,i,n);if("object"==typeof e)return this.convertAsObject(e,t,r,this,i,n);let a=`Could not serialize '${r}'; don't know how to serialize type`;t.hasFriendlyName()&&(a+=` '${t.ctor.name}'`),this.errorHandler(new TypeError(`${a}.`))}convertAsObject(e,t,r,i,c,u){let l,h,p=i.getTypeHintEmitter();if(l=e.constructor!==t.ctor&&e instanceof t.ctor?s.WR.getFromConstructor(e.constructor):s.WR.getFromConstructor(t.ctor),void 0===l)h=Object.assign({},e);else{const t=l.beforeSerializationMethodName;null!=t&&("function"==typeof e[t]?e[t]():"function"==typeof e.constructor[t]?e.constructor[t]():i.getErrorHandler()(new TypeError(`beforeSerialization callback '${(0,o.$0)(l.classType)}.${t}' is not a method.`)));const r=l;h={};const s=(0,a.JH)(i.options,r.options);null!=r.typeHintEmitter&&(p=r.typeHintEmitter),r.dataMembers.forEach((t=>{const c=(0,a.JH)(s,t.options);let l;if(null!=t.serializer)l=t.serializer(e[t.key],{fallback:(e,t)=>i.convertSingleValue(e,(0,n._k)(t))});else{if(null==t.type)throw new TypeError(`Could not serialize ${t.name}, there is no constructor nor serialization function to use.`);l=i.convertSingleValue(e[t.key],t.type(),`${(0,o.$0)(r.classType)}.${t.key}`,c,u)}(i.retrievePreserveNull(c)&&null===l||(0,o.Jf)(l))&&(h[t.name]=l)}))}return p(h,e,t.ctor,l),h}convertAsArray(e,t,r,i,s,a){if(!(t instanceof n.GJ))throw new TypeError(`Could not serialize ${r} as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(null==t.elementType)throw new TypeError(`Could not serialize ${r} as Array: missing element type definition.`);return e.forEach(((e,n)=>{if(!(i.retrievePreserveNull(s)&&null===e||(0,o.V9)(e,t.elementType.ctor))){const i=(0,o.$0)(t.elementType.ctor),s=e&&(0,o.$0)(e.constructor);throw new TypeError(`Could not serialize ${r}[${n}]: expected '${i}', got '${s}'.`)}})),e.map(((e,n)=>i.convertSingleValue(e,t.elementType,`${r}[${n}]`,s,a)))}convertAsSet(e,t,r,i,s,a){if(!(t instanceof n.do))throw new TypeError(`Could not serialize ${r} as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(null==t.elementType)throw new TypeError(`Could not serialize ${r} as Set: missing element type definition.`);r+="[]";const c=[];return e.forEach((e=>{const n=i.convertSingleValue(e,t.elementType,r,s,a);(0,o.Jf)(e)&&!(0,o.Jf)(n)||c.push(n)})),c}convertAsMap(e,t,r,i,s,a){if(!(t instanceof n.br))throw new TypeError(`Could not serialize ${r} as Map: incorrect TypeDescriptor detected, please use proper annotation or function for this type`);if(null==t.valueType)throw new TypeError(`Could not serialize ${r} as Map: missing value type definition.`);if(null==t.keyType)throw new TypeError(`Could not serialize ${r} as Map: missing key type definition.`);const c=`${r}[].key`,u=`${r}[].value`,l=t.getCompleteOptions().shape,h=1===l?{}:[],p=i.retrievePreserveNull(s);return e.forEach(((e,r)=>{const n={key:i.convertSingleValue(r,t.keyType,c,s,a),value:i.convertSingleValue(e,t.valueType,u,s,a)},_=(0,o.Jf)(n.key),d=null===n.value&&p||(0,o.Jf)(n.value);_&&d&&(1===l?h[n.key]=n.value:h.push(n))})),h}}},318:(e,t,r)=>{r.d(t,{_:()=>s});r(660);var i=r(255),n=r(337);function s(e){return(t,r)=>{const s=(0,n.W5)(t,r,e);(0,i.R)(s)(t,r),(0,n.EB)(t,r,s)}}},120:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>SerializableMemberFunction});var _SerializableMember__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(318),_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(337);function SerializableMemberFunction(options={}){return(target,propertyKey)=>{options.serializer=e=>e.toString(),options.deserializer=fnStr=>eval(fnStr);const finalOptions=(0,_utils__WEBPACK_IMPORTED_MODULE_0__.W5)(target,propertyKey,options);(0,_SerializableMember__WEBPACK_IMPORTED_MODULE_1__._)(finalOptions)(target,propertyKey),(0,_utils__WEBPACK_IMPORTED_MODULE_0__.EB)(target,propertyKey,finalOptions)}}},337:(e,t,r)=>{r.d(t,{Cn:()=>_,EB:()=>c,W5:()=>h,hs:()=>u});var i=r(606),n=r(665),s=r(25),o=r(434);const a=r(465);function c(e,t,r){var a,c;const u=Reflect.getMetadata("design:type",e,t);if(r){const n=i.WR.ensurePresentInPrototype(e),s=o.jL.getRootMetadata(e.constructor),u=n.dataMembers.get(t)||n.dataMembers.get(r.name),l=s?s.dataMembers.get(t)||s.dataMembers.get(r.name):void 0;if(!u)throw new Error(`Unable to get member metadata for ${e} on property ${t}!`);u.options=p(null!==(a=u.options)&&void 0!==a?a:{},r),l&&(u.options=p(null!==(c=l.options)&&void 0!==c?c:{},u.options)),s.knownTypes.forEach((n=>{var s,a;if(n===e||e instanceof n)return;const c=null!==(s=o.jL.getMetadata(n))&&void 0!==s?s:i.WR.ensurePresentInPrototype(n),l=c.dataMembers.get(t)||c.dataMembers.get(r.name);l&&(l.options=p(null!==(a=u.options)&&void 0!==a?a:{},l.options))}))}const l=i.WR.ensurePresentInPrototype(e).dataMembers.get(r&&r.name||t);u!==Object||r&&(r.deserializer||Object.keys(r).includes("constructor"))?l&&"object"!=typeof r&&l.type()instanceof o.h2&&(l.type=()=>new o.h2(u)):(l.serializer=e=>s.C.serialize(e),l.deserializer=e=>s.C.deserialize(e),l.type=()=>n.IK)}function u(e,t){var r,i,n;const a=o.jL.getMetadata(e),c=o.jL.getRootMetadata(e.prototype);c.knownTypes.add(e),c.initializerCallback&&!a.initializerCallback&&(a.initializerCallback=c.initializerCallback),t&&(a.options=p(a===c?null!==(r=a.options)&&void 0!==r?r:{}:null!==(n=null!==(i=a.options)&&void 0!==i?i:c.options)&&void 0!==n?n:{},t),c.knownTypes.forEach((t=>{var r;if(t===e||!(t.prototype instanceof e))return;const i=o.jL.getMetadata(t);i.options=p(null!==(r=a.options)&&void 0!==r?r:{},i.options),!i.initializerCallback&&a.initializerCallback&&(i.initializerCallback=a.initializerCallback)}))),c.knownTypes.forEach((t=>{if(t===e||!(e.prototype instanceof t))return;const r=o.jL.getMetadata(t);r&&r.initializerCallback&&!a.initializerCallback&&(a.initializerCallback=r.initializerCallback)})),s.C.registerType(e)}function l(e){return e&&"object"==typeof e&&!Array.isArray(e)}function h(e,t,r){if("function"==typeof r)return r;const i=o.jL.getMemberOptions(e.constructor,t);return i?p(i,r):r}function p(e,t){const r=a(e);return l(e)&&l(t)&&Object.keys(t).forEach((i=>{if(Array.isArray(t[i])){r[i]=t[i];const n=void 0!==e[i]?Array.isArray(e[i])?e[i]:[e[i]]:[];r[i].push(...n.filter((e=>!t[i].includes(e))))}else l(t[i])?i in e?r[i]=p(e[i],t[i]):Object.assign(r,{[i]:t[i]}):Object.assign(r,{[i]:t[i]})})),r}const _={cloneDeep:a,mergeDeep:p}},154:(e,t,r)=>{r.d(t,{Sb:()=>Tt,WW:()=>zt,AO:()=>xt,dE:()=>ke,Rb:()=>mt,tF:()=>Xe,M3:()=>bt,DO:()=>V,Yv:()=>B,RM:()=>qt,PX:()=>Kt,vA:()=>AccuracyModifierNode,WV:()=>Nt,cW:()=>Pt,KL:()=>E,dt:()=>$,m0:()=>N,lp:()=>de,wl:()=>BalanceNode,qz:()=>BufferNode,oY:()=>dt.o,DX:()=>Me,IS:()=>Ee,Fw:()=>CalibrationNode,hX:()=>CalibrationService,yS:()=>CallbackNode,jg:()=>CallbackSinkNode,PR:()=>CallbackSourceNode,mt:()=>CellIdentificationNode,h2:()=>h.h2,NE:()=>qe,U9:()=>DataFrameService,Lo:()=>Ne,J1:()=>DataObjectService,CO:()=>l.C,jL:()=>h.jL,Do:()=>De,yW:()=>Ae,x9:()=>x,ZK:()=>Jt.Z,mW:()=>DummyDataService,sx:()=>DummyService,qv:()=>EMAFilterNode,yt:()=>we,kS:()=>Edge,US:()=>pe,dD:()=>FilterProcessingNode,M$:()=>FrameChunkNode,Kq:()=>FrameCloneNode,To:()=>FrameDelayNode,cm:()=>FrameFilterNode,fj:()=>FrameFlattenNode,HW:()=>FrameMergeNode,_N:()=>ve,sX:()=>Dt,iX:()=>GraphBuilder,tg:()=>GraphShapeBuilder,ym:()=>GraphShapeNode,vM:()=>vt,ad:()=>gt,zd:()=>ge,JG:()=>HPFilterNode,SQ:()=>HistorySourceNode,Dn:()=>Ht,M0:()=>KalmanFilter,su:()=>KalmanFilterNode,_v:()=>KeyValueDataService,Mj:()=>LPFilterNode,MD:()=>w,Mn:()=>wt,uE:()=>q,v5:()=>St,hi:()=>G,Nv:()=>ListSourceNode,xJ:()=>LocationBasedService,WA:()=>LoggingSinkNode,cN:()=>st,to:()=>at,iz:()=>xe,rE:()=>Et,Oy:()=>tt,N7:()=>kt,Vk:()=>_t,yG:()=>le,n:()=>MemoryBufferNode,Zs:()=>MemoryDataService,oF:()=>MemoryQueryEvaluator,KH:()=>MergeShape,gm:()=>ModelBuilder,Nx:()=>ModelSerializer,od:()=>MultilaterationNode,NB:()=>ze,Z5:()=>Le,IG:()=>NodeDataService,sw:()=>u,Ko:()=>ObjectMergeNode,rQ:()=>ObjectProcessingNode,i5:()=>me,DJ:()=>Vt,wD:()=>Gt,jU:()=>ut,xk:()=>Ve,cS:()=>PropertyFilterProcessingNode,FD:()=>PushError,_f:()=>ye,kG:()=>We,ow:()=>ReferenceSpaceConversionNode,MV:()=>Ot,_o:()=>Ct,E4:()=>Rt,Hd:()=>It,N1:()=>Ut,vZ:()=>Ft,ur:()=>jt,FW:()=>Mt,Zi:()=>Se,EU:()=>RelativePositionFilter,Qm:()=>RelativePositionProcessing,VF:()=>RemoteNode,K2:()=>ar,Zk:()=>RemoteServiceProxy,qH:()=>RemoteSinkNode,Mg:()=>RemoteSourceNode,Ms:()=>SMAFilterNode,wK:()=>yt,ci:()=>ft,GO:()=>W,hZ:()=>ue,bc:()=>He,_J:()=>s._,X:()=>F.X,iN:()=>_,F6:()=>Wt,Cn:()=>p.Cn,ei:()=>Qt.e,t6:()=>U,cb:()=>Ke,sh:()=>SourceMergeNode,lW:()=>Je,In:()=>$t,kU:()=>it,Bx:()=>ThrottleNode,OY:()=>L,$i:()=>TimeSyncNode,j1:()=>S,wz:()=>TimedPullNode,D_:()=>Lt,Op:()=>TrajectoryService,as:()=>TriangulationNode,eh:()=>h.eh,r5:()=>ir,hb:()=>or,fb:()=>v,A8:()=>UnitConversionNode,O7:()=>UnitPrefix,Zw:()=>Ze,FM:()=>lt,P:()=>m,Lt:()=>ht,Mk:()=>K,Yc:()=>WorkerHandler,cX:()=>WorkerNode,o8:()=>WorkerServiceProxy,W5:()=>p.W5,EB:()=>p.EB,hs:()=>p.hs});var i={};r.r(i),r.d(i,{AnyT:()=>oe.IK,ArrayT:()=>oe.AJ,ArrayTypeDescriptor:()=>oe.GJ,JsonObjectMetadata:()=>o.WR,MapT:()=>oe.mY,MapTypeDescriptor:()=>oe.br,SetT:()=>oe.zc,SetTypeDescriptor:()=>oe.do,TypedJSON:()=>Xt,defaultTypeEmitter:()=>Yt.C,defaultTypeResolver:()=>Zt.m,jsonArrayMember:()=>ae,jsonMapMember:()=>$e,jsonMember:()=>er.R,jsonObject:()=>c,jsonSetMember:()=>Bt,toJson:()=>tr});r(660);var n=r(582),s=r(318),o=r(606),a=r(651);function c(e){var t;function r(e){var r=o.WR.ensurePresentInPrototype(e.prototype);r.isExplicitlyMarked=!0,r.onDeserializedMethodName=t.onDeserialized,r.beforeSerializationMethodName=t.beforeSerialization,null!=t.typeResolver&&(r.typeResolver=t.typeResolver),null!=t.typeHintEmitter&&(r.typeHintEmitter=t.typeHintEmitter),r.initializerCallback=t.initializer,null!=t.name&&(r.name=t.name);var i=(0,a.M3)(t);void 0!==i&&(r.options=i),null!=t.knownTypes&&t.knownTypes.filter((function(e){return Boolean(e)})).forEach((function(e){return r.knownTypes.add(e)}))}if(t="function"==typeof e?{}:null!=e?e:{},"function"!=typeof e)return r;r(e)}var u,l=r(25),h=r(434),p=r(337);function _(e){return t=>{h.jL.createMetadata(t.prototype),c(e)(t),l.C.eventEmitter.emit("updateSerializableObject",t,e),(0,p.hs)(t,e)}}class UnitPrefix{constructor(e,t,r){this.name=e,this.abbrevation=t,this.magnitude=r}get namePattern(){return new RegExp(`/^${this.name}/g`)}get abbrevationPattern(){return new RegExp(`/^${this.abbrevation}/g`)}}UnitPrefix.DECA=new UnitPrefix("deca","da",10),UnitPrefix.HECTO=new UnitPrefix("hecto","h",100),UnitPrefix.KILO=new UnitPrefix("kilo","k",1e3),UnitPrefix.MEGA=new UnitPrefix("mega","M",1e6),UnitPrefix.GIGA=new UnitPrefix("giga","G",1e9),UnitPrefix.TERA=new UnitPrefix("tera","T",1e12),UnitPrefix.PETA=new UnitPrefix("peta","P",1e15),UnitPrefix.EXA=new UnitPrefix("exa","E",1e18),UnitPrefix.ZETTA=new UnitPrefix("zetta","Z",1e21),UnitPrefix.YOTTA=new UnitPrefix("yotta","Y",1e24),UnitPrefix.DECI=new UnitPrefix("deci","d",.1),UnitPrefix.CENTI=new UnitPrefix("centi","c",.01),UnitPrefix.MILLI=new UnitPrefix("milli","m",.001),UnitPrefix.MICRO=new UnitPrefix("micro","u",1e-6),UnitPrefix.NANO=new UnitPrefix("nano","n",1e-9),UnitPrefix.PICO=new UnitPrefix("pico","p",1e-12),UnitPrefix.FEMTO=new UnitPrefix("femto","f",1e-15),UnitPrefix.ATTO=new UnitPrefix("atto","a",1e-18),UnitPrefix.ZEPTO=new UnitPrefix("zepto","z",1e-21),UnitPrefix.YOCTO=new UnitPrefix("yocto","y",1e-24),UnitPrefix.DECIMAL=[UnitPrefix.DECA,UnitPrefix.HECTO,UnitPrefix.KILO,UnitPrefix.MEGA,UnitPrefix.GIGA,UnitPrefix.TERA,UnitPrefix.PETA,UnitPrefix.EXA,UnitPrefix.ZETTA,UnitPrefix.YOTTA,UnitPrefix.DECI,UnitPrefix.CENTI,UnitPrefix.MILLI,UnitPrefix.MICRO,UnitPrefix.NANO,UnitPrefix.PICO,UnitPrefix.FEMTO,UnitPrefix.ATTO,UnitPrefix.ZEPTO,UnitPrefix.YOCTO],function(e){e[e.INTEGER=0]="INTEGER",e[e.FLOAT=1]="FLOAT",e[e.DOUBLE=2]="DOUBLE",e[e.DECIMAL=3]="DECIMAL",e[e.LONG=4]="LONG",e[e.SHORT=5]="SHORT"}(u||(u={}));Math.PI,Math.PI;function d(e,t,r){return Math.max(t,Math.min(r,e))}class Quaternion_Quaternion{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,o){let a=r[i+0],c=r[i+1],u=r[i+2],l=r[i+3];const h=n[s+0],p=n[s+1],_=n[s+2],d=n[s+3];if(0===o)return e[t+0]=a,e[t+1]=c,e[t+2]=u,void(e[t+3]=l);if(1===o)return e[t+0]=h,e[t+1]=p,e[t+2]=_,void(e[t+3]=d);if(l!==d||a!==h||c!==p||u!==_){let e=1-o;const t=a*h+c*p+u*_+l*d,r=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const n=Math.sqrt(i),s=Math.atan2(n,t*r);e=Math.sin(e*s)/n,o=Math.sin(o*s)/n}const n=o*r;if(a=a*e+h*n,c=c*e+p*n,u=u*e+_*n,l=l*e+d*n,e===1-o){const e=1/Math.sqrt(a*a+c*c+u*u+l*l);a*=e,c*=e,u*=e,l*=e}}e[t]=a,e[t+1]=c,e[t+2]=u,e[t+3]=l}static multiplyQuaternionsFlat(e,t,r,i,n,s){const o=r[i],a=r[i+1],c=r[i+2],u=r[i+3],l=n[s],h=n[s+1],p=n[s+2],_=n[s+3];return e[t]=o*_+u*l+a*p-c*h,e[t+1]=a*_+u*h+c*l-o*p,e[t+2]=c*_+u*p+o*h-a*l,e[t+3]=u*_-o*l-a*h-c*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,i=e._y,n=e._z,s=e._order,o=Math.cos,a=Math.sin,c=o(r/2),u=o(i/2),l=o(n/2),h=a(r/2),p=a(i/2),_=a(n/2);switch(s){case"XYZ":this._x=h*u*l+c*p*_,this._y=c*p*l-h*u*_,this._z=c*u*_+h*p*l,this._w=c*u*l-h*p*_;break;case"YXZ":this._x=h*u*l+c*p*_,this._y=c*p*l-h*u*_,this._z=c*u*_-h*p*l,this._w=c*u*l+h*p*_;break;case"ZXY":this._x=h*u*l-c*p*_,this._y=c*p*l+h*u*_,this._z=c*u*_+h*p*l,this._w=c*u*l-h*p*_;break;case"ZYX":this._x=h*u*l-c*p*_,this._y=c*p*l+h*u*_,this._z=c*u*_-h*p*l,this._w=c*u*l+h*p*_;break;case"YZX":this._x=h*u*l+c*p*_,this._y=c*p*l+h*u*_,this._z=c*u*_-h*p*l,this._w=c*u*l-h*p*_;break;case"XZY":this._x=h*u*l-c*p*_,this._y=c*p*l-h*u*_,this._z=c*u*_+h*p*l,this._w=c*u*l+h*p*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],o=t[5],a=t[9],c=t[2],u=t[6],l=t[10],h=r+o+l;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(u-a)*e,this._y=(n-c)*e,this._z=(s-i)*e}else if(r>o&&r>l){const e=2*Math.sqrt(1+r-o-l);this._w=(u-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(n+c)/e}else if(o>l){const e=2*Math.sqrt(1+o-r-l);this._w=(n-c)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+u)/e}else{const e=2*Math.sqrt(1+l-r-o);this._w=(s-i)/e,this._x=(n+c)/e,this._y=(a+u)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(d(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,n=e._z,s=e._w,o=t._x,a=t._y,c=t._z,u=t._w;return this._x=r*u+s*o+i*c-n*a,this._y=i*u+s*a+n*o-r*c,this._z=n*u+s*c+r*a-i*o,this._w=s*u-r*o-i*a-n*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,i=this._y,n=this._z,s=this._w;let o=s*e._w+r*e._x+i*e._y+n*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*r+t*this._x,this._y=e*i+t*this._y,this._z=e*n+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(a),u=Math.atan2(c,o),l=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=s*l+this._w*h,this._x=r*l+this._x*h,this._y=i*l+this._y*h,this._z=n*l+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3_Vector3{constructor(e=0,t=0,r=0){Vector3_Vector3.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(f.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(f.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,o=e.z,a=e.w,c=2*(s*i-o*r),u=2*(o*t-n*i),l=2*(n*r-s*t);return this.x=t+a*c+s*l-o*u,this.y=r+a*u+o*c-n*l,this.z=i+a*l+n*u-s*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,n=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-n*o,this.y=n*s-r*a,this.z=r*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return y.copy(this).projectOnVector(e),this.sub(y)}reflect(e){return this.sub(y.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(d(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const y=new Vector3_Vector3,f=new Quaternion_Quaternion;let m=class Vector3 extends Vector3_Vector3{static fromArray(e){return(new this).fromArray(e)}static fromVector(e){return new this(e.x,e.y,e.z)}clone(){return(new this.constructor).copy(this)}};var b;(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],m.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],m.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],m.prototype,"z",void 0),m=(0,n.gn)([_()],m);let v=b=class Unit{constructor(e,t){this._definitions=new Map,this._prefixType="none",this._aliases=[];const r=t||{baseName:void 0};r.aliases=r.aliases||[],r.prefixes=r.prefixes||"none",r.definitions=r.definitions||[],this._name=e||r.name,this._baseName=r.baseName,this._aliases=r.aliases,this._prefixType=r.prefixes,r.definitions.forEach(this._initDefinition.bind(this)),this.name&&b.registerUnit(this,r.override)}static fromJSON(e){if(void 0!==e.name){const t=b.findByName(e.name);if(!t)throw new Error(`Unit with name '${e.name}' not found! Unable to deserialize!`);return t}throw new Error("Unit does not define a serialization name! Unable to deserialize!")}_initDefinition(e){const t=b.findByName(e.unit,this.baseName),r=t?t.name:e.unit;"toUnit"in e?this._initFunctionDefinition(e,r):this._initBasicDefinition(e,r)}_initFunctionDefinition(e,t){const r=e;this._definitions.set(t,r)}_initBasicDefinition(e,t){const r=Object.keys(e),i=e,n=r.indexOf("magnitude"),s=r.indexOf("offset"),o=i.magnitude||1,a=void 0!==i.offset?i.offset:0;let c,u;-1===n||s<n?(c=e=>(e+a)*o,u=e=>e/o-a):(c=e=>e*o+a,u=e=>(e-a)/o),this._definitions.set(t,{unit:i.unit,toUnit:c,fromUnit:u})}get name(){return this._name}set name(e){this._name=e;const t=b.findByName(e);t&&(this._baseName=t.baseName,this._definitions=t._definitions,this._prefixType=t._prefixType,this._aliases=t._aliases)}get aliases(){return this._aliases}get baseName(){return this._baseName}get prefixType(){return this._prefixType}get definitions(){return Array.from(this._definitions.values())}get prefixes(){switch(this._prefixType){case"decimal":return UnitPrefix.DECIMAL;case"none":return[]}}createBaseDefinition(){let e;const t=b.UNIT_BASES.get(this.baseName);if(this._definitions.has(t)){const r=this._definitions.get(t);e=r}else this._definitions.forEach((t=>{const r=b.findByName(t.unit,this.baseName).createBaseDefinition();r&&(e={unit:r.unit,toUnit:e=>r.toUnit(t.toUnit(e)),fromUnit:e=>t.fromUnit(r.fromUnit(e))})}));return e}createDefinition(e){let t;const r=b.UNIT_BASES.get(this.baseName),i=b.findByName(r);if(this._definitions.has(e.name)){t=this._definitions.get(e.name)}else if(e._definitions.has(this.name)){const r=e._definitions.get(this.name);t={inputType:r.inputType,outputType:r.outputType,unit:e.name,toUnit:r.fromUnit,fromUnit:r.toUnit},this._definitions.set(e.name,t)}else if(i.name!==this.name){const n=this._definitions.get(r),s=i.createDefinition(e);n&&s&&(t={inputType:n.inputType,outputType:n.outputType,unit:e.name,toUnit:e=>s.toUnit(n.toUnit(e)),fromUnit:e=>n.fromUnit(s.fromUnit(e))},this._definitions.set(e.name,t))}return t}specifier(e){const t=`${e.name}${this.name}`;if(b.UNITS.has(t))return b.UNITS.get(t);if(!this.prefixes.includes(e))throw new Error(`Prefix '${e.name}' is not allowed for this unit!`);const r=new(0,Object.getPrototypeOf(this).constructor);r._name=t,r._baseName=this.baseName;const i=[];return this.aliases.forEach((t=>{i.push(`${e.name}${t}`),i.push(`${e.abbrevation}${t}`)})),r._aliases=i,r._definitions.set(this.name,{unit:this.name,toUnit:t=>t*e.magnitude,fromUnit:t=>t/e.magnitude}),b.registerUnit(r)}findByName(e){for(const t of this.aliases.concat(this.name)){if(e===t)return this;if(e.endsWith(t))for(const t of this.prefixes)if(e.match(t.abbrevationPattern)||e.match(t.namePattern))return this.specifier(t)}}static findByName(e,t){if(void 0!==e){if(b.UNITS.has(e))return b.UNITS.get(e);for(const[,r]of b.UNITS){if(t&&t!==r.baseName)continue;const i=r.findByName(e);if(i)return i}}}convert(e,t){const r=t instanceof b?t:b.findByName(t,this.baseName);if(!r||r.name===this.name)return e;const i=this.createDefinition(r);if(i)return e instanceof m&&i.inputType!==m?e.clone().fromArray([i.toUnit(e.x),i.toUnit(e.y),i.toUnit(e.z)]):i.toUnit(e);throw new Error(`No conversion definition found from '${this.name}' to '${r.name}'!`)}static convert(e,t,r){return("string"==typeof t?b.findByName(t):t).convert(e,r)}static registerUnit(e,t=!1){if(!e.name)return e;b.UNITS.has(e.name)&&!t||b.UNITS.set(e.name,e);const r=e.baseName?e.baseName:e.name,i=b.UNIT_BASES.get(r);if(i){const t=b.findByName(i,r).createDefinition(e),n=e.createBaseDefinition();t||e._definitions.set(i,n)}else b.UNIT_BASES.set(r,e.name);return e}};var g;v.UNIT_BASES=new Map,v.UNITS=new Map,v.UNKNOWN=new b("unknown"),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String),(0,n.w6)("design:paramtypes",[String])],v.prototype,"name",null),v=b=(0,n.gn)([_({initializer:v.fromJSON}),(0,n.w6)("design:paramtypes",[String,Object])],v);let w=g=class LengthUnit extends v{};w.METER=new g("meter",{baseName:"length",aliases:["m","meters"],prefixes:"decimal"}),w.CENTIMETER=g.METER.specifier(UnitPrefix.CENTI),w.MILLIMETER=g.METER.specifier(UnitPrefix.MILLI),w.KILOMETER=g.METER.specifier(UnitPrefix.KILO),w.MILE=new g("mile",{baseName:"length",aliases:["mil","miles"],definitions:[{unit:"meter",magnitude:1609.344}]}),w=g=(0,n.gn)([_()],w);let x=class DerivedUnit extends v{constructor(){super(...arguments),this._units=new Map,this._unitPower=new Map}addUnit(e,t){if(this._units.has(e.baseName))throw new Error(`A unit with base name '${e.baseName}' already exists for this unit!`);return this._units.set(e.baseName,e),this._unitPower.set(e.baseName,t),this}swap(e,t){if(v.UNITS.has(t.name))return v.UNITS.get(t.name);const r=new(0,Object.getPrototypeOf(this).constructor);r._name=t.name,r._baseName=this.baseName,r._aliases=t.aliases?t.aliases:[];const i={unit:this.name,toUnit:void 0,fromUnit:void 0};return e.forEach((e=>{const t=this._units.get(e.baseName),r=this._unitPower.get(e.baseName),n=e.createDefinition(t),s=e=>Math.pow(n.toUnit(e),r),o=e=>Math.pow(n.fromUnit(e),r),a=i.toUnit,c=i.fromUnit;a&&c?(i.toUnit=e=>a(s(e)),i.fromUnit=e=>c(o(e))):(i.toUnit=s,i.fromUnit=o)})),r._definitions.set(this.name,i),v.registerUnit(r)}};var M;x=(0,n.gn)([_()],x);let E=M=class AngleUnit extends v{};var k;E.RADIAN=new M("radian",{baseName:"angle",aliases:["rad","rads","radians"]}),E.DEGREE=new M("degree",{baseName:"angle",aliases:["deg","degs","degrees"],definitions:[{magnitude:Math.PI/180,unit:"rad"}]}),E=M=(0,n.gn)([_()],E);let S=k=class TimeUnit extends v{};var P;S.SECOND=new k("second",{baseName:"time",aliases:["s","sec","seconds"],prefixes:"decimal"}),S.MILLISECOND=k.SECOND.specifier(UnitPrefix.MILLI),S.MICROSECOND=k.SECOND.specifier(UnitPrefix.MICRO),S.NANOSECOND=k.SECOND.specifier(UnitPrefix.NANO),S.MINUTE=new k("minute",{baseName:"time",aliases:["m","min","minutes"],definitions:[{magnitude:60,unit:"s"}]}),S.HOUR=new k("hour",{baseName:"time",aliases:["h","hr","hrs","hours"],definitions:[{magnitude:3600,unit:"s"},{magnitude:60,unit:"min"}]}),S=k=(0,n.gn)([_()],S);let N=P=class AngularVelocityUnit extends x{};N.RADIAN_PER_SECOND=new P("radian per second",{baseName:"angularvelocity",aliases:["rad/s","radians per second"]}).addUnit(E.RADIAN,1).addUnit(S.SECOND,-1),N.DEGREE_PER_SECOND=P.RADIAN_PER_SECOND.swap([E.DEGREE],{baseName:"angularvelocity",name:"degree per second",aliases:["deg/s","degrees per second"]}),N.RADIAN_PER_MINUTE=P.RADIAN_PER_SECOND.swap([S.MINUTE],{baseName:"angularvelocity",name:"radian per minute",aliases:["rad/min","radian per minute"]}),N.DEGREE_PER_MINUTE=P.RADIAN_PER_SECOND.swap([E.DEGREE,S.MINUTE],{baseName:"angularvelocity",name:"degree per minute",aliases:["deg/min","degrees per minute"]}),N=P=(0,n.gn)([_()],N);var T=r(187);class AsyncEventEmitter extends T.EventEmitter{emitAsync(e,...t){return new Promise(((r,i)=>{const n=this.listeners(e);if(0===n.length)return r(!1);const s=[];n.forEach((e=>{s.push(e(...t))})),Promise.all(s).then((()=>{r(!0)})).catch(i)}))}}const z={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let A;const D=new Uint8Array(16);function O(){if(!A&&(A="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!A))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(D)}const C=[];for(let e=0;e<256;++e)C.push((e+256).toString(16).slice(1));function j(e,t=0){return C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]}const R=function(e,t,r){if(z.randomUUID&&!t&&!e)return z.randomUUID();const i=(e=e||{}).random||(e.rng||O)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=i[e];return t}return j(i)};let U=class Service extends AsyncEventEmitter{constructor(e={}){var t;super(),this._ready=!1,this.uid=null!==(t=e.uid)&&void 0!==t?t:this.constructor.name,this.prependOnceListener("ready",(()=>{this._ready=!0}))}generateUUID(){return R()}setUID(e){return this.uid=e,this}isReady(){return this._ready}emit(e,...t){return super.emit(e,...t)}once(e,t){return"ready"===e&&this.isReady()?(t(),this):super.once(e,t)}logger(e,t,r){this.model&&this.model.logger(e,t,r)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],U.prototype,"uid",void 0),U=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],U);var I,F=r(120);let L=I=class TimeService extends U{constructor(e,t=S.MILLISECOND){super(),this._timeCallback=e,this._timeUnit=t,this.uid=this.constructor.name,I._defaultTimeCallback||I.initialize(),this._timeCallback?(I._defaultTimeCallback=e,I._defaultUnit=t):(this._timeCallback=I.now,this._timeUnit=I.getUnit())}get isDefault(){return I._defaultTimeCallback===this._timeCallback}set isDefault(e){e&&(I._defaultTimeCallback=this._timeCallback,I._defaultUnit=this._timeUnit)}static initialize(){I._defaultTimeCallback=Date.now,I._defaultUnit=S.MILLISECOND;try{const e=r(801);e.now&&(I._defaultTimeCallback=e.now,I._defaultUnit=S.MICROSECOND)}catch(e){return}}getTime(){return this._timeCallback()}getUnit(){return this._timeUnit}static now(){return I._defaultTimeCallback||I.initialize(),I._defaultTimeCallback()}static getUnit(){return I._defaultTimeCallback||I.initialize(),I._defaultUnit}};(0,n.gn)([(0,F.X)(),(0,n.w6)("design:type",Function)],L.prototype,"_timeCallback",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",S)],L.prototype,"_timeUnit",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Boolean),(0,n.w6)("design:paramtypes",[Boolean])],L.prototype,"isDefault",null),L=I=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Function,S])],L);let V=class Accuracy{constructor(e,t){this.value=e,this._unit=t}to(e){if(!e)throw new Error(`${this.constructor.name} does not have a unit to convert from!`);const t=this.value;if(!(t instanceof m)&&"number"!=typeof t)throw new Error(`${this.constructor.name} can not be converted!`);const r=this.unit.convert(t,e);return new this.constructor(r,e)}get unit(){return this._unit}clone(){const e=new this.constructor;return e.value=this.value,e._unit=this._unit,e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],V.prototype,"value",void 0),(0,n.gn)([(0,s._)({name:"unit"}),(0,n.w6)("design:type",v)],V.prototype,"_unit",void 0),V=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object])],V);let B=class Accuracy1D extends V{constructor(e,t){super(e,t)}valueOf(){return this.value.valueOf()}toString(){return this.valueOf().toString()}};(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],B.prototype,"value",void 0),B=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Object])],B);let W=class SensorValue extends m{constructor(e,t,r,i,n,s){var o;i&&n?(super(i.convert(e||0,n),i.convert(t||0,n),i.convert(r||0,n)),this._defaultUnit=n):super(e,t,r),this.unit=null!==(o=null!=n?n:i)&&void 0!==o?o:v.UNKNOWN,this.timestamp=L.now(),this.accuracy=s||new B(1,this._defaultUnit||v.UNKNOWN)}setAccuracy(e){return this.accuracy="number"==typeof e?new B(e,this._defaultUnit):e,this}toTuple(e){return e?[this.unit.convert(this.x,e),this.unit.convert(this.y,e),this.unit.convert(this.z,e)]:this.toArray()}clone(){const e=super.clone();return e.accuracy=this.accuracy,e.timestamp=this.timestamp,e}};(0,n.gn)([(0,s._)({isRequired:!1,numberType:u.LONG}),(0,n.w6)("design:type",Number)],W.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)({isRequired:!1}),(0,n.w6)("design:type",V)],W.prototype,"accuracy",void 0),(0,n.gn)([(0,s._)((()=>v)),(0,n.w6)("design:type",Object)],W.prototype,"unit",void 0),W=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,v,Object,V])],W);let $=class AngularVelocity extends W{constructor(e,t,r,i=N.RADIAN_PER_SECOND){super(e,t,r,i,N.RADIAN_PER_SECOND)}static fromArray(e,t=N.RADIAN_PER_SECOND){return new this(e[0],e[1],e[2],t)}};var H;(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",N)],$.prototype,"unit",void 0),$=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],$);let G=H=class LinearVelocityUnit extends x{};G.METER_PER_SECOND=new H("meter per second",{baseName:"linearvelocity",aliases:["m/s","meters per second"]}).addUnit(w.METER,1).addUnit(S.SECOND,-1),G.CENTIMETER_PER_SECOND=H.METER_PER_SECOND.swap([w.CENTIMETER],{baseName:"linearvelocity",name:"centimeter per minute",aliases:["cm/min","centimeters per minute"]}),G=H=(0,n.gn)([_()],G);let q=class LinearVelocity extends W{constructor(e,t,r,i=G.METER_PER_SECOND){super(e,t,r,i,G.METER_PER_SECOND)}static fromArray(e,t=G.METER_PER_SECOND){return new this(e[0],e[1],e[2],t)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",G)],q.prototype,"unit",void 0),q=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],q);let K=class Velocity{constructor(e,t){this.linear=e,this.angular=t}clone(){return new this.constructor(this.linear?this.linear.clone():void 0,this.angular?this.angular.clone():void 0)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",q)],K.prototype,"linear",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",$)],K.prototype,"angular",void 0),K=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[q,$])],K);const Q=2e3;class Matrix4_Matrix4{constructor(e,t,r,i,n,s,o,a,c,u,l,h,p,_,d,y){Matrix4_Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,i,n,s,o,a,c,u,l,h,p,_,d,y)}set(e,t,r,i,n,s,o,a,c,u,l,h,p,_,d,y){const f=this.elements;return f[0]=e,f[4]=t,f[8]=r,f[12]=i,f[1]=n,f[5]=s,f[9]=o,f[13]=a,f[2]=c,f[6]=u,f[10]=l,f[14]=h,f[3]=p,f[7]=_,f[11]=d,f[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Matrix4_Matrix4).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/J.setFromMatrixColumn(e,0).length(),n=1/J.setFromMatrixColumn(e,1).length(),s=1/J.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,n=e.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(i),c=Math.sin(i),u=Math.cos(n),l=Math.sin(n);if("XYZ"===e.order){const e=s*u,r=s*l,i=o*u,n=o*l;t[0]=a*u,t[4]=-a*l,t[8]=c,t[1]=r+i*c,t[5]=e-n*c,t[9]=-o*a,t[2]=n-e*c,t[6]=i+r*c,t[10]=s*a}else if("YXZ"===e.order){const e=a*u,r=a*l,i=c*u,n=c*l;t[0]=e+n*o,t[4]=i*o-r,t[8]=s*c,t[1]=s*l,t[5]=s*u,t[9]=-o,t[2]=r*o-i,t[6]=n+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*u,r=a*l,i=c*u,n=c*l;t[0]=e-n*o,t[4]=-s*l,t[8]=i+r*o,t[1]=r+i*o,t[5]=s*u,t[9]=n-e*o,t[2]=-s*c,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*u,r=s*l,i=o*u,n=o*l;t[0]=a*u,t[4]=i*c-r,t[8]=e*c+n,t[1]=a*l,t[5]=n*c+e,t[9]=r*c-i,t[2]=-c,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,r=s*c,i=o*a,n=o*c;t[0]=a*u,t[4]=n-e*l,t[8]=i*l+r,t[1]=l,t[5]=s*u,t[9]=-o*u,t[2]=-c*u,t[6]=r*l+i,t[10]=e-n*l}else if("XZY"===e.order){const e=s*a,r=s*c,i=o*a,n=o*c;t[0]=a*u,t[4]=-l,t[8]=c*u,t[1]=e*l+n,t[5]=s*u,t[9]=r*l-i,t[2]=i*l-r,t[6]=o*u,t[10]=n*l+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Y,e,X)}lookAt(e,t,r){const i=this.elements;return re.subVectors(e,t),0===re.lengthSq()&&(re.z=1),re.normalize(),ee.crossVectors(r,re),0===ee.lengthSq()&&(1===Math.abs(r.z)?re.x+=1e-4:re.z+=1e-4,re.normalize(),ee.crossVectors(r,re)),ee.normalize(),te.crossVectors(re,ee),i[0]=ee.x,i[4]=te.x,i[8]=re.x,i[1]=ee.y,i[5]=te.y,i[9]=re.y,i[2]=ee.z,i[6]=te.z,i[10]=re.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,n=this.elements,s=r[0],o=r[4],a=r[8],c=r[12],u=r[1],l=r[5],h=r[9],p=r[13],_=r[2],d=r[6],y=r[10],f=r[14],m=r[3],b=r[7],v=r[11],g=r[15],w=i[0],x=i[4],M=i[8],E=i[12],k=i[1],S=i[5],P=i[9],N=i[13],T=i[2],z=i[6],A=i[10],D=i[14],O=i[3],C=i[7],j=i[11],R=i[15];return n[0]=s*w+o*k+a*T+c*O,n[4]=s*x+o*S+a*z+c*C,n[8]=s*M+o*P+a*A+c*j,n[12]=s*E+o*N+a*D+c*R,n[1]=u*w+l*k+h*T+p*O,n[5]=u*x+l*S+h*z+p*C,n[9]=u*M+l*P+h*A+p*j,n[13]=u*E+l*N+h*D+p*R,n[2]=_*w+d*k+y*T+f*O,n[6]=_*x+d*S+y*z+f*C,n[10]=_*M+d*P+y*A+f*j,n[14]=_*E+d*N+y*D+f*R,n[3]=m*w+b*k+v*T+g*O,n[7]=m*x+b*S+v*z+g*C,n[11]=m*M+b*P+v*A+g*j,n[15]=m*E+b*N+v*D+g*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],o=e[5],a=e[9],c=e[13],u=e[2],l=e[6],h=e[10],p=e[14];return e[3]*(+n*a*l-i*c*l-n*o*h+r*c*h+i*o*p-r*a*p)+e[7]*(+t*a*p-t*c*h+n*s*h-i*s*p+i*c*u-n*a*u)+e[11]*(+t*c*l-t*o*p-n*s*l+r*s*p+n*o*u-r*c*u)+e[15]*(-i*o*u-t*a*l+t*o*h+i*s*l-r*s*h+r*a*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],c=e[7],u=e[8],l=e[9],h=e[10],p=e[11],_=e[12],d=e[13],y=e[14],f=e[15],m=l*y*c-d*h*c+d*a*p-o*y*p-l*a*f+o*h*f,b=_*h*c-u*y*c-_*a*p+s*y*p+u*a*f-s*h*f,v=u*d*c-_*l*c+_*o*p-s*d*p-u*o*f+s*l*f,g=_*l*a-u*d*a-_*o*h+s*d*h+u*o*y-s*l*y,w=t*m+r*b+i*v+n*g;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/w;return e[0]=m*x,e[1]=(d*h*n-l*y*n-d*i*p+r*y*p+l*i*f-r*h*f)*x,e[2]=(o*y*n-d*a*n+d*i*c-r*y*c-o*i*f+r*a*f)*x,e[3]=(l*a*n-o*h*n-l*i*c+r*h*c+o*i*p-r*a*p)*x,e[4]=b*x,e[5]=(u*y*n-_*h*n+_*i*p-t*y*p-u*i*f+t*h*f)*x,e[6]=(_*a*n-s*y*n-_*i*c+t*y*c+s*i*f-t*a*f)*x,e[7]=(s*h*n-u*a*n+u*i*c-t*h*c-s*i*p+t*a*p)*x,e[8]=v*x,e[9]=(_*l*n-u*d*n-_*r*p+t*d*p+u*r*f-t*l*f)*x,e[10]=(s*d*n-_*o*n+_*r*c-t*d*c-s*r*f+t*o*f)*x,e[11]=(u*o*n-s*l*n-u*r*c+t*l*c+s*r*p-t*o*p)*x,e[12]=g*x,e[13]=(u*d*i-_*l*i+_*r*h-t*d*h-u*r*y+t*l*y)*x,e[14]=(_*o*i-s*d*i-_*r*a+t*d*a+s*r*y-t*o*y)*x,e[15]=(s*l*i-u*o*i+u*r*a-t*l*a-s*r*h+t*o*h)*x,this}scale(e){const t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),n=1-r,s=e.x,o=e.y,a=e.z,c=n*s,u=n*o;return this.set(c*s+r,c*o-i*a,c*a+i*o,0,c*o+i*a,u*o+r,u*a-i*s,0,c*a-i*o,u*a+i*s,n*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,s){return this.set(1,r,n,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,n=t._x,s=t._y,o=t._z,a=t._w,c=n+n,u=s+s,l=o+o,h=n*c,p=n*u,_=n*l,d=s*u,y=s*l,f=o*l,m=a*c,b=a*u,v=a*l,g=r.x,w=r.y,x=r.z;return i[0]=(1-(d+f))*g,i[1]=(p+v)*g,i[2]=(_-b)*g,i[3]=0,i[4]=(p-v)*w,i[5]=(1-(h+f))*w,i[6]=(y+m)*w,i[7]=0,i[8]=(_+b)*x,i[9]=(y-m)*x,i[10]=(1-(h+d))*x,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let n=J.set(i[0],i[1],i[2]).length();const s=J.set(i[4],i[5],i[6]).length(),o=J.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],Z.copy(this);const a=1/n,c=1/s,u=1/o;return Z.elements[0]*=a,Z.elements[1]*=a,Z.elements[2]*=a,Z.elements[4]*=c,Z.elements[5]*=c,Z.elements[6]*=c,Z.elements[8]*=u,Z.elements[9]*=u,Z.elements[10]*=u,t.setFromRotationMatrix(Z),r.x=n,r.y=s,r.z=o,this}makePerspective(e,t,r,i,n,s,o=2e3){const a=this.elements,c=2*n/(t-e),u=2*n/(r-i),l=(t+e)/(t-e),h=(r+i)/(r-i);let p,_;if(o===Q)p=-(s+n)/(s-n),_=-2*s*n/(s-n);else{if(2001!==o)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-s/(s-n),_=-s*n/(s-n)}return a[0]=c,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=u,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=_,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,n,s,o=2e3){const a=this.elements,c=1/(t-e),u=1/(r-i),l=1/(s-n),h=(t+e)*c,p=(r+i)*u;let _,d;if(o===Q)_=(s+n)*l,d=-2*l;else{if(2001!==o)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);_=n*l,d=-1*l}return a[0]=2*c,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=d,a[14]=-_,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const J=new Vector3_Vector3,Z=new Matrix4_Matrix4,Y=new Vector3_Vector3(0,0,0),X=new Vector3_Vector3(1,1,1),ee=new Vector3_Vector3,te=new Vector3_Vector3,re=new Vector3_Vector3,ie=new Matrix4_Matrix4,ne=new Quaternion_Quaternion;class Euler_Euler{constructor(e=0,t=0,r=0,i=Euler_Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,n=i[0],s=i[4],o=i[8],a=i[1],c=i[5],u=i[9],l=i[2],h=i[6],p=i[10];switch(t){case"XYZ":this._y=Math.asin(d(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-d(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(a,c)):(this._y=Math.atan2(-l,n),this._z=0);break;case"ZXY":this._x=Math.asin(d(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-l,p),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(a,n));break;case"ZYX":this._y=Math.asin(-d(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(a,n)):(this._x=0,this._z=Math.atan2(-s,c));break;case"YZX":this._z=Math.asin(d(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-d(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return ie.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ie,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return ne.setFromEuler(this),this.setFromQuaternion(ne,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler_Euler.DEFAULT_ORDER="XYZ";var se=r(77),oe=r(665);function ae(e,t){return void 0===t&&(t={}),function(r,i){var n,s="@jsonArrayMember on "+(0,se.$0)(r.constructor)+"."+String(i),c=(0,oe.JD)(e,s),u=null==t.dimensions?1:t.dimensions;if(!isNaN(u)&&u<1)(0,se.H)(s+": 'dimensions' option must be at least 1.");else{var l=se.df?Reflect.getMetadata("design:type",r,i):null;null==l||l===Array||l===Object?(0,o.d3)(r,i,{type:function(){return ce((0,oe._k)(c()),u)},emitDefaultValue:t.emitDefaultValue,isRequired:t.isRequired,options:(0,a.M3)(t),key:i.toString(),name:null!==(n=t.name)&&void 0!==n?n:i.toString(),deserializer:t.deserializer,serializer:t.serializer}):(0,se.H)(s+": property is not an Array. "+se.AZ)}}}function ce(e,t){for(var r=new oe.GJ(e),i=1;i<t;++i)r=new oe.GJ(r);return r}function ue(e,t){return(r,i)=>{const n=(0,p.W5)(r,i,t);ae(e,n)(r,i),(0,p.EB)(r,i,n)}}let le=class Matrix4 extends Matrix4_Matrix4{static round(e,t=0){const r=Math.pow(10,t);return e.elements.forEach(((t,i)=>{e.elements[i]=Math.round(t*r)/r})),e}static fromArray(e){const t=new this;return t.fromArray([].concat(...e)),t.transpose(),t}static rotationFromQuaternion(e){const t=new this;return t.makeRotationFromQuaternion(e),t}static rotationFromEuler(e){const t=new this;return t.makeRotationFromEuler(e),t}static rotationFromAxisAngle(e,t){const r=new this;return r.makeRotationAxis(e,t),r}clone(){return(new this.constructor).fromArray(this.elements)}};var he;(0,n.gn)([ue(Number,{numberType:u.DECIMAL}),(0,n.w6)("design:type",Array)],le.prototype,"elements",void 0),le=(0,n.gn)([_()],le);let pe=he=class Euler extends Euler_Euler{constructor(e,t,r,i,n){super(e,t,r,i),n&&(this.x=n.convert(this.x,E.RADIAN),this.y=n.convert(this.y,E.RADIAN),this.z=n.convert(this.z,E.RADIAN))}static fromQuaternion(e,t="XYZ"){const r=new he;return r.setFromQuaternion(e,t),r}static fromRotationMatrix(e,t="XYZ"){const r=new he;return r.setFromRotationMatrix(e,t),r}toVector(e=E.RADIAN){return new m(E.RADIAN.convert(this.x,e),E.RADIAN.convert(this.y,e),E.RADIAN.convert(this.z,e))}toVector3(e){return this.toVector(e)}toRotationMatrix(){return le.rotationFromEuler(this)}get pitch(){return E.RADIAN.convert(this.y,E.DEGREE)}get roll(){return E.RADIAN.convert(this.x,E.DEGREE)}get yaw(){return E.RADIAN.convert(this.z,E.DEGREE)}clone(){return(new this.constructor).copy(this)}};var _e;(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],pe.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],pe.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],pe.prototype,"z",void 0),pe=he=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,String,E])],pe);let de=_e=class AxisAngle extends m{constructor(e,t,r,i=null,n=E.RADIAN){super(n.convert(e||0,E.RADIAN),n.convert(t||0,E.RADIAN),n.convert(r||0,E.RADIAN)),null!==i?this.angle=n.convert(i,E.RADIAN):(this.angle=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2)),this.normalize())}static fromQuaternion(e){const t=new _e;if(t.angle=2*Math.acos(e.w),1-e.w*e.w<1e-6)t.x=e.x,t.y=e.y,t.z=e.z;else{const r=Math.sqrt(1-e.w*e.w);t.x=e.x/r,t.y=e.y/r,t.z=e.z/r}return t}toRotationMatrix(){return le.rotationFromAxisAngle(this,this.angle)}clone(){const e=new this.constructor;return e.angle=this.angle,e}};(0,n.gn)([(0,s._)({numberType:u.DOUBLE}),(0,n.w6)("design:type",Number)],de.prototype,"angle",void 0),de=_e=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Number,E])],de);let ye=class Quaternion extends Quaternion_Quaternion{static fromThreeJS(e){const t=new this;return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}static fromEuler(e){const t=new this;return e instanceof pe?t.setFromEuler(e):e instanceof m?t.setFromEuler(new pe(e.x,e.y,e.z)):e instanceof Array?t.setFromEuler(new pe(e[0],e[1],e[2])):void 0===e.yaw?t.setFromEuler(new pe(e.x,e.y,e.z,e.order,e.unit)):t.setFromEuler(new pe(e.roll,e.pitch,e.yaw,"ZYX",e.unit)),t}static fromAxisAngle(e){const t=new this;if(e instanceof de)t.setFromAxisAngle(new m(e.x,e.y,e.z),e.angle);else if(e instanceof Array){const r=new de(e[0],e[1],e[2],4===e.length?e[3]:null);t.setFromAxisAngle(r,r.angle)}else{const r=new de(e.x,e.y,e.z,e.angle?e.angle:null,e.unit);t.setFromAxisAngle(r,r.angle)}return t}static fromRotationMatrix(e){const t=new this;return t.setFromRotationMatrix(e),t}toEuler(e){return pe.fromQuaternion(this,e)}toAxisAngle(){return de.fromQuaternion(this)}toRotationMatrix(){return le.rotationFromQuaternion(this)}clone(){return(new this.constructor).copy(this)}};var fe;(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ye.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ye.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ye.prototype,"z",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ye.prototype,"w",void 0),ye=(0,n.gn)([_()],ye);let me=fe=class Orientation extends ye{constructor(e,t,r,i,n){super(e,t,r,i),this.accuracy=n||new B(0,E.RADIAN),this.timestamp=L.now()}static fromQuaternion(e){return new fe(e.x,e.y,e.z,e.w)}clone(){const e=super.clone();return e.accuracy=this.accuracy?this.accuracy.clone():void 0,e.timestamp=this.timestamp,e}};var be;(0,n.gn)([(0,s._)({isRequired:!1,numberType:u.LONG}),(0,n.w6)("design:type",Number)],me.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)({isRequired:!1}),(0,n.w6)("design:type",V)],me.prototype,"accuracy",void 0),me=fe=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Number,V])],me);let ve=be=class GCS extends v{static get EARTH_RADIUS(){return be.EARTH_RADIUS_MEAN}};function ge(e,t){const r=E.DEGREE.convert(e[1],E.RADIAN),i=E.DEGREE.convert(t[1],E.RADIAN),n=E.DEGREE.convert(t[1]-e[1],E.RADIAN),s=E.DEGREE.convert(t[0]-e[0],E.RADIAN),o=Math.sin(n/2)*Math.sin(n/2)+Math.cos(r)*Math.cos(i)*Math.sin(s/2)*Math.sin(s/2),a=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return ve.EARTH_RADIUS_MEAN*a}function we(e,t){let r=0;for(let i=0;i<e.length;i++)r+=Math.pow(e[i]-t[i],2);return r=Math.sqrt(r),r}function xe(e,t){let r=0;for(let i=0;i<e.length;i++)r+=Math.abs(e[i]-t[i]);return r}function Me(e,t){let r=0;for(let i=0;i<e.length;i++)r+=Math.abs(e[i]-t[i])/(Math.abs(e[i])+Math.abs(t[i]));return r}function Ee(e,t){let r=0;for(let i=0;i<e.length;i++)r=Math.max(r,Math.abs(e[i]-t[i]));return r}ve.EARTH_RADIUS_MEAN=6371008.7714,ve.EARTH_EQUATORIAL_RADIUS=6378137,ve.EARTH_POLAR_RADIUS=6356752.3142,ve.EARTH_ECCENTRICITY=.081819190842622,ve.EPSG4326=new be("EPSG:4326",{baseName:"gcs",aliases:["WGS84","World Geodetic System"]}),ve.WGS84=be.EPSG4326,ve.ECEF=new be("ECEF",{baseName:"gcs",aliases:["earth-centered, earth-fixed","ECR","earth centered rotational"],definitions:[{inputType:m,outputType:m,unit:"EPSG:4326",toUnit:e=>{const t=be.EARTH_EQUATORIAL_RADIUS,r=t-1/298.257223563*t,i=Math.sqrt(Math.pow(t,2)-Math.pow(r,2))/t,n=Math.atan2(e.y,e.x),s=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));let o=0,a=Math.atan2(e.z,s*(1-Math.pow(i,2))),c=Math.cos(a),u=Math.sin(a),l=Math.pow(t,2)/Math.sqrt(Math.pow(t*c,2)+Math.pow(r*u,2)),h=s/c-l;for(;Math.abs(h-o)>1e-6;)o=h,a=Math.atan2(e.z,s*(1-Math.pow(i,2)*l/(l+h))),c=Math.cos(a),u=Math.sin(a),l=Math.pow(t,2)/Math.sqrt(Math.pow(t*c,2)+Math.pow(r*u,2)),h=s/c-l;return new m(E.RADIAN.convert(n,E.DEGREE),E.RADIAN.convert(a,E.DEGREE),h)},fromUnit:e=>{var t;const r=E.DEGREE.convert(e.y,E.RADIAN),i=E.DEGREE.convert(e.x,E.RADIAN),n=null!==(t=e.z)&&void 0!==t?t:0,s=Math.cos(r),o=Math.sin(r),a=Math.cos(i),c=Math.sin(i),u=be.EARTH_EQUATORIAL_RADIUS/Math.sqrt(1-Math.pow(be.EARTH_ECCENTRICITY,2)*Math.pow(o,2));return new m((u+n)*s*a,(u+n)*s*c,(u*(1-Math.pow(be.EARTH_ECCENTRICITY,2))+n)*o)}}]}),ve.EPSG3857=new be("EPSG:3857",{baseName:"gcs",aliases:["pseudo mercator","web mercator"],definitions:[{inputType:m,outputType:m,unit:"EPSG:4326",fromUnit:e=>new m(20037508.34*e.x/180,Math.log(Math.tan((90+e.y)*Math.PI/360))/(Math.PI/180)*20037508.34/180,0),toUnit:e=>new m(180*e.x/20037508.34,360*Math.atan(Math.exp(e.y*Math.PI/20037508.34))/Math.PI-90,e.z)}]}),ve=be=(0,n.gn)([_()],ve);let ke=class AbsolutePosition{constructor(){this.timestamp=L.now(),this.velocity=new K,this.unit=w.METER}get probability(){return this._probability?this._probability:1/this.accuracy.valueOf()}set probability(e){if(e>1||e<0)throw new Error(`${this.constructor.name} should be between 0 and 1.`);this._probability=e}get accuracy(){return this._accuracy||(this._accuracy=new B(1,this.unit)),this._accuracy}set accuracy(e){if(!e)throw new Error("Accuracy can not be undefined!");this._accuracy=e}get linearVelocity(){if(this.velocity)return this.velocity.linear}set linearVelocity(e){this.velocity||(this.velocity=new K),this.velocity.linear=e}get angularVelocity(){if(this.velocity)return this.velocity.angular}set angularVelocity(e){this.velocity||(this.velocity=new K),this.velocity.angular=e}setOrientation(e){return this.orientation=e,this}setAccuracy(e,t){return this.accuracy="number"==typeof e?new B(e,t||this.unit):e,this}distanceTo(e,t=we){return t(this.toVector3().toArray(),e.toVector3().toArray())}equals(e){return this.toVector3(this.unit).equals(e.toVector3(this.unit))}clone(){const e=new this.constructor;return e.unit=this.unit,e._accuracy=this._accuracy?this._accuracy.clone():void 0,e.orientation=this.orientation?this.orientation.clone():void 0,e.velocity=this.velocity?this.velocity.clone():void 0,e.timestamp=this.timestamp,e.referenceSpaceUID=this.referenceSpaceUID,e}};(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],ke.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",K)],ke.prototype,"velocity",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",me)],ke.prototype,"orientation",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",w)],ke.prototype,"unit",void 0),(0,n.gn)([(0,s._)({index:!0}),(0,n.w6)("design:type",String)],ke.prototype,"referenceSpaceUID",void 0),(0,n.gn)([(0,s._)({name:"accuracy"}),(0,n.w6)("design:type",V)],ke.prototype,"_accuracy",void 0),(0,n.gn)([(0,s._)({name:"probability",numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ke.prototype,"_probability",void 0),ke=(0,n.gn)([_()],ke);let Se=class RelativePosition{get probability(){return this._probability?this._probability:1/this.accuracy.valueOf()}set probability(e){if(e>1||e<0)throw new Error(`${this.constructor.name} should be between 0 and 1.`);this._probability=e}get accuracy(){return this._accuracy||(this._accuracy=new B(1,this._defaultUnit)),this._accuracy}set accuracy(e){if(!e)throw new Error("Accuracy can not be undefined!");this.accuracy=e}constructor(e,t,r){this.timestamp=L.now(),void 0!==e&&(e instanceof String||"string"==typeof e?this.referenceObjectUID=e:(this.referenceObjectType=e.constructor.name,this.referenceObjectUID=e.uid)),this._defaultUnit=r||v.UNKNOWN,this.referenceValue=t}setAccuracy(e,t){return this.accuracy="number"==typeof e?new B(e,t||this._defaultUnit):e,this}equals(e){return this.timestamp===e.timestamp}clone(){return l.C.clone(this)}};var Pe;(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],Se.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Se.prototype,"referenceObjectUID",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Se.prototype,"referenceObjectType",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],Se.prototype,"referenceValue",void 0),(0,n.gn)([(0,s._)({name:"accuracy"}),(0,n.w6)("design:type",V)],Se.prototype,"_accuracy",void 0),(0,n.gn)([(0,s._)({name:"probability",numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],Se.prototype,"_probability",void 0),(0,n.gn)([(0,s._)((()=>v)),(0,n.w6)("design:type",Object)],Se.prototype,"unit",void 0),Se=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object,Object])],Se);let Ne=Pe=class DataObject{constructor(e=R(),t){this._relativePositions=new Map,this.uid=e,this.createdTimestamp=L.now(),this.displayName=t}get position(){return this.getPosition()}set position(e){this.setPosition(e)}getPosition(e){return void 0!==e&&void 0!==this._position?e.transform(this._position,{inverse:!0}):this._position}setPosition(e,t){return this._position=t?t.transform(e,{inverse:!1}):e,this}setUID(e){return this.uid=e,this}get relativePositions(){const e=[];return void 0!==this._relativePositions&&this._relativePositions.forEach((t=>{t.forEach((t=>{e.push(t)}))})),e}set relativePositions(e){this._relativePositions=new Map,e.forEach((e=>{this.addRelativePosition(e)}))}setParent(e){return this.parentUID=e instanceof Pe?e.uid:e,this}removeRelativePositions(e){this._relativePositions.delete(e)}addRelativePosition(e){return e&&void 0!==e.referenceObjectUID?(this._relativePositions.has(e.referenceObjectUID)||this._relativePositions.set(e.referenceObjectUID,new Map),this._relativePositions.get(e.referenceObjectUID).set(e.constructor.name,e),this):this}getRelativePositions(e){return void 0===e?this.relativePositions:this._relativePositions.has(e)?Array.from(this._relativePositions.get(e).values()):[]}getRelativePosition(e,t){if(this._relativePositions.has(e)){const r=this._relativePositions.get(e);return t?r.get(t):Array.from(r.values())[0]}}hasRelativePosition(e){return this._relativePositions.has(e)}bind(e){return new DataObjectBinding(this,e)}clone(e){return l.C.clone(this,e)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Ne.prototype,"displayName",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],Ne.prototype,"createdTimestamp",void 0),(0,n.gn)([(0,s._)({primaryKey:!0}),(0,n.w6)("design:type",String)],Ne.prototype,"uid",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Ne.prototype,"parentUID",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",ke),(0,n.w6)("design:paramtypes",[ke])],Ne.prototype,"position",null),(0,n.gn)([ue(Se),(0,n.w6)("design:type",Array),(0,n.w6)("design:paramtypes",[Array])],Ne.prototype,"relativePositions",null),Ne=Pe=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,String])],Ne);class DataObjectBinding extends T.EventEmitter{constructor(e,t){super(),this.target=e,this.service=t,this.service.on("insert",this._onInsert.bind(this))}_onInsert(e,t){this.target.uid===e&&(this.emit("update",this.target,t),this.target=t)}on(e,t){return super.on(e,t)}save(){return this.service.insert(this.target.uid,this.target)}delete(){return this.service.delete(this.target.uid)}dispose(){this.service.removeListener("update",this._onInsert.bind(this))}}let Te=class GraphNode extends AsyncEventEmitter{constructor(){super(),this.uid=R(),this._ready=!1,this._available=!0,this.prependOnceListener("ready",(()=>{this._ready=!0})),this.on("error",this._onError.bind(this)),this.on("completed",this._onCompleted.bind(this))}logger(e,t,r){"object"==typeof t?this.graph.logger(e,JSON.stringify(t)):this.graph.logger(e,t,r)}isReady(){return this._ready}isAvailable(){return this._available}get outlets(){return this.graph.edges.filter((e=>e.inputNode.uid===this.uid))}get inlets(){return this.graph.edges.filter((e=>e.outputNode.uid===this.uid))}emit(e,...t){return"ready"===e?super.emit("ready",this):super.emit(e,...t)}on(e,t){return super.on(e,t)}once(e,t){return super.once(e,t)}pull(e){return new Promise(((t,r)=>{const i=[];this.listeners("pull").forEach((t=>{i.push(t(e))})),0===i.length&&this.inlets.forEach((t=>{i.push(t.pull(e))})),Promise.all(i).then((()=>{t()})).catch(r)}))}push(e,t={}){return new Promise(((r,i)=>{if(null==e)return i(new Error("Node received null data frame!"));const n=this.listeners("push");0===n.length?(this.outlets.forEach((r=>r.push(e,t))),r()):(this._available=!1,Promise.all(n.map((r=>r(e,t)))).then((()=>{this._available=!0,this.emit("available"),r()})).catch(i))}))}onceAvailable(){return new Promise((e=>{this.isAvailable()?e():this.once("available",(()=>{e()}))}))}onceCompleted(e){return new Promise(((t,r)=>{const i=function(n){n.frameUID===e&&(this.removeListener("completed",i),this.removeListener("error",i),n.error?r(n):t(n))};this.on("completed",i.bind(this)),this.on("error",i.bind(this))}))}_onError(e){this.inlets.forEach((t=>t.emit("error",e)))}_onCompleted(e){this.inlets.forEach((t=>t.emit("completed",e)))}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Te.prototype,"name",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Te.prototype,"uid",void 0),Te=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[])],Te);let ze=class Node extends Te{constructor(e){super(),this.setOptions(e||{}),this.uid=this.options.uid||this.uid}setOptions(e){return this.options=Object.assign(Object.assign({},e),this.options||[]),this.name=this.options.name||this.constructor.name,this}getOptions(){return this.options}get model(){return this.graph}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],ze.prototype,"options",void 0),ze=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],ze);let Ae=class DataServiceDriver extends U{constructor(e,t={}){super(),this.options=t,this.options.serialize=this.options.serialize||(e=>l.C.serialize(e)),this.options.deserialize=this.options.deserialize||(e=>l.C.deserialize(e)),e&&(this.uid=e.name,this.dataType=e)}};(0,n.gn)([(0,s._)({serializer:e=>e.name,deserializer:e=>l.C.findTypeByName(e)}),(0,n.w6)("design:type",Object)],Ae.prototype,"dataType",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],Ae.prototype,"options",void 0),Ae=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object])],Ae);let De=class DataService extends U{constructor(e){super(),this.priority=-1,this.driver=e,this.driver&&(this.uid=this.driver.dataType.name),this.once("build",this._buildDriver.bind(this)),this.once("destroy",this._destroyDriver.bind(this))}_buildDriver(){return new Promise(((e,t)=>{this.driver?(this.driver.model=this.model,this.driver.emitAsync("build").then((()=>e())).catch(t)):e()}))}_destroyDriver(){return new Promise(((e,t)=>{this.driver?this.driver.emitAsync("destroy").then((()=>e())).catch(t):e()}))}get dataType(){if(this.driver)return this.driver.dataType}setPriority(e){return this.priority=e,this}findByUID(e){return this.driver.findByUID(e)}findOne(e,t){return this.driver.findOne(e,t)}findAll(e,t){return this.driver.findAll(e,t)}insert(e,t){return this.driver.insert(e,t)}count(e){return this.driver.count(e)}delete(e){return this.driver.delete(e)}deleteAll(e){return this.driver.deleteAll(e)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Ae)],De.prototype,"driver",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],De.prototype,"priority",void 0),De=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Ae])],De);const Oe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const Ce=function(e){return"string"==typeof e&&Oe.test(e)};const je=function(e){if(!Ce(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function Re(e,t,r,i){switch(e){case 0:return t&r^~t&i;case 1:case 3:return t^r^i;case 2:return t&r^t&i^r&i}}function Ue(e,t){return e<<t|e>>>32-t}const Ie=function(e,t,r){function i(e,i,n,s){var o;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof i&&(i=je(i)),16!==(null===(o=i)||void 0===o?void 0:o.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(i),a.set(e,i.length),a=r(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,n){s=s||0;for(let e=0;e<16;++e)n[s+e]=a[e];return n}return j(a)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}("v5",80,(function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const i=e.length/4+2,n=Math.ceil(i/16),s=new Array(n);for(let t=0;t<n;++t){const r=new Uint32Array(16);for(let i=0;i<16;++i)r[i]=e[64*t+4*i]<<24|e[64*t+4*i+1]<<16|e[64*t+4*i+2]<<8|e[64*t+4*i+3];s[t]=r}s[n-1][14]=8*(e.length-1)/Math.pow(2,32),s[n-1][14]=Math.floor(s[n-1][14]),s[n-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<n;++e){const i=new Uint32Array(80);for(let t=0;t<16;++t)i[t]=s[e][t];for(let e=16;e<80;++e)i[e]=Ue(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let n=r[0],o=r[1],a=r[2],c=r[3],u=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),s=Ue(n,5)+Re(r,o,a,c)+u+t[r]+i[e]>>>0;u=c,c=a,a=Ue(o,30)>>>0,o=n,n=s}r[0]=r[0]+n>>>0,r[1]=r[1]+o>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+c>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),Fe=Ie;class NodeDataService extends De{findData(e,t){return new Promise((r=>{this.findByUID(this.getUID(e,"string"==typeof t?t:t.uid)).then((e=>{r(e.data)})).catch((()=>{r(void 0)}))}))}insertData(e,t,r){const i=this.getUID(e,"string"==typeof t?t:t.uid);return this.insert(i,new Le(i,r))}getUID(e,t){return Fe(t+e,"97b9cc7e-19ca-4f20-8190-161d7b39e93a")}}let Le=class NodeData{constructor(e,t={}){this.uid=e,this.data=t}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Le.prototype,"uid",void 0),(0,n.gn)([(0,s._)({serializer:e=>e,deserializer:e=>e}),(0,n.w6)("design:type",Object)],Le.prototype,"data",void 0),Le=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,Object])],Le);let Ve=class ProcessingNode extends ze{constructor(e){super(e),this.options.frameFilter=this.options.frameFilter||(()=>!0),this.on("push",this._onPush.bind(this))}_onPush(e,t){return new Promise(((r,i)=>{const n=[];Array.isArray(e)?(n.push(this.processBulk(e.filter((e=>this.options.frameFilter(e))))),e.filter((e=>!this.options.frameFilter(e))).forEach((e=>{n.push(Promise.resolve(e))}))):this.options.frameFilter(e)?n.push(this.process(e,t)):n.push(Promise.resolve(e)),Promise.all(n).then((e=>{const i=[];e.forEach((e=>{Array.isArray(e)?i.push(...e.filter((e=>void 0!==e))):void 0!==e&&i.push(e)})),i.length>0&&this.outlets.forEach((e=>e.push(1===i.length?i[0]:i,t))),r()})).catch((e=>{void 0===e&&this.logger("warn",`Exception thrown in processing node ${this.uid} but no exception given!`),i(e)}))}))}findNodeDataService(){return this.model.findDataService(Le)}getNodeData(e,t=undefined){return new Promise(((r,i)=>{this.findNodeDataService().findData(this.uid,e).then((e=>{r(e||t)})).catch(i)}))}setNodeData(e,t){return new Promise(((r,i)=>{this.findNodeDataService().insertData(this.uid,e,t).then(r).catch(i)}))}processBulk(e){return Promise.all(e.map((e=>this.process(e))))}};Ve=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],Ve);class ObjectProcessingNode extends Ve{constructor(e){super(e),this.options.objectFilter=this.options.objectFilter||(()=>!0)}process(e,t){return new Promise(((r,i)=>{const n=[],s=[],o=e.source?e.source.uid:void 0;e.getObjects().filter((t=>this.options.objectFilter(t,e))).forEach((r=>{s.push(r.uid),n.push(this.processObject(r,e,t))})),Promise.all(n).then((t=>{t.forEach(((t,r)=>{const i=s[r];e.removeObject(i),e.removeObject(t.uid)})),t.forEach(((t,r)=>{const i=s[r];e.addObject(t),i===o&&(e.source=t)})),r(e)})).catch(i)}))}findObjectByUID(e,t,r){if(void 0!==t&&t.hasObject(new Ne(e)))return new Promise((r=>{r(t.getObjectByUID(e))}));let i;return void 0!==r&&(i=this.model.findDataService(r)),i=i||this.model.findDataService(Ne),new Promise((t=>{i.findByUID(e).then(t).catch((()=>t(void 0)))}))}}var Be;let We=Be=class ReferenceSpace extends Ne{constructor(e){super(),this.parent=e,this._scaleMatrix=new le,this._transformationMatrix=(new le).identity(),this._translationMatrix=(new le).identity(),this._rotation=new ye}static fromDataObject(e){const t=new Be;return t.uid=e.uid,t.displayName=e.displayName,e.getPosition()&&(t.translation(...e.getPosition().toVector3(w.METER).toArray()),e.getPosition().orientation&&t.rotation(e.getPosition().orientation)),t}set parent(e){e&&(this.parentUID=e.uid,this._parent=e)}get parent(){return this._parent}update(e){return new Promise(((t,r)=>{this.parentUID?e.findByUID(this.parentUID).then((t=>{if(this._parent=t,!t)throw new Error(`Unable to find reference space with uid: ${this.parentUID}!`);return this._parent.update(e)})).then(t).catch(r):t()}))}orthographic(e,t,r,i,n,s){return this._transformationMatrix.multiply((new le).makeOrthographic(e,t,r,i,n,s)),this}perspective(e,t,r,i,n,s){return this._transformationMatrix.multiply((new le).makePerspective(e,t,r,i,n,s)),this}reset(){return this._transformationMatrix.identity(),this._scaleMatrix=new le,this._rotation=new ye,this}referenceUnit(e){return this._unit=e,this}translation(e,t,r=0){return this._translationMatrix.multiply((new le).makeTranslation(e,t,r)),this._transformationMatrix.multiply(this._translationMatrix),this}scale(e,t,r=1){return this._scaleMatrix=(new le).makeScale(e,t,r),this._transformationMatrix.multiply(this._scaleMatrix),this}rotation(e){return e instanceof ye?(this._rotation=e.clone(),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())):e instanceof pe?(this._rotation=ye.fromEuler(e),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())):e instanceof de?(this._rotation=ye.fromAxisAngle(e),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())):(this._rotation=ye.fromEuler(e),this._transformationMatrix.multiply(this._rotation.toRotationMatrix())),this}transform(e,t){const r=t||{},i=this._parent?this._parent.transform(e,t):e.clone();this._unit&&(i.fromVector(i.toVector3(this._unit)),i.setAccuracy(i.accuracy.to(this._unit)));const n=r.inverse?this.transformationMatrix.clone().invert():this.transformationMatrix,s=r.inverse?this.rotationQuaternion.clone().invert():this.rotationQuaternion,o=r.inverse?this._scaleMatrix.clone().invert():this.scaleMatrix;return i.fromVector(i.toVector3().applyMatrix4(n)),i.orientation&&i.orientation.multiply(s),i.linearVelocity&&i.linearVelocity.applyMatrix4(o).applyMatrix4(le.rotationFromQuaternion(s)),i.setAccuracy(new m(i.accuracy.valueOf(),0,0).applyMatrix4(o).x,i.accuracy.unit),i.referenceSpaceUID=this.uid,i}get transformationMatrix(){return this._transformationMatrix}set transformationMatrix(e){this._transformationMatrix=e}get scaleMatrix(){return this._scaleMatrix}set scaleMatrix(e){this._scaleMatrix=e}get rotationQuaternion(){return this._rotation}set rotationQuaternion(e){this._rotation=e}get translationMatrix(){return this._translationMatrix}set translationMatrix(e){this._translationMatrix=e}};(0,n.gn)([(0,s._)({name:"translationMatrix"}),(0,n.w6)("design:type",le)],We.prototype,"_translationMatrix",void 0),(0,n.gn)([(0,s._)({name:"transformationMatrix"}),(0,n.w6)("design:type",le)],We.prototype,"_transformationMatrix",void 0),(0,n.gn)([(0,s._)({name:"scaleMatrix"}),(0,n.w6)("design:type",le)],We.prototype,"_scaleMatrix",void 0),(0,n.gn)([(0,s._)({name:"rotation"}),(0,n.w6)("design:type",ye)],We.prototype,"_rotation",void 0),(0,n.gn)([(0,s._)({name:"unit"}),(0,n.w6)("design:type",w)],We.prototype,"_unit",void 0),We=Be=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],We);class ReferenceSpaceConversionNode extends ObjectProcessingNode{constructor(e,t){super(t),e instanceof We?(this._referenceSpace=e,this._referenceSpaceUID=e.uid):this._referenceSpaceUID=e,this.once("build",this._onRegisterService.bind(this))}_onRegisterService(){return new Promise((e=>{const t=this.graph.findDataService(We);t.on("insert",((e,t)=>{e===this._referenceSpaceUID&&(this._referenceSpace=t)})),t.findByUID(this._referenceSpaceUID).then((t=>{this._referenceSpace=t,e()})).catch((()=>{e()}))}))}processObject(e,t){return new Promise((r=>{let i=t.getObjectByUID(this._referenceSpaceUID);null==i&&(i=this._referenceSpace),e.getPosition()&&e.uid!==i.uid&&(this.options.inverse?e.setPosition(e.getPosition(),i):e.setPosition(e.getPosition(i))),r(e)}))}}class FrameChunkNode extends ze{constructor(e,t,r=S.MILLISECOND,i){super(i),this._queue=[],this._count=e,t&&(this._interval=r.convert(t,S.MILLISECOND),this.once("build",this._start.bind(this)),this.once("destroy",this._stop.bind(this))),this.on("push",this._onPush.bind(this))}_onPush(e){return new Promise(((t,r)=>{this._queue.push(e),this._queue.length>=this._count?this._flushQueue().then(t).catch(r):t()}))}_flushQueue(){return new Promise((e=>{void 0!==this._timer&&(clearInterval(this._timer),this._timer=setInterval(this._timeoutFn.bind(this),this._interval)),this.outlets.forEach((e=>e.push(this._queue))),this._queue=[],e()}))}_timeoutFn(){this._queue.length>0&&Promise.resolve(this._flushQueue())}_start(){return new Promise((e=>{this._timer=setInterval(this._timeoutFn.bind(this),this._interval),e()}))}_stop(){void 0!==this._timer&&(clearInterval(this._timer),this._timer=void 0)}}function $e(e,t,r){return void 0===r&&(r={}),function(i,n){var s,c="@jsonMapMember on "+(0,se.$0)(i.constructor)+"."+String(n),u=(0,oe.JD)(e,c),l=(0,oe.JD)(t,c),h=se.df?Reflect.getMetadata("design:type",i,n):null;null==h||h===Map||h===Object?(0,o.d3)(i,n,{type:function(){return(0,oe.mY)(u(),l(),{shape:r.shape})},emitDefaultValue:r.emitDefaultValue,isRequired:r.isRequired,options:(0,a.M3)(r),key:n.toString(),name:null!==(s=r.name)&&void 0!==s?s:n.toString(),deserializer:r.deserializer,serializer:r.serializer}):(0,se.H)(c+": property is not a Map. "+se.AZ)}}function He(e,t,r){return(i,n)=>{t===Object&&void 0===r&&((r={}).deserializer=e=>{const t=new Map;return Object.keys(e).forEach((r=>{t.set(r,JSON.parse(e[r]))})),t},r.serializer=e=>{const t={};return e.forEach(((e,r)=>{t[r]=JSON.stringify(e)})),t});const s=(0,p.W5)(i,n,r);$e(e,t,s)(i,n),(0,p.EB)(i,n,s)}}var Ge;let qe=Ge=class DataFrame{constructor(e){var t;this.uid=R(),this._objects=new Map,this.createdTimestamp=L.now(),e instanceof Ge?(this.createdTimestamp=e.createdTimestamp,this.phenomenonTimestamp=e.phenomenonTimestamp,this.uid=e.uid,this._objects=e._objects,this.source=e.source):e instanceof Ne&&(this.source=e),this.phenomenonTimestamp=null!==(t=this.phenomenonTimestamp)&&void 0!==t?t:this.createdTimestamp}get source(){return this.getObjectByUID(this._source)}set source(e){void 0!==e&&(this.addObject(e.clone()),this._source=e.uid)}getSensor(e,t){let r=this.getObjects(e)[0];return r||void 0===t||(r=new e(t),this.addObject(r)),r}getObjects(e){if(void 0===e){const e=[];return this._objects.forEach((t=>{e.push(t)})),e}{const t=[];return this._objects.forEach((r=>{r.constructor.name===e.name&&t.push(r)})),t}}getObjectByUID(e){return this._objects.get(e)}hasObject(e){return this._objects.has(e.uid)}addObject(e){return void 0===e||this._objects.set(e.uid,e),this}addSensor(e){return this.addObject(e)}addReferenceSpace(e){this.addObject(e)}removeObject(e){this._objects.delete("string"==typeof e?e:e.uid)}clearObjects(e){const t=null!=e?e:e=>!0;this._objects.forEach(((e,r)=>{t(e)&&this._objects.delete(r)}))}clone(){return l.C.clone(this)}};(0,n.gn)([(0,s._)({primaryKey:!0}),(0,n.w6)("design:type",String)],qe.prototype,"uid",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],qe.prototype,"createdTimestamp",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],qe.prototype,"phenomenonTimestamp",void 0),(0,n.gn)([(0,s._)({name:"source"}),(0,n.w6)("design:type",String)],qe.prototype,"_source",void 0),(0,n.gn)([He(String,Ne,{name:"objects"}),(0,n.w6)("design:type",Map)],qe.prototype,"_objects",void 0),qe=Ge=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],qe);class FrameCloneNode extends ze{constructor(e){super(e),this.on("push",this._onPush.bind(this))}_onPush(e,t){return new Promise((r=>{const i=this.options.repack?this._repack(e):e.clone();this.outlets.forEach((e=>e.push(i,t))),r()}))}_repack(e){const t=new qe;return t.createdTimestamp=e.createdTimestamp,e.getObjects().forEach((e=>{t.addObject(e.clone())})),t}}class FrameDelayNode extends Ve{constructor(e,t){super(),this._timeout=e,this._timeoutUnit=t}process(e){return new Promise((t=>{setTimeout((()=>{t(e)}),this._timeoutUnit.convert(this._timeout,S.MILLISECOND))}))}}class FrameFilterNode extends Ve{constructor(e,t){super(t),this.options.frameFilter=()=>!0,this.filterFn=e}process(e){return new Promise((t=>{this.filterFn(e)?t(e):t(void 0)}))}}class FrameFlattenNode extends ze{constructor(e){super(e),this.on("push",this._onPush.bind(this))}_onPush(e,t){return new Promise((r=>{e.map((e=>this.outlets.forEach((r=>r.push(e,t))))),r()}))}}class DataFrameService extends De{constructor(e){super(e)}insertFrame(e){return this.insert(e.uid,e)}findBefore(e,t){return this._findTimestamp({$lte:e},t)}findAfter(e,t){return this._findTimestamp({$gte:e},t)}findByDataObject(e,t){return this.findAll({objects:{$elemMatch:{uid:e instanceof Ne?e.uid:e}}},t||{sort:[["createdTimestamp",-1]]})}_findTimestamp(e,t){return this.findAll({createdTimestamp:e},t)}}class MemoryQueryEvaluator{static isRegexQuery(e){return"[object RegExp]"===Object.prototype.toString.call(e)}static evaluateComponent(e,t,r){let i=!0;const n=e[t];return i=t.startsWith("$")?i&&MemoryQueryEvaluator.evaluateOp(t,e,r):t.includes(".")?i&&MemoryQueryEvaluator.evaluatePath(e,t,r):MemoryQueryEvaluator.isRegexQuery(r)?!(!i||!n.match(r)):"object"==typeof r?i&&MemoryQueryEvaluator.evaluateSelector(n,r):i&&n===r,i}static evaluate(e,t){let r=!0;if(t)for(const i of Object.keys(t))r=r&&MemoryQueryEvaluator.evaluateComponent(e,i,t[i]);return r}static getValueFromPath(e,t){let r=e;const i=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");for(let e=0,t=i.length;e<t;++e){const n=i[e];if(!r)return;if(!(n in r))return;if(!(e<t-1))return[r,r[n],n];r=r[n]}}static evaluatePath(e,t,r){const i=MemoryQueryEvaluator.getValueFromPath(e,t);return!!i&&MemoryQueryEvaluator.evaluateComponent(i[0],i[2],r)}static evaluateSelector(e,t){let r=!0;for(const i of Object.keys(t))r=r&&MemoryQueryEvaluator.evaluateComparisonSelector(i,e,t),r=r&&MemoryQueryEvaluator.evaluateArraySelector(i,e,t);return r}static evaluateComparisonSelector(e,t,r){let i=!0;switch(e){case"$gt":i=i&&t>r[e];break;case"$gte":i=i&&t>=r[e];break;case"$lt":i=i&&t<r[e];break;case"$lte":i=i&&t<=r[e];break;case"$eq":i=i&&t===r[e]}return i}static evaluateArraySelector(e,t,r){let i=!0;switch(e){case"$in":i=i&&Array.from(t).includes(r[e]);break;case"$nin":i=i&&!Array.from(t).includes(r[e]);break;case"$elemMatch":i=!1,t instanceof Array?Array.from(t).forEach((t=>{i=t.key&&t.value?i||MemoryQueryEvaluator.evaluate(t.value,r[e]):i||MemoryQueryEvaluator.evaluate(t,r[e])})):t instanceof Map&&t.forEach((t=>{i=i||MemoryQueryEvaluator.evaluate(t,r[e])})),i=i&&i}return i}static evaluateOp(e,t,r){let i;switch(e){case"$and":i=!0;for(const e of r)i=i&&MemoryQueryEvaluator.evaluate(t,e);break;case"$or":i=!1;for(const e of r)i=i||MemoryQueryEvaluator.evaluate(t,e)}return i}}class MemoryDataService extends Ae{constructor(e,t){super(e,t),this._data=new Map}findByUID(e){return new Promise(((t,r)=>{this._data.has(e)?t(this.options.deserialize(this._data.get(e))):r(`${this.dataType.name} with identifier #${e} not found!`)}))}findOne(e,t={}){return new Promise(((r,i)=>{this.findAll(e,{limit:1,sort:t.sort}).then((e=>{if(e.length>0)return r(e[0]);r(void 0)})).catch(i)}))}findAll(e,t={}){return new Promise((r=>{t.limit=t.limit||this._data.size;let i=[];this._data.forEach((r=>{MemoryQueryEvaluator.evaluate(r,e)&&(i.push(r),!t.sort&&(i.length,t.limit))})),t.sort&&(i=i.sort(((e,r)=>t.sort.map((t=>{const i=MemoryQueryEvaluator.getValueFromPath(t[1]>0?e:r,t[0])[1],n=MemoryQueryEvaluator.getValueFromPath(t[1]>0?r:e,t[0])[1];return"number"==typeof i?i-n:"string"==typeof i?i.localeCompare(n):0})).reduce(((e,t)=>e+t)))).slice(0,t.limit)),i=i.map(this.options.deserialize),r(i)}))}insert(e,t){return new Promise((r=>{e&&t?(this._data.set(e,this.options.serialize(t)),r(t)):r(void 0)}))}delete(e){return new Promise(((t,r)=>{this._data.has(e)?(this._data.delete(e),t()):r(`Unable to delete! ${this.dataType.name} with identifier #${e} not found!`)}))}count(e){return new Promise((t=>{if(void 0===e)t(this._data.size);else{let r=0;for(const[,t]of this._data)MemoryQueryEvaluator.evaluate(t,e)&&r++;t(r)}}))}deleteAll(e){return new Promise((t=>{if(void 0===e)this._data=new Map;else for(const[t,r]of this._data)MemoryQueryEvaluator.evaluate(r,e)&&this.delete(t);t()}))}}class BufferNode extends ze{constructor(e){super(e),this.on("pull",this.onPull.bind(this)),this.on("push",this.onPush.bind(this)),this.on("build",this._initService.bind(this))}_initService(){return new Promise((e=>{this.service||(this.service=this.model.findDataService(this.options.service||qe)),e()}))}onPull(e){return new Promise(((t,r)=>{this.shift().then((r=>{r&&this.outlets.forEach((t=>t.push(r,e))),t()})).catch(r)}))}onPush(e){return new Promise(((t,r)=>{this.service.insertFrame(e).then((()=>{t()})).catch(r)}))}next(){return new Promise(((e,t)=>{this.service.findOne({},{sort:[["createdTimestamp",1]]}).then(e).catch(t)}))}shift(){return new Promise(((e,t)=>{let r;this.next().then((t=>{if(t)return r=t,this.service.delete(t.uid);e(void 0)})).then((()=>e(r))).catch(t)}))}}class MemoryBufferNode extends BufferNode{constructor(e){super(e),this.service=new DataFrameService(new MemoryDataService(qe,{serialize:e=>e,deserialize:e=>e}))}}let Ke=class SinkNode extends ze{constructor(e){super(e),this.options.completedEvent=void 0===this.options.completedEvent||this.options.completedEvent,this.options.persistence=void 0===this.options.persistence||this.options.persistence}push(e,t){return new Promise(((r,i)=>{if(null==e)return i();this.onPush(e,t).then((()=>{const t=[];return e instanceof Array?e.forEach((e=>{this.options.persistence&&t.push(this.persistDataObject(e))})):this.options.persistence&&t.push(this.persistDataObject(e)),Promise.all(t)})).then((()=>{r(),this.options.completedEvent&&(e instanceof Array?e.forEach((e=>{this.emit("completed",{frameUID:e.uid})})):this.emit("completed",{frameUID:e.uid}))})).catch(i)}))}persistDataObject(e){return new Promise(((t,r)=>{const i=[],n=e.getObjects();for(const e of n){null===e.uid&&(e.uid=R());const t=this.model.findDataService(e);i.push(t.insert(e.uid,e))}Promise.all(i).then((()=>t())).catch(r)}))}};Ke=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],Ke);class CallbackSinkNode extends Ke{constructor(e=(()=>null),t){super(t),this.callback=e}onPush(e,t){return new Promise(((r,i)=>{Promise.resolve(this.callback(e,t)).then(r).catch(i)}))}}class PushError extends Error{constructor(e,t,r){super(),this.frameUID=e,this.nodeUID=t,this.name=r.name,this.message=r.message,this.stack=r.stack}}class MergeShape extends Ve{constructor(e,t,r){super(r),this._queue=new Map,this._mergeKeyFn=e,this._groupFn=t,this.options.timeout=this.options.timeout||100,this.options.timeoutUnit=this.options.timeoutUnit||S.MILLISECOND,this._timeout=this.options.timeoutUnit.convert(this.options.timeout,L.getUnit()),this.once("build",this._start.bind(this)),this.once("destroy",this._stop.bind(this))}_start(){return new Promise((e=>{this.options.minCount=this.options.minCount||this.inlets.length,this.options.maxCount=this.options.maxCount||this.inlets.length;const t=this.options.checkInterval||L.getUnit().convert(this._timeout,S.MILLISECOND);this._timeout>0&&(this._timer=setInterval(this._timerTick.bind(this),t)),e()}))}_timerTick(){this._queue.forEach((e=>{this._purgeQueue(e)}))}_purgeQueue(e){const t=L.now();if(!(void 0!==e&&this._queue.has(e.key)&&t-e.timestamp>=this._timeout&&e.frames.size>=this.options.minCount))return e;{const t=Array.from(e.frames.values());try{this.outlets.forEach((r=>r.push(this.merge(t,e.key)))),this._queue.delete(e.key),e.promises.forEach((e=>{e(void 0)}))}catch(e){this.emit("error",new PushError(t[0].uid,this.uid,e))}}}_stop(){void 0!==this._timer&&clearInterval(this._timer)}process(e,t){return new Promise((r=>{if(1===this.options.maxCount)return r(e);const i=this._mergeKeyFn(e,t);if(void 0===i)return r(void 0);(Array.isArray(i)?i:[i]).forEach((i=>{let n=this._purgeQueue(this._queue.get(i));if(void 0===n)n=new QueuedMerge(i),n.promises.push(r),n.frames.set(this._groupFn(e,t),e),this._queue.set(i,n);else{const s=this._groupFn(e,t);if(n.frames.has(s)?n.frames.set(s,this.merge([n.frames.get(s),e])):n.frames.set(s,e),n.frames.size>=this.options.maxCount){this._queue.delete(i);const e=this.merge(Array.from(n.frames.values()),i);r(e),n.promises.forEach((e=>{e(void 0)}))}else n.promises.push(r)}}))}))}}class QueuedMerge{constructor(e){this.frames=new Map,this.promises=[],this.key=e,this.timestamp=L.now()}}class FrameMergeNode extends MergeShape{mergeObjects(e){const t=e[0];for(let r=1;r<e.length;r++)e[r].getRelativePositions().forEach((e=>{t.addRelativePosition(e)}));const r=e.map((e=>e.getPosition())).filter((e=>void 0!==e));if(0===r.length)return t;let i=r[0].clone();for(let e=1;e<r.length;e++)i=this.mergePositions(i,r[e].clone());return i.accuracy&&(i.accuracy.value=1/i.accuracy.value),i.linearVelocity&&i.linearVelocity.setAccuracy(1/i.linearVelocity.accuracy.valueOf()),t.setPosition(i),t}mergePositions(e,t){const r=e;if(!t)return r;const i=e.accuracy||new B(1,e.unit);let n=t.accuracy||new B(1,t.unit);return n=n.to(i.unit),r.fromVector(r.toVector3().multiplyScalar(1/i.valueOf()).add(t.toVector3(r.unit).multiplyScalar(1/n.valueOf()))),r.fromVector(r.toVector3().divideScalar(1/i.valueOf()+1/n.valueOf())),r.accuracy.value=1/(i.valueOf()+n.valueOf()),r.linearVelocity=this._mergeVelocity(r.linearVelocity,t.linearVelocity),r.orientation=this._mergeOrientation(r.orientation,t.orientation),r.timestamp=Math.round((e.timestamp*(1/i.value)+t.timestamp*(1/n.value))/(1/i.value+1/n.value)),r}_mergeVelocity(e,t){if(t)if(e){const r=e.accuracy.valueOf()||1,i=t.accuracy.valueOf()||1;e.multiplyScalar(1/r).add(t.multiplyScalar(1/i)),e.divideScalar(1/r+1/i),e.setAccuracy(1/(r+i))}else e=t;return e}_mergeOrientation(e,t){if(t)if(e){const r=e.accuracy||new B(1,E.RADIAN),i=t.accuracy||new B(1,E.RADIAN),n=(1/r.value+1/i.value)/i.value/2;e.slerp(t,n)}else e=t;return e}merge(e){const t=e[0],r=new Map;t.getObjects().forEach((e=>{r.get(e.uid)?r.get(e.uid).push(e):r.set(e.uid,[e])}));for(let i=1;i<e.length;i++){const n=e[i];n.getObjects().forEach((e=>{t.hasObject(e)?r.get(e.uid).push(e):(t.addObject(e),r.set(e.uid,[e]))})),Object.keys(n).forEach((e=>{const r=t[e];null==r&&(t[e]=n[e])}))}return r.forEach((e=>{const r=this.mergeObjects(e);t.addObject(r)})),t}}class ObjectMergeNode extends FrameMergeNode{constructor(e,t){super((e=>e.getObjects().filter((t=>this.options.objectFilter(t,e))).map((e=>e.uid))),e,t),this.options.objectFilter=this.options.objectFilter||(()=>!0)}merge(e){const t=super.merge(e);return t.getObjects().filter((e=>!this.options.objectFilter(e,t))).forEach((e=>{t.removeObject(e)})),t}}class FrameDebounceNode extends Ve{constructor(e,t){super(),this._accept=!0,this._timeout=e,this._timeoutUnit=t,this.once("build",this._start.bind(this)),this.once("destroy",this._stop.bind(this))}_start(){return new Promise((e=>{this._timer=setInterval((()=>{this._accept=!0}),this._timeoutUnit.convert(this._timeout,S.MILLISECOND)),e(),this.emit("ready")}))}_stop(){void 0!==this._timer&&clearInterval(this._timer)}process(e){return new Promise((t=>{this._accept?(this._accept=!1,t(e)):t(void 0)}))}}class ObjectFilterNode extends Ve{constructor(e,t){super(t),this.options.objectFilter=this.options.objectFilter||e}process(e){return new Promise((t=>{e.getObjects().filter((t=>!this.options.objectFilter(t,e))).forEach(e.removeObject),t(e)}))}}class BroadcastNode extends ze{}class Edge extends T.EventEmitter{constructor(e,t){super(),this.inputNode=e,this.outputNode=t,this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this))}_onPush(e,t){return this.outputNode.push(e,t)}_onPull(e){return this.inputNode.pull(e)}push(e,t={}){return new Promise((r=>{const i=Object.assign(Object.assign({},t),{lastNode:this.inputNode.uid}),n=this.listeners("push");Promise.all(n.map((t=>t(e,i)))).then((()=>{r()})).catch((t=>{Array.isArray(e)?e.forEach((e=>{this.inputNode.emit("error",new PushError(e.uid,this.outputNode.uid,t))})):this.inputNode.emit("error",new PushError(e.uid,this.outputNode.uid,t))}))}))}pull(e){return new Promise(((t,r)=>{const i=this.listeners("pull");Promise.all(i.map((t=>t(e)))).then((()=>{t()})).catch(r)}))}emit(e,t){return this.inputNode.emit(e,t)}on(e,t){return this.removeAllListeners(e),super.on(e,t)}}let Qe=class GraphShape extends ze{constructor(){super(),this._nodes=new Map,this._edges=new Map,this.internalSource=new BroadcastNode,this.internalSink=new BroadcastNode,this.logger=()=>{},this.addNode(this.internalSource),this.addNode(this.internalSink),this.once("build",this._onBuild.bind(this)),this.once("destroy",this._onDestroy.bind(this)),this.removeAllListeners("error"),this.internalSource.on("error",this.onError.bind(this)),this.internalSink.on("error",this.onError.bind(this)),this.removeAllListeners("completed"),this.internalSource.on("completed",this.onCompleted.bind(this)),this.internalSink.on("completed",this.onCompleted.bind(this))}_onDestroy(){this.nodes.forEach((e=>{e.emit("destroy")}))}_onBuild(e){return new Promise(((t,r)=>{Promise.all(this.nodes.map((t=>t.emitAsync("build",e)))).then((()=>{this.emit("ready"),t()})).catch((e=>{r(e)}))}))}get edges(){return this._edges?Array.from(this._edges.values()):[]}set edges(e){e.forEach(this.addEdge)}get nodes(){return this._nodes?Array.from(this._nodes.values()):[]}set nodes(e){e.forEach(this.addNode)}findNodeByUID(e){return this._nodes.get(e)}findNodeByName(e){let t;return this._nodes.forEach((r=>{r.name!==e||(t=r)})),t}addNode(e){e.graph=void 0===this.graph?this:this.model,this._nodes.set(e.uid,e)}addEdge(e){this._edges.set(e.inputNode.uid+e.outputNode.uid,e)}deleteEdge(e){this._edges.delete(e.inputNode.uid+e.outputNode.uid)}deleteNode(e){this._nodes.delete(e.uid)}findEdge(e,t){return this._edges.get(e+t)}pull(e){return this.internalSink.pull(e)}push(e,t){return this.internalSource.push(e,t)}onError(e){this.listenerCount("error")>0&&this.emit("error",e)}onCompleted(e){this.emit("completed",e)}};(0,n.gn)([He(String,Te,{name:"nodes"}),(0,n.w6)("design:type",Map)],Qe.prototype,"_nodes",void 0),(0,n.gn)([He(String,Edge,{serializer:e=>Array.from(e.values()).map((e=>({input:e.inputNode.uid,output:e.outputNode.uid}))),name:"edges"}),(0,n.w6)("design:type",Map)],Qe.prototype,"_edges",void 0),(0,n.gn)([(0,s._)({serializer:e=>e.uid,deserializer:()=>{}}),(0,n.w6)("design:type",Te)],Qe.prototype,"internalSource",void 0),(0,n.gn)([(0,s._)({serializer:e=>e.uid,deserializer:()=>{}}),(0,n.w6)("design:type",Te)],Qe.prototype,"internalSink",void 0),Qe=(0,n.gn)([_({initializer:(e,t)=>{const r=new(l.C.findTypeByName(t.__type));return Object.assign(r,e),t.edges.forEach((t=>{r._edges.set(t.input+t.output,new Edge(e._nodes.get(t.input),e._nodes.get(t.output)))})),r}}),(0,n.w6)("design:paramtypes",[])],Qe);class PlaceholderNode extends ze{constructor(e,t){super(Object.assign({name:e},t))}}let Je=class SourceNode extends ze{constructor(e){super(e),this.options.persistence=void 0===this.options.persistence||this.options.persistence,this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this)),this.source&&this.once("build",this.registerService.bind(this))}get source(){return this.options.source}registerService(){return new Promise((e=>{const t=this.model.findDataService(this.source);t.on("insert",((e,t)=>{e===this.source.uid&&(this.options.source=t)})),t.findByUID(this.source.uid).then((t=>{this.options.source=t,e()})).catch((()=>{e()}))}))}_onPush(e,t){return new Promise(((r,i)=>{const n=[];if(this.options.persistence)if(e instanceof Array)for(const t of e)n.push(this.mergeFrame(t));else n.push(this.mergeFrame(e));Promise.all(n).then((()=>{this.outlets.map((r=>r.push(e,t))),r()})).catch(i)}))}mergeFrame(e){return new Promise(((t,r)=>{const i=this.model.findDataService(Ne),n=[],s=[];e.getObjects().forEach((e=>{s.push(e)})),s.forEach((e=>{n.push(new Promise((t=>{let r=this.model.findDataService(e);null==r&&(r=i),r.findByUID(e.uid).then((r=>{null===r&&t(),this.mergeObject(e,r),t()})).catch((()=>{t()}))})))})),Promise.all(n).then((()=>{t(e)})).catch(r)}))}mergeObject(e,t){return e.displayName=e.displayName||t.displayName,e.position=e.position||t.position,e.parentUID=e.parentUID||t.parentUID,t.relativePositions.forEach((t=>{const r=e.getRelativePosition(t.referenceObjectUID,t.constructor.name);r&&r.timestamp<t.timestamp?e.addRelativePosition(t):r||e.addRelativePosition(t)})),e}_onPull(e={}){if(e.sourceNode&&e.sourceNode!==this.uid)return Promise.resolve();return void 0===e.sequentialPull||e.sequentialPull?this._onSequentialPull(e):this._onParallelPull(e)}_onSequentialPull(e){const t=Object.assign({sourceNode:this.uid},e),r=e.count||1;let i=Promise.resolve();for(let n=0;n<r;n++)i=i.then((()=>new Promise(((r,i)=>{this.onPull(e).then((e=>{if(null!=e)return this.push(e,t);r()})).then(r).catch(i)}))));return i}_onParallelPull(e){return new Promise(((t,r)=>{const i=Object.assign({sourceNode:this.uid},e),n=e.count||1;Promise.all([...Array(n).keys()].map((()=>this.onPull(e)))).then((e=>{const t=[];return e.forEach((e=>{null!=e&&t.push(this.push(e,i))})),Promise.all(t)})).then((()=>{t()})).catch(r)}))}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],Je.prototype,"options",void 0),Je=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],Je);class GraphValidator{static validate(e){this.validateNodes(e),this.validateEdges(e)}static _validateInternalNode(e,t){if(0===t.outlets.length&&0===t.inlets.length)e.deleteNode(t);else if(!e.findNodeByUID(t.uid))throw new Error(`Internal node ${t.uid} (${t.name}) is not connected to the graph!`)}static validateNodes(e){GraphValidator._validateInternalNode(e,e.internalSource),GraphValidator._validateInternalNode(e,e.internalSink),e.nodes.forEach((e=>{if(void 0===e.graph)throw new Error(`Node ${e.uid} (${e.name}) does not have a graph set!`);if(0===e.inlets.length&&0===e.outlets.length)throw new Error(`Node ${e.uid} (${e.name}) is not connected to the graph!`)}))}static validateEdges(e){e.edges.forEach((t=>{if(!e.findNodeByUID(t.inputNode.uid))throw new Error(`Node ${t.inputNode.uid} (${t.inputNode.name}) is used in an edge but not added to the graph!`);if(!e.findNodeByUID(t.outputNode.uid))throw new Error(`Node ${t.outputNode.uid} (${t.outputNode.name}) is used in an edge but not added to the graph!`)}))}}class GraphBuilder{constructor(e=new Qe){this.graph=e,this.graph.name="graph"}static create(){return new GraphBuilder}on(e,t){return this.graph.once(e,t),this}from(...e){const t=[];return e.forEach((e=>{if(void 0===e)throw new Error("Undefined node was provided as a source!");if("string"==typeof e){let r=this.graph.findNodeByUID(e)||this.graph.findNodeByName(e);void 0===r&&(r=new PlaceholderNode(e)),this.graph.addNode(r),t.push(r)}else this.graph.addNode(e),e instanceof Je&&this.graph.addEdge(new Edge(this.graph.internalSource,e)),t.push(e)})),new GraphShapeBuilder(this,this.graph,0===t.length?[this.graph.internalSource]:t)}addNode(e){return this.graph.addNode(e),this}addEdge(e){return this.graph.addEdge(e),this}deleteEdge(e){return this.graph.deleteEdge(e),this}deleteNode(e){return this.graph.deleteNode(e),this}addShape(e){let t;return t=e instanceof GraphBuilder?e.graph:e,t.nodes.forEach((e=>{if(e instanceof PlaceholderNode){const r=this.graph.findNodeByUID(e.name)||this.graph.findNodeByName(e.name);if(r){const i=t.edges.filter((t=>t.inputNode===e)),n=t.edges.filter((t=>t.outputNode===e));i.map((e=>e.inputNode=r)),n.map((e=>e.outputNode=r)),this.addNode(r)}else this.addNode(e)}else this.addNode(e)})),t.edges.forEach((e=>{this.addEdge(e)})),this.graph.addEdge(new Edge(this.graph.internalSource,t.internalSource)),this.graph.addEdge(new Edge(t.internalSink,this.graph.internalSink)),this}build(){return new Promise(((e,t)=>{GraphValidator.validate(this.graph),this.graph.once("ready",(()=>{e(this.graph)})),this.graph.emitAsync("build",this).catch((e=>{this.graph.emit("destroy"),t(e)}))}))}}class GraphShapeBuilder{constructor(e,t,r){this.graphBuilder=e,this.previousNodes=r,this.graph=t}viaGraph(e){return e.nodes.forEach((e=>{e.graph=this.graph,this.graph.addNode(e)})),e.edges.forEach((e=>{this.graph.addEdge(e)})),this._insertNode(e.internalSource),e.internalSink}via(...e){const t=[];return e.forEach((e=>{if(void 0===e)throw new Error("Undefined node was provided!");if(e instanceof GraphBuilder)t.push(this.viaGraph(e.graph));else if(e instanceof Qe)t.push(this.viaGraph(e));else{let r;"string"==typeof e?(r=this.graph.findNodeByUID(e)||this.graph.findNodeByName(e),void 0===r&&(r=new PlaceholderNode(e))):r=e,this.graph.addNode(r),this._insertNode(r),t.push(r)}})),this.previousNodes=t,this}_insertNode(e){this.previousNodes.forEach((t=>{this.graph.addEdge(new Edge(t,e))}))}static registerShape(e,t){GraphShapeBuilder.shapes.set(e,t)}chunk(e,t,r){return this.via(GraphShapeBuilder.shapes.get("chunk")(e,t,r))}flatten(){return this.via(GraphShapeBuilder.shapes.get("flatten")())}filter(e){return this.via(GraphShapeBuilder.shapes.get("filter")(e))}filterObjects(e){return this.via(GraphShapeBuilder.shapes.get("filterObjects")(e))}merge(e=(()=>!0),t=100,r=S.MILLISECOND){return this.via(GraphShapeBuilder.shapes.get("merge")(e,t,r))}debounce(e=100,t=S.MILLISECOND){return this.via(GraphShapeBuilder.shapes.get("debounce")(e,t))}delay(e=100,t=S.MILLISECOND){return this.via(GraphShapeBuilder.shapes.get("delay")(e,t))}clone(){return this.via(GraphShapeBuilder.shapes.get("clone")())}convertToSpace(e){return this.via(GraphShapeBuilder.shapes.get("convertToSpace")(e))}convertFromSpace(e){return this.via(GraphShapeBuilder.shapes.get("convertFromSpace")(e))}buffer(){return this.via(GraphShapeBuilder.shapes.get("buffer")())}store(){return this.to(GraphShapeBuilder.shapes.get("store")())}to(...e){if(0!==e.length){const t=[];e.forEach((e=>{let r;if(void 0===e)throw new Error("Undefined node was provided as a sink!");"string"==typeof e?(r=this.graph.findNodeByUID(e)||this.graph.findNodeByName(e),void 0===r&&(r=new PlaceholderNode(e))):r=e,this.graph.addNode(r),this._insertNode(r),this.graph.addEdge(new Edge(r,this.graph.internalSink)),t.push(r)})),this.previousNodes=t}else this._insertNode(this.graph.internalSink);return this.graphBuilder}}GraphShapeBuilder.shapes=new Map,GraphShapeBuilder.registerShape("convertToSpace",(e=>new ReferenceSpaceConversionNode(e,{inverse:!1}))),GraphShapeBuilder.registerShape("convertFromSpace",(e=>new ReferenceSpaceConversionNode(e,{inverse:!0}))),GraphShapeBuilder.registerShape("chunk",((e,t,r)=>new FrameChunkNode(e,t,r))),GraphShapeBuilder.registerShape("clone",(()=>new FrameCloneNode)),GraphShapeBuilder.registerShape("debounce",((e,t)=>new FrameDebounceNode(e,t))),GraphShapeBuilder.registerShape("delay",((e,t)=>new FrameDelayNode(e,t))),GraphShapeBuilder.registerShape("filter",(e=>new FrameFilterNode(e))),GraphShapeBuilder.registerShape("flatten",(()=>new FrameFlattenNode)),GraphShapeBuilder.registerShape("buffer",(()=>new MemoryBufferNode)),GraphShapeBuilder.registerShape("filterObjects",(e=>new ObjectFilterNode(e))),GraphShapeBuilder.registerShape("store",(()=>new CallbackSinkNode)),GraphShapeBuilder.registerShape("merge",((e,t,r)=>new ObjectMergeNode(e,{timeout:t,timeoutUnit:r})));let Ze=class UnitValue{constructor(e,t){this._value=e,this._unit=t}to(e){if(!e)throw new Error(`${this.constructor.name} does not have a unit to convert from!`);const t=this.unit.convert(this.valueOf(),e);return new this.constructor(t,e)}get unit(){return this._unit}toString(){const e=this.valueOf();return e?e.toString():void 0}valueOf(){return this._value}setValue(e){return this._value=e,this}clone(){const e=new this.constructor;return e._value=this._value,e._unit=this._unit,e}};var Ye;(0,n.gn)([(0,s._)({name:"value"}),(0,n.w6)("design:type",Object)],Ze.prototype,"_value",void 0),(0,n.gn)([(0,s._)({name:"unit"}),(0,n.w6)("design:type",Object)],Ze.prototype,"_unit",void 0),Ze=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object])],Ze);let Xe=Ye=class AccelerationUnit extends x{};var et;Xe.METER_PER_SECOND_SQUARE=new Ye("meter per second squared",{baseName:"acceleration",aliases:["m/s^2","m/s2","meters per second squared"]}).addUnit(w.METER,1).addUnit(S.SECOND,-2),Xe.GRAVITATIONAL_FORCE=new Ye("gravitational force",{baseName:"acceleration",aliases:["g-force","G","GS"],definitions:[{magnitude:9.78033,unit:"m/s^2"}]}),Xe=Ye=(0,n.gn)([_()],Xe);let tt=et=class MagnetismUnit extends v{};var rt;tt.TESLA=new et("tesla",{baseName:"magnetism",aliases:["T"],prefixes:"decimal"}),tt.MICROTESLA=et.TESLA.specifier(UnitPrefix.MICRO),tt=et=(0,n.gn)([_()],tt);let it=rt=class TemperatureUnit extends v{};var nt;it.CELCIUS=new rt("celcius",{baseName:"temperature"}),it.FAHRENHEIT=new rt("fahrenheit",{baseName:"temperature",definitions:[{unit:"celcius",offset:-32,magnitude:5/9}]}),it.KELVIN=new rt("kelvin",{baseName:"temperature",definitions:[{unit:"celcius",offset:-273.15}]}),it.RANKINE=new rt("rankine",{baseName:"temperature",definitions:[{unit:"kelvin",magnitude:1/1.8}]}),it=rt=(0,n.gn)([_()],it);let st=nt=class LuminanceIntensityUnit extends v{};var ot;st.CANDELA=new nt("candela",{baseName:"luminanceintensity",aliases:["cd"]}),st=nt=(0,n.gn)([_()],st);let at=ot=class LuminanceUnit extends v{};var ct;at.LUMEN=new ot("lumen",{baseName:"luminance",aliases:["lm"],prefixes:"decimal"}),at=ot=(0,n.gn)([_()],at);let ut=ct=class PressureUnit extends v{};ut.PASCAL=new ct("pascal",{baseName:"pressure",aliases:["P"],prefixes:"decimal"}),ut=ct=(0,n.gn)([_()],ut);class Vector2_Vector2{constructor(e=0,t=0){Vector2_Vector2.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(d(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}let lt=class Vector2 extends Vector2_Vector2{static fromArray(e){return(new this).fromArray(e)}clone(){return(new this.constructor).copy(this)}};(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],lt.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],lt.prototype,"y",void 0),lt=(0,n.gn)([_()],lt);class Vector4_Vector4{constructor(e=0,t=0,r=0,i=1){Vector4_Vector4.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n;const s=.01,o=.1,a=e.elements,c=a[0],u=a[4],l=a[8],h=a[1],p=a[5],_=a[9],d=a[2],y=a[6],f=a[10];if(Math.abs(u-h)<s&&Math.abs(l-d)<s&&Math.abs(_-y)<s){if(Math.abs(u+h)<o&&Math.abs(l+d)<o&&Math.abs(_+y)<o&&Math.abs(c+p+f-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(c+1)/2,a=(p+1)/2,m=(f+1)/2,b=(u+h)/4,v=(l+d)/4,g=(_+y)/4;return e>a&&e>m?e<s?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(e),i=b/r,n=v/r):a>m?a<s?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(a),r=b/i,n=g/i):m<s?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(m),r=v/n,i=g/n),this.set(r,i,n,t),this}let m=Math.sqrt((y-_)*(y-_)+(l-d)*(l-d)+(h-u)*(h-u));return Math.abs(m)<.001&&(m=1),this.x=(y-_)/m,this.y=(l-d)/m,this.z=(h-u)/m,this.w=Math.acos((c+p+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}let ht=class Vector4 extends Vector4_Vector4{static fromArray(e){return(new this).fromArray(e)}clone(){return(new this.constructor).copy(this)}};(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ht.prototype,"x",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ht.prototype,"y",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ht.prototype,"z",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ht.prototype,"w",void 0),ht=(0,n.gn)([_()],ht);class Matrix3_Matrix3{constructor(e,t,r,i,n,s,o,a,c){Matrix3_Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,i,n,s,o,a,c)}set(e,t,r,i,n,s,o,a,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=n,u[5]=a,u[6]=r,u[7]=s,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,n=this.elements,s=r[0],o=r[3],a=r[6],c=r[1],u=r[4],l=r[7],h=r[2],p=r[5],_=r[8],d=i[0],y=i[3],f=i[6],m=i[1],b=i[4],v=i[7],g=i[2],w=i[5],x=i[8];return n[0]=s*d+o*m+a*g,n[3]=s*y+o*b+a*w,n[6]=s*f+o*v+a*x,n[1]=c*d+u*m+l*g,n[4]=c*y+u*b+l*w,n[7]=c*f+u*v+l*x,n[2]=h*d+p*m+_*g,n[5]=h*y+p*b+_*w,n[8]=h*f+p*v+_*x,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],c=e[7],u=e[8];return t*s*u-t*o*c-r*n*u+r*o*a+i*n*c-i*s*a}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],c=e[7],u=e[8],l=u*s-o*c,h=o*a-u*n,p=c*n-s*a,_=t*l+r*h+i*p;if(0===_)return this.set(0,0,0,0,0,0,0,0,0);const d=1/_;return e[0]=l*d,e[1]=(i*c-u*r)*d,e[2]=(o*r-i*s)*d,e[3]=h*d,e[4]=(u*t-i*a)*d,e[5]=(i*n-o*t)*d,e[6]=p*d,e[7]=(r*a-c*t)*d,e[8]=(s*t-r*n)*d,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,o){const a=Math.cos(n),c=Math.sin(n);return this.set(r*a,r*c,-r*(a*s+c*o)+s+e,-i*c,i*a,-i*(-c*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(pt.makeScale(e,t)),this}rotate(e){return this.premultiply(pt.makeRotation(-e)),this}translate(e,t){return this.premultiply(pt.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const pt=new Matrix3_Matrix3;let _t=class Matrix3 extends Matrix3_Matrix3{static fromArray(e){const t=new this;return t.fromArray([].concat(...e)),t.transpose(),t}clone(){return(new this.constructor).fromArray(this.elements)}};(0,n.gn)([ue(Number,{numberType:u.DECIMAL}),(0,n.w6)("design:type",Array)],_t.prototype,"elements",void 0),_t=(0,n.gn)([_()],_t);var dt=r(750);let yt=class SensorCalibrationData{};(0,n.gn)([(0,s._)((()=>v)),(0,n.w6)("design:type",v)],yt.prototype,"unit",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],yt.prototype,"offset",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],yt.prototype,"multiplier",void 0),yt=(0,n.gn)([_()],yt);let ft=class SensorObject extends Ne{constructor(e,t,r,i){super(e,i),this.value=null!=t?t:{},this.frequency=r}get timestamp(){return this.value instanceof W||this.value instanceof me?this.value.timestamp:this.createdTimestamp}get raw(){if(this.calibrationData){if(this.value instanceof W){let e=this.value.clone();const t=this.calibrationData.offset,r=this.calibrationData.multiplier;return r&&(e=e.divide(r)),t&&(e=e.sub(t)),e}return this.value}if("number"==typeof this.value){const e=this.calibrationData.offset,t=this.calibrationData.multiplier;return this.value/(null!=t?t:1)-(null!=e?e:0)}return this.value}set raw(e){if(this.calibrationData)if(e instanceof W){let t=e.clone();const r=this.calibrationData.offset,i=this.calibrationData.multiplier;r&&(t=t.add(r)),i&&(t=t.multiply(i)),this.value=t}else this.value=e;else if("number"==typeof e){const t=this.calibrationData.offset,r=this.calibrationData.multiplier;this.value=(e+(null!=t?t:0))*(null!=r?r:1)}else this.value=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Object)],ft.prototype,"value",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],ft.prototype,"frequency",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",yt)],ft.prototype,"calibrationData",void 0),ft=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,Object,Number,String])],ft);let mt=class Acceleration extends W{constructor(e=0,t=0,r=0,i=Xe.METER_PER_SECOND_SQUARE){super(e,t,r,i,Xe.METER_PER_SECOND_SQUARE)}};mt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object,Object,Object])],mt);let bt=class Accelerometer extends ft{constructor(e,t,r,i){super(e,null!=t?t:new mt,r,i)}};bt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,mt,Number,String])],bt);let vt=class GravitySensor extends ft{constructor(e,t,r,i){super(e,null!=t?t:new mt,r,i)}};vt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,mt,Number,String])],vt);let gt=class Gyroscope extends ft{constructor(e,t,r,i){super(e,null!=t?t:new $,r,i)}};gt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,$,Number,String])],gt);let wt=class LinearAccelerationSensor extends ft{constructor(e,t,r,i){super(e,null!=t?t:new mt,r,i)}};wt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,mt,Number,String])],wt);let xt=class AbsoluteOrientationSensor extends ft{constructor(e,t,r,i){super(e,null!=t?t:new me,r,i)}};xt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,me,Number,String])],xt);let Mt=class RelativeOrientationSensor extends ft{constructor(e,t,r,i){super(e,null!=t?t:new me,r,i)}};Mt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,me,Number,String])],Mt);let Et=class Magnetism extends W{constructor(e,t,r,i=tt.MICROTESLA){super(e,t,r,i,tt.MICROTESLA)}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",tt)],Et.prototype,"unit",void 0),Et=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],Et);let kt=class Magnetometer extends ft{constructor(e,t,r,i){super(e,null!=t?t:new Et,r,i)}};kt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,Et,Number,String])],kt);let St=class LinearVelocitySensor extends ft{constructor(e,t,r,i){super(e,null!=t?t:new q,r,i)}};St=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String,q,Number,String])],St);let Pt=class ActuatableProperty{};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",String)],Pt.prototype,"name",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",Function)],Pt.prototype,"callback",void 0),Pt=(0,n.gn)([_()],Pt);let Nt=class ActuatableObject extends Ne{constructor(){super(...arguments),this.properties=new Map}invoke(e,...t){const r=this.properties.get(e);return r?r.callback(t):Promise.resolve(void 0)}};(0,n.gn)([He(String,(()=>Pt)),(0,n.w6)("design:type",Map)],Nt.prototype,"properties",void 0),Nt=(0,n.gn)([_()],Nt);let Tt=class Absolute2DPosition extends ke{constructor(e,t,r=w.METER){super(),this.vector=new m,this.vector.x=r.convert(e||0,w.METER),this.vector.y=r.convert(t||0,w.METER)}get x(){if(this.vector)return this.vector.x}set x(e){this.vector&&(this.vector.x=e)}get y(){if(this.vector)return this.vector.y}set y(e){this.vector&&(this.vector.y=e)}angleTo(e){return this.vector.angleTo(e.vector)}fromVector(e,t){return t?(this.x=t.convert(e.x,this.unit),this.y=t.convert(e.y,this.unit)):(this.x=e.x,this.y=e.y),this}toVector3(e){return e?new m(this.unit.convert(this.x,e),this.unit.convert(this.y,e)):new m(this.x,this.y)}clone(){const e=super.clone();return e.x=this.x,e.y=this.y,e}};(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Tt.prototype,"x",null),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Tt.prototype,"y",null),Tt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,w])],Tt);let zt=class Absolute3DPosition extends Tt{constructor(e,t,r,i=w.METER){super(e,t,i),this.vector.z=i.convert(r||0,w.METER)}get z(){if(this.vector)return this.vector.z}set z(e){this.vector&&(this.vector.z=e)}fromVector(e,t){var r,i;return t?(this.x=t.convert(e.x,this.unit),this.y=t.convert(e.y,this.unit),this.z=t.convert(null!==(r=e.z)&&void 0!==r?r:0,this.unit)):(this.x=e.x,this.y=e.y,this.z=null!==(i=e.z)&&void 0!==i?i:0),this}toVector3(e){return e?new m(this.unit.convert(this.x,e),this.unit.convert(this.y,e),this.unit.convert(this.z,e)):new m(this.x,this.y,this.z)}clone(){const e=super.clone();return e.x=this.x,e.y=this.y,e.z=this.z,e}};var At;(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],zt.prototype,"z",null),zt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,w])],zt);let Dt=At=class GeographicalPosition extends zt{constructor(e,t,r){super(),this.latitude=e,this.longitude=t,this.z=r}get latitude(){return this.y}set latitude(e){this.y=e}get longitude(){return this.x}set longitude(e){this.x=e}get altitude(){return this.z}set altitude(e){this.z=e}distanceTo(e){return super.distanceTo(e,ge)}bearing(e){return E.RADIAN.convert(this.angleTo(e),E.DEGREE)}angleTo(e){const t=E.DEGREE.convert(this.longitude,E.RADIAN),r=E.DEGREE.convert(this.latitude,E.RADIAN),i=E.DEGREE.convert(e.longitude,E.RADIAN),n=E.DEGREE.convert(e.latitude,E.RADIAN),s=Math.sin(i-t)*Math.cos(n),o=Math.cos(r)*Math.sin(n)-Math.sin(r)*Math.cos(n)*Math.cos(i-t);return Math.atan2(s,o)}destination(e,t,r=E.DEGREE,i=w.METER){t=i.convert(t,w.METER);const n=r.convert(e,E.RADIAN),s=r.convert(this.longitude,E.RADIAN),o=r.convert(this.latitude,E.RADIAN),a=Math.asin(Math.sin(o)*Math.cos(t/ve.EARTH_RADIUS_MEAN)+Math.cos(o)*Math.sin(t/ve.EARTH_RADIUS_MEAN)*Math.cos(n)),c=s+Math.atan2(Math.sin(n)*Math.sin(t/ve.EARTH_RADIUS_MEAN)*Math.cos(o),Math.cos(t/ve.EARTH_RADIUS_MEAN)-Math.sin(o)*Math.sin(a)),u=new At;return u.latitude=E.RADIAN.convert(a,E.DEGREE),u.longitude=E.RADIAN.convert(c,E.DEGREE),u.altitude=this.altitude,u.unit=this.unit,u}fromVector(e,t=ve.WGS84){let r;return t instanceof w?r=ve.ECEF.convert(new m(t.convert(e.x,w.METER),t.convert(e.y,w.METER),t.convert(e.z,w.METER)),ve.WGS84):t instanceof ve&&(r=t.convert(e,ve.WGS84)),this.x=r.x,this.y=r.y,this.z=r.z,this}toVector3(e=ve.WGS84){return e instanceof ve?ve.WGS84.convert(new m(this.x,this.y,this.z),e):e instanceof w?ve.WGS84.convert(new m(w.METER.convert(this.x,e),w.METER.convert(this.y,e),w.METER.convert(this.z,e)),ve.ECEF):void 0}clone(){const e=super.clone();return e.latitude=this.latitude,e.longitude=this.longitude,e.z=this.altitude,e}};Dt=At=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number])],Dt);let Ot=class Relative2DPosition extends Se{constructor(e,t,r,i=w.METER){super(e,new m,i),this.referenceValue.x=i.convert(t||0,w.METER),this.referenceValue.y=i.convert(r||0,w.METER)}get x(){if(this.referenceValue)return this.referenceValue.x}set x(e){this.referenceValue&&(this.referenceValue.x=e)}get y(){if(this.referenceValue)return this.referenceValue.y}set y(e){this.referenceValue&&(this.referenceValue.y=e)}fromVector(e,t){return t?(this.x=t.convert(e.x,this.unit),this.y=t.convert(e.y,this.unit)):(this.x=e.x,this.y=e.y),this}toVector3(e){return e?new m(this.unit.convert(this.x,e),this.unit.convert(this.y,e)):new m(this.x,this.y)}clone(){const e=super.clone();return e.x=this.x,e.y=this.y,e}};(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Ot.prototype,"x",null),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Ot.prototype,"y",null),Ot=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Number,Number,w])],Ot);let Ct=class Relative3DPosition extends Ot{constructor(e,t,r,i,n=w.METER){super(e,t,r,n),this.referenceValue.z=n.convert(i||0,w.METER)}get z(){if(this.referenceValue)return this.referenceValue.z}set z(e){this.referenceValue&&(this.referenceValue.z=e)}fromVector(e,t){var r,i;return t?(this.x=t.convert(e.x,this.unit),this.y=t.convert(e.y,this.unit),this.z=t.convert(null!==(r=e.z)&&void 0!==r?r:0,this.unit)):(this.x=e.x,this.y=e.y,this.z=null!==(i=e.z)&&void 0!==i?i:0),this}toVector3(e){return e?new m(this.unit.convert(this.x,e),this.unit.convert(this.y,e),this.unit.convert(this.z,e)):new m(this.x,this.y,this.z)}clone(){const e=super.clone();return e.x=this.x,e.y=this.y,e.z=this.z,e}};(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Ct.prototype,"z",null),Ct=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Number,Number,Number,w])],Ct);let jt=class RelativeOrientation extends Se{constructor(e,t,r,i,n,s){super(e,new me,E.DEGREE),this.referenceValue.x=t,this.referenceValue.y=r,this.referenceValue.z=i,this.referenceValue.w=n,this.accuracy=s||new B(0,E.RADIAN)}static fromQuaternion(e){return new me(e.x,e.y,e.z,e.w)}clone(){const e=super.clone();return e.accuracy=this.accuracy?this.accuracy.clone():void 0,e.timestamp=this.timestamp,e}};jt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Number,Number,Number,Number,V])],jt);let Rt=class RelativeAngle extends Se{constructor(e,t,r,i){super(e,t,r||E.RADIAN),this.orientation=new me,this.unit=r,i&&(this.orientation=i)}get angleUnit(){return this.unit}set angleUnit(e){this.unit=e}get angle(){return this.referenceValue}set angle(e){this.referenceValue=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",me)],Rt.prototype,"orientation",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",E)],Rt.prototype,"unit",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],Rt.prototype,"referenceValue",void 0),Rt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Number,E,me])],Rt);let Ut=class RelativeDistance extends Se{constructor(e,t,r){super(e,t,w.METER),this.unit=r}get distanceUnit(){return this.unit}set distanceUnit(e){this.unit=e}get distance(){return this.referenceValue}set distance(e){this.referenceValue=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",w)],Ut.prototype,"unit",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number)],Ut.prototype,"referenceValue",void 0),Ut=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Number,w])],Ut);let It=class RelativeAngularVelocity extends Se{constructor(e,t){super(e,t,N.RADIAN_PER_MINUTE)}get velocity(){return this.referenceValue}set velocity(e){this.referenceValue=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",$)],It.prototype,"referenceValue",void 0),It=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,$])],It);let Ft=class RelativeLinearVelocity extends Se{constructor(e,t){super(e,t,G.METER_PER_SECOND)}get velocity(){return this.referenceValue}set velocity(e){this.referenceValue=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",q)],Ft.prototype,"referenceValue",void 0),Ft=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,q])],Ft);let Lt=class Trajectory{get trajectoryStart(){return this.positions&&0!==this.positions.length?this.positions[0].timestamp:-1}get trajectoryEnd(){return this.positions&&0!==this.positions.length?this.positions[this.positions.length-1].timestamp:-1}constructor(e){this.uid=R(),this.positions=[],this.objectUID=e,this.createdTimestamp=L.now()}};(0,n.gn)([(0,s._)({primaryKey:!0}),(0,n.w6)("design:type",String)],Lt.prototype,"uid",void 0),(0,n.gn)([(0,s._)({index:!0}),(0,n.w6)("design:type",String)],Lt.prototype,"objectUID",void 0),(0,n.gn)([ue(ke),(0,n.w6)("design:type",Array)],Lt.prototype,"positions",void 0),(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],Lt.prototype,"createdTimestamp",void 0),Lt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[String])],Lt);let Vt=class Pose extends le{constructor(){super(...arguments),this.timestamp=L.now(),this.unit=w.METER,this._probability=1}get probability(){return this._probability}set probability(e){if(e>1||e<0)throw new Error(`${this.constructor.name} should be between 0 and 1.`);this._probability=e}get accuracy(){return this._accuracy||(this._accuracy=new B(1,this.unit)),this._accuracy}set accuracy(e){this._accuracy=e}static fromMatrix4(e){const t=new this;return t.fromArray(e.toArray()),t}static fromPosition(e){const t=new this;t.timestamp=e.timestamp,t.unit=e.unit,t.probability=e.probability,t.accuracy=t.accuracy.clone();const r=e.toVector3();return e.orientation&&t.makeRotationFromQuaternion(e.orientation),t.setPosition(r.x,r.y,r.z),t}get orientation(){const e=this.extractRotation(this),t=me.fromRotationMatrix(e);return t.timestamp=this.timestamp,t}get position(){const e=this.copyPosition(this),t=new zt(e.elements[12],e.elements[13],e.elements[14]);return t.timestamp=this.timestamp,t.unit=this.unit,t.probability=this.probability,t.accuracy=this.accuracy.clone(),t.orientation=this.orientation,t}};function Bt(e,t){return void 0===t&&(t={}),function(r,i){var n,s="@jsonSetMember on "+(0,se.$0)(r.constructor)+"."+String(i),c=(0,oe.JD)(e,s),u=se.df?Reflect.getMetadata("design:type",r,i):null;null==u||u===Set||u===Object?(0,o.d3)(r,i,{type:function(){return(0,oe.zc)(c())},emitDefaultValue:t.emitDefaultValue,isRequired:t.isRequired,options:(0,a.M3)(t),key:i.toString(),name:null!==(n=t.name)&&void 0!==n?n:i.toString(),deserializer:t.deserializer,serializer:t.serializer}):(0,se.H)(s+": property is not a Set. "+se.AZ)}}function Wt(e,t){return(r,i)=>{const n=(0,p.W5)(r,i,t);Bt(e,n)(r,i),(0,p.EB)(r,i,n)}}(0,n.gn)([(0,s._)({index:!0,numberType:u.LONG}),(0,n.w6)("design:type",Number)],Vt.prototype,"timestamp",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",w)],Vt.prototype,"unit",void 0),(0,n.gn)([(0,s._)({name:"accuracy"}),(0,n.w6)("design:type",V)],Vt.prototype,"_accuracy",void 0),(0,n.gn)([(0,s._)({numberType:u.DECIMAL}),(0,n.w6)("design:type",Number),(0,n.w6)("design:paramtypes",[Number])],Vt.prototype,"probability",null),Vt=(0,n.gn)([_()],Vt);let $t=class Temperature extends W{constructor(e=0,t=it.CELCIUS){super(e,void 0,void 0,t,it.CELCIUS)}get value(){return this.x}set value(e){this.x=e}};$t=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object])],$t);let Ht=class Humidity extends W{constructor(e=0){super(e,void 0,void 0)}get value(){return this.x}set value(e){this.x=e}};Ht=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],Ht);let Gt=class Pressure extends W{constructor(e=0,t=ut.PASCAL){super(e,void 0,void 0,t,ut.PASCAL)}get value(){return this.x}set value(e){this.x=e}};Gt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object,Object])],Gt);let qt=class Accuracy2D extends V{constructor(e,t,r){super(new m,r),this.value.x=e,this.value.y=t}to(e){const t=super.to(e);return t.x=this.unit.convert(this.x,e),t.y=this.unit.convert(this.y,e),t}valueOf(){return(this.x+this.y)/2}toString(){return this.valueOf().toString()}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}};(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",m)],qt.prototype,"value",void 0),qt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Object])],qt);let Kt=class Accuracy3D extends qt{constructor(e,t,r,i){super(e,t,i),this.value.z=r}to(e){const t=super.to(e);return t.z=this.unit.convert(this.z,e),t}valueOf(){return(this.x+this.y+this.z)/3}get z(){return this.value.z}set z(e){this.value.z=e}};Kt=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Number,Number,Number,Object])],Kt);var Qt=r(141),Jt=r(446),Zt=r(188),Yt=r(844),Xt=function(){function e(e,t){this.serializer=new Yt.e,this.deserializer=new Zt.Z,this.globalKnownTypes=[],this.indent=0;var r=o.WR.getFromConstructor(e);if(void 0===r||!r.isExplicitlyMarked&&!r.isHandledWithoutAnnotation)throw new TypeError("The TypedJSON root data type must have the @jsonObject decorator used.");this.nameResolver=function(e){return(0,se.$0)(e)},this.rootConstructor=e,this.errorHandler=function(e){return(0,se.H)(e)},this.config(t)}return e.parse=function(t,r,i){return new e(r,i).parse(t)},e.parseAsArray=function(t,r,i,n){return new e(r,i).parseAsArray(t,n)},e.parseAsSet=function(t,r,i){return new e(r,i).parseAsSet(t)},e.parseAsMap=function(t,r,i,n){return new e(i,n).parseAsMap(t,r)},e.toPlainJson=function(t,r,i){return new e(r,i).toPlainJson(t)},e.toPlainArray=function(t,r,i,n){return new e(r,n).toPlainArray(t,i)},e.toPlainSet=function(t,r,i){return new e(r,i).toPlainSet(t)},e.toPlainMap=function(t,r,i,n){return new e(i,n).toPlainMap(t,r)},e.stringify=function(t,r,i){return new e(r,i).stringify(t)},e.stringifyAsArray=function(t,r,i,n){return new e(r,n).stringifyAsArray(t,i)},e.stringifyAsSet=function(t,r,i){return new e(r,i).stringifyAsSet(t)},e.stringifyAsMap=function(t,r,i,n){return new e(i,n).stringifyAsMap(t,r)},e.setGlobalConfig=function(e){Object.assign(this._globalConfig,e)},e.mapType=function(e,t){null==this._globalConfig.mappedTypes&&(this._globalConfig.mappedTypes=new Map),this._globalConfig.mappedTypes.set(e,t)},e.prototype.config=function(t){var r=this;null!=(t=(0,n.pi)((0,n.pi)({},e._globalConfig),t)).knownTypes&&null!=e._globalConfig.knownTypes&&(t.knownTypes=Array.from(new Set(t.knownTypes.concat(e._globalConfig.knownTypes))));var i=(0,a.M3)(t);this.serializer.options=i,this.deserializer.options=i,null!=t.errorHandler&&(this.errorHandler=t.errorHandler,this.deserializer.setErrorHandler(t.errorHandler),this.serializer.setErrorHandler(t.errorHandler)),null!=t.replacer&&(this.replacer=t.replacer),null!=t.typeResolver&&this.deserializer.setTypeResolver(t.typeResolver),null!=t.typeHintEmitter&&this.serializer.setTypeHintEmitter(t.typeHintEmitter),null!=t.indent&&(this.indent=t.indent),null!=t.mappedTypes&&t.mappedTypes.forEach((function(e,t){r.setSerializationStrategies(t,e)})),null!=t.nameResolver&&(this.nameResolver=t.nameResolver,this.deserializer.setNameResolver(t.nameResolver)),null!=t.knownTypes&&(t.knownTypes.forEach((function(e,t){null==e&&(0,se.KE)("TypedJSON.config: 'knownTypes' contains an undefined/null value (element "+t+").")})),this.globalKnownTypes=t.knownTypes)},e.prototype.mapType=function(e,t){this.setSerializationStrategies(e,t)},e.prototype.parse=function(e){var t,r=(0,se.W0)(e,this.rootConstructor);try{t=this.deserializer.convertSingleValue(r,(0,oe._k)(this.rootConstructor),this.getKnownTypes())}catch(e){this.errorHandler(e)}return t},e.prototype.parseAsArray=function(e,t){void 0===t&&(t=1);var r=(0,se.W0)(e,Array);return this.deserializer.convertSingleValue(r,ce((0,oe._k)(this.rootConstructor),t),this._mapKnownTypes(this.globalKnownTypes))},e.prototype.parseAsSet=function(e){var t=(0,se.W0)(e,Set);return this.deserializer.convertSingleValue(t,(0,oe.zc)(this.rootConstructor),this._mapKnownTypes(this.globalKnownTypes))},e.prototype.parseAsMap=function(e,t){var r=(0,se.W0)(e,Map);return this.deserializer.convertSingleValue(r,(0,oe.mY)(t,this.rootConstructor),this._mapKnownTypes(this.globalKnownTypes))},e.prototype.toPlainJson=function(e){try{return this.serializer.convertSingleValue(e,(0,oe._k)(this.rootConstructor))}catch(e){this.errorHandler(e)}},e.prototype.toPlainArray=function(e,t){void 0===t&&(t=1);try{return this.serializer.convertSingleValue(e,ce((0,oe._k)(this.rootConstructor),t))}catch(e){this.errorHandler(e)}},e.prototype.toPlainSet=function(e){try{return this.serializer.convertSingleValue(e,(0,oe.zc)(this.rootConstructor))}catch(e){this.errorHandler(e)}},e.prototype.toPlainMap=function(e,t){try{return this.serializer.convertSingleValue(e,(0,oe.mY)(t,this.rootConstructor))}catch(e){this.errorHandler(e)}},e.prototype.stringify=function(e){var t=this.toPlainJson(e);return void 0===t?"":JSON.stringify(t,this.replacer,this.indent)},e.prototype.stringifyAsArray=function(e,t){return JSON.stringify(this.toPlainArray(e,t),this.replacer,this.indent)},e.prototype.stringifyAsSet=function(e){return JSON.stringify(this.toPlainSet(e),this.replacer,this.indent)},e.prototype.stringifyAsMap=function(e,t){return JSON.stringify(this.toPlainMap(e,t),this.replacer,this.indent)},e.prototype.getKnownTypes=function(){var e=this,t=o.WR.getFromConstructor(this.rootConstructor),r=new Map;return this.globalKnownTypes.filter((function(e){return e})).forEach((function(t){r.set(e.nameResolver(t),t)})),void 0!==t&&(t.processDeferredKnownTypes(),t.knownTypes.forEach((function(t){r.set(e.nameResolver(t),t)}))),r},e.prototype._mapKnownTypes=function(e){var t=this,r=new Map;return e.filter((function(e){return e})).forEach((function(e){return r.set(t.nameResolver(e),e)})),r},e.prototype.setSerializationStrategies=function(e,t){var r=this;null!=t.deserializer&&this.deserializer.setDeserializationStrategy(e,(function(e){return t.deserializer(e,{fallback:function(e,t){return r.deserializer.convertSingleValue(e,(0,oe._k)(t),r.getKnownTypes())}})})),null!=t.serializer&&this.serializer.setSerializationStrategy(e,(function(e){return t.serializer(e,{fallback:function(e,t){return r.serializer.convertSingleValue(e,(0,oe._k)(t))}})}))},e._globalConfig={},e}(),er=r(255);function tr(e){if("function"!=typeof e)return function(t){rr(t,e)};rr(e,{})}function rr(e,t){if(!0!==t.overwrite&&void 0!==e.prototype.toJSON)throw new Error(e.name+" already has toJSON defined!");e.prototype.toJSON=function(){return Xt.toPlainJson(this,Object.getPrototypeOf(this).constructor)}}r(759);const ir=Object.assign(Object.assign({},i),{utils:{isInstanceOf:se.V9,isValueDefined:se.Jf,nameof:se.$0,isSubtypeOf:se.me},options:{mergeOptions:a.JH},typeDescriptor:{ensureTypeDescriptor:oe._k,ArrayTypeDescriptor:oe.GJ,MapTypeDescriptor:oe.br,SetTypeDescriptor:oe.do}});var nr;const sr="-0000-1000-8000-00805f9b34fb";let or=nr=class UUID{constructor(e){this._raw=e}static generate(){const e=R();return nr.fromString(e)}static fromBuffer(e,t){if(t){let t=new Uint8Array;for(let r=e.length-1;r>=0;r--)t=dt.o.concatBuffer(t,new Uint8Array([e[r]]));return new this(t)}return new this(e)}static fromString(e){const t=e.replace(sr,"").replace(/-/g,"").split(/(..)/).filter((e=>""!==e)).map((e=>Number(`0x${e}`)));if(t.includes(NaN))return;let r=Uint8Array.from(t);return e.startsWith("0000")&&(r=r.slice(2)),new this(r)}toBuffer(){return this._raw}to128bit(){return nr.fromString(this.toString(8))}toString(e,t=!0){e=null!=e?e:this._raw.byteLength;const r=[];for(const[,e]of this._raw.entries())r.push(e);const i=t?sr:"";if(2===e)return"0000"+r.map((e=>e.toString(16).padStart(2,"0"))).join("")+i;if(4===e)return r.map((e=>e.toString(16).padStart(2,"0"))).join("")+i;if(16===e){const e=r.map((e=>e.toString(16).padStart(2,"0")));return e.splice(0,4).join("")+"-"+e.splice(0,2).join("")+"-"+e.splice(0,2).join("")+"-"+e.splice(0,2).join("")+"-"+e.join("")}return r.map((e=>e.toString(16).padStart(2,"0"))).join("")}};(0,n.gn)([(0,s._)({name:"value"}),(0,n.w6)("design:type",Uint8Array)],or.prototype,"_raw",void 0),or=nr=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Uint8Array])],or);class DataObjectService extends De{constructor(e){super(e)}insertObject(e){return this.insert(e.uid,e)}insert(e,t){return new Promise(((r,i)=>{this.driver.insert(e,t).then((e=>{r(e)})).catch(i)}))}findByDisplayName(e){return this.findAll({displayName:e})}findByPosition(e){const t=e.toVector3();let r;return r=e instanceof zt?{"position.x":t.x,"position.y":t.y,"position.z":t.z}:{"position.x":t.x,"position.y":t.y},this.findAll(r)}findByParentUID(e){return this.findAll({parentUID:e})}findBefore(e){return this._findTimestamp({$lte:e})}findAfter(e){return this._findTimestamp({$gte:e})}_findTimestamp(e){return this.findAll({createdTimestamp:e})}}class ServiceProxy extends U{get(e,t){return"target"===t?e:"constructor"===t?e.constructor:"function"==typeof e[t]?this.createHandler(e,t):e[t]}set(e,t,r){return e[t]=r,!0}createHandler(e,t){const r=t;return(...i)=>("emit"!==r&&"emitAsync"!==r&&"on"!==r&&"once"!==r&&e.emit(r,...i),e[t](...i))}}class WorkerServiceProxy extends ServiceProxy{constructor(e){super(),this._promises=new Map,this.options=e,this.uid=e.uid,this.options.responseObservable&&this.options.responseObservable.subscribe(this._onOutput.bind(this))}_onOutput(e){if(this._promises.has(e.id)){const t=this._promises.get(e.id);if(e.success)if(void 0===e.result)t.resolve();else if(Array.isArray(e.result)){const r=[];e.result.forEach((e=>{e.__type?r.push(l.C.deserialize(e)):r.push(e)})),t.resolve(r)}else e.result.__type?t.resolve(l.C.deserialize(e.result)):t.resolve(e.result);else t.reject(e.result);this._promises.delete(e.id)}}get(e,t){const r=this[t];return r||("target"===t?e:this.createHandler(e,t))}createHandler(e,t){return(...e)=>new Promise(((r,i)=>{const n=R();this._promises.set(n,{resolve:r,reject:i});const s=[];e.forEach((e=>{l.C.findTypeByName(e.constructor.name)?s.push(l.C.serialize(e)):s.push(e)}));const o={id:n,serviceUID:this.uid,method:t,parameters:s};this.options.callObservable?this.options.callObservable.next(o):this.options.callFunction(o).then((e=>{this._onOutput(e)})).catch((e=>{this._onOutput(e)}))}))}}class TrajectoryService extends De{constructor(e,t){var r;super(e),this.options=t||{},this.options.autoBind=void 0===this.options.autoBind||this.options.autoBind,this.options.dataService=this.options.dataService||Ne,this.options.defaultUID=null!==(r=this.options.defaultUID)&&void 0!==r?r:e=>e.uid,this.options.autoBind&&this.once("build",this._bindService.bind(this))}_bindService(){return new Promise(((e,t)=>{if(!this.model)return e();const r=this.model.findDataService(this.options.dataService);r?(r.on("insert",((e,t)=>(0,n.mG)(this,void 0,void 0,(function*(){yield this.appendPosition(t)})))),e()):t(new Error(`Data object service not found for '${this.options.dataService}'`))}))}findCurrentTrajectory(e){return new Promise(((t,r)=>{this.findOne({objectUID:e instanceof Ne?e.uid:e},{sort:[["createdTimestamp",-1]]}).then(t).catch(r)}))}findTrajectoryByRange(e,t,r){return new Promise(((i,n)=>{this.findOne({objectUID:e instanceof Ne?e.uid:e,positions:{$elemMatch:{timestamp:{$lte:r?r instanceof Date?r.getTime():r:Number.MAX_VALUE,$gte:t?t instanceof Date?t.getTime():t:-1}}}}).then((e=>{i(e)})).catch(n)}))}findTrajectories(e){return new Promise((t=>{this.findAll({objectUID:e instanceof Ne?e.uid:e}).then((e=>{t(e.map((e=>e.uid)))}))}))}appendPosition(e,t){return new Promise(((r,i)=>{if(!e.getPosition())return i();Promise.resolve(t?this.findOne({uid:t}):this.findCurrentTrajectory(e)).then((r=>(r||((r=new this.driver.dataType).objectUID=e.uid,r.uid=null!=t?t:this.options.defaultUID(e)),r.positions.push(e.position),this.insert(r.uid,r)))).then(r).catch(i)}))}}class KeyValueDataService extends De{constructor(e,t){super(t),t||(this.driver=new MemoryDataService(Object,{serialize:e=>e,deserialize:e=>e}),this.driver.dataType=Object),this.uid=e||this.constructor.name}getValue(e){return this.findByUID(e)}setValue(e,t){return this.emit("set",e,t),this.insert(e,t)}}class LocationBasedService extends U{constructor(e){super(),this.watchers=new Map,this.watchedObjects=new Map,this.watchIndex=1,this.options=e||{},this.once("build",this._initLBS.bind(this)),this.once("destroy",this._destroy.bind(this))}_initLBS(){this.options.pullNode=this.options.pullNode||this.model.internalSink.uid,this.options.dataService=this.options.dataService||Ne,this.service=this.model.findDataService(this.options.dataService),this.service.on("insert",((e,t)=>{const r=this.watchedObjects.get(e);if(r){const e=t.position;r.forEach((t=>{const r=this.watchers.get(t);e&&r.callback(e)}))}}))}_destroy(){Array.from(this.watchers.keys()).forEach((e=>{this.clearWatch(e)}))}setCurrentPosition(e,t){return new Promise(((r,i)=>{const n=e instanceof Ne?e.uid:e;this.service.findByUID(n).then((e=>(e.setPosition(t),this.service.insertObject(e)))).then((()=>{r()})).catch(i)}))}getCurrentPosition(e,t={}){return new Promise(((r,i)=>{const n=t.maximumAge||1/0;t.timeout=t.timeout||1e4;const s=e instanceof Ne?e.uid:e;if(t.forceUpdate){this.model.findNodeByUID(this.options.pullNode).pull({requestedObjects:[s]});const n=setTimeout((()=>{this.clearWatch(o),i(new Error("Timeout error for getting current position!"))}),t.timeout),o=this.watchPosition(e,((e,t)=>{if(this.clearWatch(o),clearTimeout(n),t)return i(t);r(e)}),Object.assign(Object.assign({},t),{interval:-1,forceUpdate:!1}))}else this.service.findByUID(s).then((i=>{const s=i.position,o=L.getUnit().convert(L.now(),S.MILLISECOND);if(!(s&&s.timestamp>=o-n))return this.getCurrentPosition(e,Object.assign(Object.assign({},t),{forceUpdate:!0}));r(s)})).then(r).catch(i)}))}watchPosition(e,t,r={}){var i;const n=e instanceof Ne?e.uid:e,s=this.watchIndex++,o=null!==(i=r.interval)&&void 0!==i?i:1e3,a=-1!==o?setInterval((()=>{this.getCurrentPosition(e,r).then(t).catch((e=>{t(void 0,e)}))}),o):void 0;return this.watchers.set(s,{timer:a,uid:n,callback:t}),this.watchObject(n,s),s}watchObject(e,t){var r;const i=null!==(r=this.watchedObjects.get(e))&&void 0!==r?r:[];i.push(t),this.watchedObjects.set(e,i)}unwatchObject(e,t){var r;const i=null!==(r=this.watchedObjects.get(e))&&void 0!==r?r:[];i.splice(i.indexOf(t),1),0===i.length?this.watchedObjects.delete(e):this.watchedObjects.set(e,i)}clearWatch(e){const t=this.watchers.get(e);void 0!==t.timer&&clearInterval(t.timer),this.watchers.delete(e),this.unwatchObject(t.uid,e)}}let ar=class RemoteService extends U{constructor(){super(),this.nodes=new Set,this.localServices=new Set,this.remoteServices=new Set,this.promises=new Map,this.once("build",this._registerServices.bind(this))}_registerServices(){return new Promise((e=>{if(!this.model)return e();this.model.once("ready",(()=>{this.model.findAllServices().forEach((e=>{this.registerService(e)}))})),e()}))}registerPromise(e,t,r){const i=null!=r?r:this.generateUUID();return this.promises.set(i,{resolve:e,reject:t}),i}getPromise(e){const t=this.promises.get(e);return t&&this.promises.delete(e),t}localPush(e,t,r){if(r=r||{},this.nodes.has(e)){this.model.findNodeByUID(e).emit("localpush",t,r)}}localPull(e,t){t=t||{},this.nodes.has(e)&&this.model.findNodeByUID(e).emit("localpull",t)}localEvent(e,t,...r){this.nodes.has(e)&&this.model.findNodeByUID(e).emit("localevent",t,...r)}localServiceCall(e,t,...r){if(this.localServices.has(e)){return(this.model.findService(e)||this.model.findDataService(e))[t](...r)}}registerNode(e){return new Promise((t=>{const r=e instanceof ze?e:this.model.findNodeByUID(e);this.nodes.add(r.uid),this.logger("debug",`Registered remote server node ${r.uid}`),t()}))}registerService(e){return new Promise((t=>{e instanceof RemoteServiceProxy?this.remoteServices.add(e.uid):this.localServices.add(e.uid),t()}))}};ar=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[])],ar);class RemoteServiceProxy extends U{constructor(e){super(),this.options=e,this.uid=e.uid}get(e,t){const r=this[t];return r||this.createHandler(e,t)}set(e,t,r){return e[t]=r,!0}createHandler(e,t){if(!this.service){if(this.service=e.model.findService(this.options.service),void 0===this.service||null===this.service)return()=>{};this.service.registerService(this)}return(...r)=>this.service.remoteServiceCall(e.uid,t,...r)}}class DummyDataService extends De{constructor(e,t){super(void 0),this.uid=e,this._dataType=t}get dataType(){return this._dataType}}class DummyService extends U{constructor(e){super(),this.uid=e}}class CalibrationService extends DataObjectService{start(e,t){if(!this.node)throw new Error("Calibration node did not register itself to the calibration service!");this.node.start(e,t)}stop(){if(!this.node)throw new Error("Calibration node did not register itself to the calibration service!");this.node.stop()}suspend(){if(!this.node)throw new Error("Calibration node did not register itself to the calibration service!");this.node.suspend()}}class DataServiceProxy extends ServiceProxy{get(e,t){return"dataType"===t?e.dataType:super.get(e,t)}}let cr=class ModelGraph extends Qe{constructor(e="model"){super(),this._services=new Map,this._dataServices=new Map,this.name=e,this.referenceSpace=new We(void 0),this.removeAllListeners("build"),this.removeAllListeners("destroy"),this.once("build",this._onModelBuild.bind(this)),this.once("destroy",this._onModelDestroy.bind(this))}_onModelBuild(e){return new Promise(((t,r)=>{this.emit("prebuild",e),this._buildServices().then((()=>{for(const e of this.findAllServices())e.isReady()||e.emit("ready");return this._buildNodes(e)})).then((()=>{for(const e of this.nodes)e.isReady()||e.emit("ready");this.emit("ready"),this.emit("postbuild",this),t()})).catch(r)}))}_buildServices(){return new Promise(((e,t)=>{const r=[];this._services.forEach((e=>{e.isReady()||r.push(e.emitAsync("build"))})),this._dataServices.forEach((e=>{e.isReady()||r.push(e.emitAsync("build"))})),Promise.all(r).then((()=>e())).catch(t)}))}_buildNodes(e){return new Promise(((t,r)=>{const i=[];this.nodes.forEach((t=>{t.isReady()||i.push(t.emitAsync("build",e))})),Promise.all(i).then((()=>t())).catch(r)}))}_onModelDestroy(e){return new Promise(((t,r)=>{const i=[];this._services.forEach((t=>{i.push(t.emitAsync("destroy",e))})),this._dataServices.forEach((t=>{i.push(t.emitAsync("destroy",e))})),this.nodes.forEach((t=>{i.push(t.emitAsync("destroy",e))})),Promise.all(i).then((()=>{t()})).catch(r)}))}findService(e){let t;if(e)return t="string"==typeof e?this._services.get(e):Array.from(this._services.values()).filter((t=>t instanceof e))[0],t||(t=this.findDataService(e)),t}findDataService(e){let t;return t=void 0===e?void 0:"string"==typeof e?this._findDataServiceByUID(e):e.prototype instanceof De?this.findAllServices(e)[0]:e instanceof Function?this.findAllDataServices(e)[0]:this.findDataService(e.constructor),t}_findDataServiceByUID(e){return Array.from(this._dataServices.values()).filter((t=>t.uid===e))[0]}findAllServices(e){return void 0!==e?this.findAllServices().filter((t=>t instanceof e))||[]:Array.from(this._services.values()).concat(Array.from(this._dataServices.values()))||[]}findAllDataServices(e){return void 0!==e?this.findAllDataServices().map((t=>[t,...this._instanceofPriority(e,t.target.dataType)])).filter((e=>e[1])).sort(((e,t)=>e[2]===t[2]?t[0].priority-e[0].priority:e[2]-t[2])).map((e=>e[0]))||[]:Array.from(this._dataServices.values())||[]}_instanceofPriority(e,t){if(e===t)return[!0,0];let r=1;for(;e=Object.getPrototypeOf(e);){if(e===t)return[!0,r];r++}return[!1,void 0]}addService(e,t){e.model=void 0===this.graph?this:this.model,e instanceof De?this._dataServices.set(e.uid,new Proxy(e,t||new DataServiceProxy)):this._services.set(e.uid,new Proxy(e,t||new ServiceProxy))}push(e,t){return new Promise(((r,i)=>{const n=[],s=this.findDataService(e.constructor.name);s&&(Array.isArray(e)?e.forEach((t=>{n.push(s.insert(t.uid,e))})):n.push(s.insert(e.uid,e))),Promise.all(n).then((()=>this.internalSource.push(e,t))).then((()=>{r()})).catch(i)}))}destroy(){return this.emitAsync("destroy")}};(0,n.gn)([He(String,U,{name:"services"}),(0,n.w6)("design:type",Map)],cr.prototype,"_services",void 0),(0,n.gn)([He(String,De,{name:"dataServices"}),(0,n.w6)("design:type",Map)],cr.prototype,"_dataServices",void 0),(0,n.gn)([(0,s._)(),(0,n.w6)("design:type",We)],cr.prototype,"referenceSpace",void 0),cr=(0,n.gn)([_(),(0,n.w6)("design:paramtypes",[Object])],cr);class ModelBuilder extends GraphBuilder{constructor(){super(new cr),this.graph.name="model",this.graph.addService(new DataObjectService(new MemoryDataService(Ne))),this.graph.addService(new DataObjectService(new MemoryDataService(We))),this.graph.addService(new NodeDataService(new MemoryDataService(Le))),this.graph.addService(new L)}static create(){return new ModelBuilder}withLogger(e){return this.graph.logger=e,this}withReferenceSpace(e){return this.graph.referenceSpace=e,this}addService(e,t){return this.graph.addService(e,t),this}addServices(...e){return e.forEach((e=>this.addService(e))),this}addShape(e){return e instanceof cr?e.findAllServices().forEach((e=>{this.addService(e)})):e instanceof ModelBuilder&&e.graph.findAllServices().forEach((e=>{this.addService(e)})),super.addShape(e)}build(){return new Promise(((e,t)=>{GraphValidator.validate(this.graph),this.graph.once("ready",(()=>{e(this.graph)})),this.graph.emitAsync("build",this).catch((e=>{this.graph.emit("destroy"),t(e)}))}))}}class BalanceNode extends ze{constructor(){super(...arguments),this._busyNodes=[],this._queue=[]}push(e){return new Promise(((t,r)=>{this.logger("debug",`Received a data frame in the balance node ${this.uid}`,e);let i=!1;for(const n of this.outlets)if(-1===this._busyNodes.indexOf(n)){this._busyNodes.push(n),i=!0,n.push(e).then((()=>{this._busyNodes.splice(this._busyNodes.indexOf(n),1),this._updateQueue(),t()})).catch((e=>{this._updateQueue(),r(e)}));break}i||this._queue.push({frame:e,resolve:t,reject:r})}))}_updateQueue(){if(0!==this._queue.length)for(const e of this.outlets)if(-1===this._busyNodes.indexOf(e)){const t=this._queue.pop();e.push(t.frame).then((()=>{this._busyNodes.splice(this._busyNodes.indexOf(e),1),this._updateQueue(),t.resolve()})).catch((e=>{this._updateQueue(),t.reject(e)}));break}}}class TimedPullNode extends ze{constructor(e,t=S.MILLISECOND,r){super(r),this._pushFinished=!0,this._pullFinished=!0,this._interval=t.convert(e,S.MILLISECOND),this.options.autoStart=this.options.autoStart||!0,this.on("push",this._onPush.bind(this)),this.options.autoStart&&this.once("build",this.start.bind(this)),this.once("destroy",this.stop.bind(this))}_onPush(e,t){return new Promise(((r,i)=>{const n=[];n.push(...this.outlets.map((r=>r.push(e,t)))),clearInterval(this._timer),this._timer=setInterval(this._intervalFn.bind(this),this._interval),this._pushFinished=!1,Promise.all(n).then((()=>{r()})).catch(i).finally((()=>{this._pushFinished=!0}))}))}_intervalFn(){(this._pushFinished&&this._pullFinished||!this.options.throttlePull)&&(this._pullFinished=!0,Promise.all(this.inlets.map((e=>e.pull(this.options.pullOptions)))).then((()=>{this._pullFinished=!0})).catch((e=>{this.logger("error",e.message,e)})))}start(){return new Promise((e=>{this._timer&&this.stop(),this._timer=setInterval(this._intervalFn.bind(this),this._interval),e()}))}stop(){void 0!==this._timer&&(clearInterval(this._timer),this._timer=void 0)}}class SourceMergeNode extends FrameMergeNode{constructor(e){super((e=>void 0===e.source?null:e.source.uid),(e=>e.uid),e)}}class UnitConversionNode extends ObjectProcessingNode{constructor(e,t){super(t),this._unit=e}processObject(e){return new Promise((t=>{const r=e.getPosition();r&&r.unit!==this._unit&&(r.fromVector(r.toVector3(this._unit)),r.unit=this._unit,e.setPosition(r)),t(e)}))}}class ThrottleNode extends MemoryBufferNode{constructor(e){super(e),this._pushReady=!0,this.on("push",this.onThrottlePush.bind(this))}onThrottlePush(){return this._handlePush()}_handlePush(){return new Promise(((e,t)=>{this._pushReady?(this._pushReady=!1,this.onPull().then((()=>(this._pushReady=!0,this.service.count()))).then((t=>{t>0&&setTimeout(this._handlePush.bind(this),10),e()})).catch(t)):e()}))}}class TimeSyncNode extends MemoryBufferNode{constructor(e){super(e),this.on("build",this._initTimer.bind(this)),this.on("destroy",this._stopTimer.bind(this))}_initTimer(){this._timer=setInterval((()=>{this.triggerUpdate()}),this.options.checkInterval||100)}_stopTimer(){clearInterval(this._timer)}onPush(e,t){return new Promise(((r,i)=>{e.createdTimestamp<=L.now()?this.triggerUpdate().then((()=>{this.outlets.forEach((r=>r.push(e,t))),r()})).catch(i):super.onPush(e).then((()=>{r()})).catch(i)}))}triggerUpdate(){return new Promise(((e,t)=>{this.shift().then((t=>{if(t)return this.outlets.forEach((e=>e.push(t))),this.triggerUpdate();e()})).then(e).catch(t)}))}next(){return new Promise(((e,t)=>{super.next().then((t=>{if(t&&t.createdTimestamp<=L.now())return e(t);e(void 0)})).catch(t)}))}}class LoggingSinkNode extends CallbackSinkNode{constructor(e,t){super(e,t),void 0===e&&(this.callback=e=>{this.logger("debug",`Received a data frame in node ${this.uid}`,e)})}}class RemoteNode extends ze{constructor(e,t){var r,i;super(e),this.proxyNode=t,this.options.service=this.options.service||ar,this.options.serialize=null!==(r=this.options.serialize)&&void 0!==r?r:e=>l.C.serialize(e),this.options.deserialize=null!==(i=this.options.deserialize)&&void 0!==i?i:e=>l.C.deserialize(e),this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this)),this.on("error",this._onDownstreamError.bind(this)),this.on("completed",this._onDownstreamCompleted.bind(this)),this.on("localpush",this._onLocalPush.bind(this)),this.on("localpull",this._onLocalPull.bind(this)),this.on("localevent",this._onLocalEvent.bind(this)),this.once("build",this._onBuild.bind(this))}_onBuild(){return new Promise(((e,t)=>{if(this.service=this.graph.findService(this.options.service),void 0===this.service||null===this.service)return t(new Error("Remote service was not added to model!"));this.service.registerNode(this).then(e).catch(t)}))}_onPush(e,t){return new Promise((r=>{this.service.remotePush(this.uid,e,Object.assign(Object.assign({},t),this.options)),r()}))}_onPull(e){return new Promise((t=>{this.service.remotePull(this.uid,e),t()}))}_onLocalPush(e,t){return new Promise((r=>{const i=e instanceof qe?e:this.options.deserialize(e,t);this.outlets.forEach((e=>e.push(i,t))),r()}))}_onLocalPull(e){return new Promise(((t,r)=>{Promise.all(this.inlets.map((t=>t.pull(e)))).then((()=>{t()})).catch(r)}))}_onLocalEvent(e,t){this.inlets.forEach((r=>r.emit(e,t)))}_onDownstreamCompleted(e){this.service.remoteEvent(this.uid,"completed",e)}_onDownstreamError(e){this.service.remoteEvent(this.uid,"error",e)}}class RemoteSinkNode extends Ke{constructor(e){var t;super(e),this.remoteNode=new(null!==(t=e.type)&&void 0!==t?t:RemoteNode)(e,this),this.uid=`${this.uid}-sink`,this.once("build",this._onRemoteBuild.bind(this)),this.once("destroy",this._onRemoteDestroy.bind(this))}_onRemoteBuild(e){return this.remoteNode.graph=this.graph,e.addNode(this.remoteNode),e.addEdge(new Edge(this,this.remoteNode)),this.remoteNode.emitAsync("build",e)}_onRemoteDestroy(){return this.remoteNode.emitAsync("destroy")}onPush(e,t){return this.remoteNode.push(e,t)}}class ListSourceNode extends Je{constructor(e,t){super(t),this._inputData=[],this._inputData=e}get inputData(){return this._inputData}set inputData(e){this._inputData=e}get size(){return this._inputData.length}onPull(){return new Promise((e=>{0!==this._inputData.length&&e(this._inputData.shift()),e(null)}))}}class CallbackSourceNode extends Je{constructor(e=(()=>null),t){super(t),this.callback=e}onPull(e){return new Promise(((t,r)=>{Promise.resolve(this.callback(e)).then((e=>{t(e)})).catch(r)}))}}class HistorySourceNode extends Je{constructor(e){super(e)}onPull(e={requestedObjects:[]}){return new Promise(((t,r)=>{const i=this.model.findDataService(Ne),n=[];e.requestedObjects.forEach((e=>{n.push(new Promise((t=>{i.findByUID(e).then((e=>{t(e)})).catch((()=>{t(void 0)}))})))})),Promise.all(n).then((e=>{const r=new qe(this.source);e.forEach((e=>{e&&r.addObject(e)})),t(r)})).catch(r)}))}}class RemoteSourceNode extends Je{constructor(e){var t;super(e),this.remoteNode=new(null!==(t=e.type)&&void 0!==t?t:RemoteNode)(e,this),this.uid=`${this.uid}-source`,this.once("build",this._onRemoteBuild.bind(this)),this.on("error",this._onDownstreamError.bind(this)),this.on("completed",this._onDownstreamCompleted.bind(this))}_onRemoteBuild(e){return this.remoteNode.graph=this.graph,e.addNode(this.remoteNode),e.addEdge(new Edge(this.remoteNode,this)),this.remoteNode.emitAsync("build",e)}onPull(){return new Promise(((e,t)=>{this.remoteNode.pull().then((()=>{e(void 0)})).catch(t)}))}_onDownstreamError(e){this.remoteNode.emit("error",e)}_onDownstreamCompleted(e){this.remoteNode.emit("completed",e)}}class FilterProcessingNode extends ObjectProcessingNode{constructor(e){super(e)}processObject(e,t){return new Promise(((r,i)=>{this.getNodeData(e).then((s=>(0,n.mG)(this,void 0,void 0,(function*(){void 0===s?s=Object.assign({timestamp:L.now()},yield this.initFilter(e,t,this.options)):s.timestamp?s.timestamp+this.options.expire<L.now()&&(s=Object.assign({timestamp:L.now()},yield this.initFilter(e,t,this.options))):s=Object.assign({timestamp:L.now()},s),this.filter(e,t,s,this.options).then((e=>{r(e)})).catch(i).finally((()=>{this.setNodeData(e,s).then((()=>{r(void 0)})).catch(i)}))})))).catch(i)}))}}class PropertyFilterProcessingNode extends ObjectProcessingNode{constructor(e,t,r){super(r),this._propertySelector=e,this._propertyModifier=t}processObject(e,t){return new Promise(((r,i)=>{const n=this._propertySelector(e,t);Promise.all(n.map((t=>this.filterValue(e,t.value,t.key)))).then((i=>{for(let r=0;r<i.length;r++){const s=i[r],o=n[r];this._propertyModifier(o.key,s,e,t)}r(e)})).catch(i)}))}filterValue(e,t,r="default"){return new Promise(((i,s)=>{this.getNodeData(e).then((o=>(0,n.mG)(this,void 0,void 0,(function*(){void 0===o&&(o={});const n=L.now();if(void 0===o[r]?o[r]=Object.assign({timestamp:n},yield this.initFilter(e,t,this.options)):o[r]=Object.assign({timestamp:n},o[r]),this.options.expire){const e=[];Object.keys(o).forEach((t=>{const r=o[t];r.timestamp&&r.timestamp+this.options.expire<n&&e.push(t)})),e.forEach((e=>{delete o[e]}))}this.filter(e,t,o[r],this.options).then(i).catch(s).finally((()=>{this.setNodeData(e,o)}))})))).catch(s)}))}}class KalmanFilterNode extends PropertyFilterProcessingNode{constructor(e,t,r){super(e,t,r)}initFilter(e,t,r){return new Promise((e=>{Object.keys(r).forEach((e=>{"number"==typeof r[e]&&["R","Q","A","B","C"].includes(e)&&(r[e]=new m(r[e],0,0))})),e(Object.assign({x:void 0,cov:NaN},r))}))}filter(e,t,r){return new Promise((e=>{const i=new KalmanFilter(r.R,r.Q,r.A,r.B,r.C,r.x,r.cov),n="number"==typeof t;n?i.filter(new m(t,0,0)):i.filter(t),r.x=i.measurement,r.cov=i.covariance,e(n?i.measurement.x:i.measurement)}))}}class KalmanFilter{constructor(e,t,r,i,n,s,o){this._R=e,this._Q=t,this._A=r,this._B=i,this._C=n,this._x=s,this._cov=o}filter(e,t){if(void 0===this._x){const t=new m(1,1,1).divide(this._C);this._x=t.clone().multiply(e),this._cov=t.clone().multiply(this._Q).multiply(t)}else{const r=this.predict(t),i=this.uncertainty(),n=i.clone().multiply(this._C).multiply(new m(1,1,1).divide(this._C.clone().multiply(i).multiply(this._C).add(this._Q)));this._x=r.clone().add(n.clone().multiply(e.clone().sub(this._C.clone().multiply(r)))),this._cov=i.clone().sub(n.clone().multiply(this._C).multiply(i))}return this._x}predict(e){return this._A.clone().multiply(this._x).add(void 0===e?new m:this._B.clone().multiply(e))}uncertainty(){return this._A.clone().multiply(this._cov).multiply(this._A).add(this._R)}get measurement(){return this._x}get covariance(){return this._cov}}class LPFilterNode extends PropertyFilterProcessingNode{constructor(e,t,r){super(e,t,r)}initFilter(e,t,r){return new Promise((e=>{let i=r.alpha;if(void 0===i){const e=1/(2*r.cutOff*Math.PI),t=1/r.sampleRate;i=t/(e+t)}e({x:t,alpha:i})}))}filter(e,t,r){return new Promise((e=>{if("number"==typeof t)r.x=r.x+r.alpha*(t-r.x);else{const e=t.clone(),i=r.x;r.x=i.add(e.sub(r.x).multiplyScalar(r.alpha))}e(r.x)}))}}class HPFilterNode extends PropertyFilterProcessingNode{constructor(e,t,r){super(e,t,r)}initFilter(e,t,r){return new Promise((e=>{const i=1/(2*r.cutOff*Math.PI),n=1/r.sampleRate;e({x:t,y:t,alpha:i/(i+n)})}))}filter(e,t,r){return new Promise((e=>{"number"==typeof t?(r.x=r.alpha*(r.x+t-r.y),r.y=t,e(r.x)):(r.x=r.x.clone().add(t).sub(r.y).multiplyScalar(r.alpha),r.y=t,e(r.x))}))}}class SMAFilterNode extends PropertyFilterProcessingNode{constructor(e,t,r){super(e,t,r)}initFilter(e,t,r){return new Promise((e=>{if(r.taps<1)throw new Error("Filter taps needs to be higher than 1!");e({x:[],taps:r.taps})}))}filter(e,t,r,i){return new Promise((e=>{if(r.x.push(t),r.x.length>r.taps?r.x.shift():i.minTaps&&r.x.length<i.minTaps&&e(t),"number"==typeof t){e(r.x.reduce(((e,t)=>e+t))/r.taps)}else{const t=r.x[0].clone();for(let e=1;e<r.x.length;e++)t.add(r.x[e]);e(t.divideScalar(r.taps))}}))}}class EMAFilterNode extends PropertyFilterProcessingNode{constructor(e,t,r){super(e,t,r)}initFilter(e,t,r){return new Promise((e=>{if(r.alpha>1||r.alpha<0)throw new Error("Filter coefficient needs to be between 0 and 1!");e({x:t,alpha:r.alpha})}))}filter(e,t,r){return new Promise((e=>{if("number"==typeof t)r.x=r.x*(1-r.alpha)+r.alpha*t;else{const e=t,i=r.x;r.x=i.clone().multiplyScalar(1-r.alpha).add(e.clone().multiplyScalar(r.alpha))}e(r.x)}))}}class RelativePositionFilter extends KalmanFilterNode{constructor(e,t){super(void 0,void 0,t),this._relativePositionType=e,this.options.maxTimeDifference=this.options.maxTimeDifference||1/0}processObject(e){return new Promise(((t,r)=>{const i=e.relativePositions.filter((e=>e instanceof this._relativePositionType));Promise.all(i.map((t=>this.filterValue(e,t.referenceValue,t.referenceObjectUID)))).then((r=>{r.forEach(((t,r)=>{const n=t,s=i[r];"number"==typeof n&&(!this.options.maxValue||n<=this.options.maxValue)&&(!this.options.minValue||n>=this.options.minValue)&&L.now()-this.options.maxTimeDifference<=s.timestamp?s.referenceValue=n:e.removeRelativePositions(s.referenceObjectUID)})),t(e)})).catch(r)}))}}class RelativePositionProcessing extends ObjectProcessingNode{constructor(e,t){super(t),this._relativePositionType=e}processObject(e,t){return new Promise(((r,i)=>{const n=[],s=new Map;for(const r of e.relativePositions)r instanceof this._relativePositionType&&(s.set(r.referenceObjectUID,r),n.push(this.findObjectByUID(r.referenceObjectUID,t,r.referenceObjectType)));Promise.all(n).then((r=>{const i=new Map;return r.filter((e=>void 0!==e)).forEach((e=>{i.set(s.get(e.uid),e)})),this.processRelativePositions(e,i,t)})).then((e=>{r(e)})).catch(i)}))}}class MultilaterationNode extends RelativePositionProcessing{constructor(e){super(Ut,e),this.options.incrementStep=this.options.incrementStep||1,this.options.minReferences=this.options.minReferences||1,this.options.nlsFunction=this.options.nlsFunction||this.nls.bind(this)}processRelativePositions(e,t,r){return new Promise(((i,n)=>{let s,o=[];if(t.forEach(((e,t)=>{e.getPosition()&&o.push(new Sphere(e.getPosition(),t.distance,t.accuracy.valueOf()))})),o=o.sort(((e,t)=>e.radius-t.radius)),o.length<this.options.minReferences)return i(e);switch(o.length>this.options.maxReferences&&(o=o.splice(0,this.options.maxReferences)),o.length){case 0:return i(e);case 1:return s=o[0].position.clone(),s.timestamp=r.createdTimestamp,s.accuracy=new B(o[0].radius+s.accuracy.valueOf()+o[0].accuracy,s.unit),e.setPosition(s),i(e);case 2:return s=o[0].position instanceof Dt?this.midpointGeographical(o[0],o[1]):this.midpoint(o[0],o[1]),s.timestamp=r.createdTimestamp,s.accuracy=new B(o.map((e=>e.accuracy)).reduce(((e,t)=>e.valueOf()+t.valueOf()))/o.length,s.unit),e.setPosition(s),i(e);case 3:if(!this.options.preferNls){this.trilaterate(o).then((t=>{t&&(t.timestamp=r.createdTimestamp,t.accuracy=new B(o.map((e=>e.accuracy)).reduce(((e,t)=>e.valueOf()+t.valueOf()))/o.length,t.unit),e.setPosition(t)),i(e)})).catch(n);break}default:s=this.options.nlsFunction(o),s.timestamp=r.createdTimestamp,s.accuracy=new B(o.map((e=>e.accuracy)).reduce(((e,t)=>e.valueOf()+t.valueOf()))/o.length,s.unit),e.setPosition(s),i(e)}}))}nls(e){const t=t=>this._calculateError(t,e),r=this._calculateInit(e),i=this.options.maxIterations;let n=0;const s=r.length,o=new Array(s+1);o[0]=r,o[0].fx=t(r),o[0].id=0;for(let e=0;e<s;++e){const i=r.slice();i[e]=i[e]?1.05*i[e]:.001,o[e+1]=i,o[e+1].fx=t(i),o[e+1].id=e+1}function a(e){for(let t=0;t<e.length;t++)o[s][t]=e[t];o[s].fx=e.fx}function c(e,t,r,i,n){for(let s=0;s<e.length;++s)e[s]=t*r[s]+i*n[s]}const u=(e,t)=>e.fx-t.fx,l=r.slice(),h=r.slice(),p=r.slice(),_=r.slice();for(let e=0;e<i;++e){o.sort(u),n=0;for(let e=0;e<s;++e)n=Math.max(n,Math.abs(o[0][e]-o[1][e]));if(Math.abs(o[0].fx-o[s].fx)<1e-6&&n<1e-5)break;for(let e=0;e<s;++e){l[e]=0;for(let t=0;t<s;++t)l[e]+=o[t][e];l[e]/=s}const e=o[s];if(c(h,2,l,-1,e),h.fx=t(h),h.fx<o[0].fx)c(_,3,l,-2,e),_.fx=t(_),_.fx<h.fx?a(_):a(h);else if(h.fx>=o[s-1].fx){let r=!1;if(h.fx>e.fx?(c(p,.5,l,.5,e),p.fx=t(p),p.fx<e.fx?a(p):r=!0):(c(p,1.5,l,-.5,e),p.fx=t(p),p.fx<h.fx?a(p):r=!0),r){0;for(let e=1;e<o.length;++e)c(o[e],.5,o[0],.5,o[e]),o[e].fx=t(o[e])}}else a(h)}o.sort(u);const d=e[0].position.clone();return d.fromVector(new m(...o[0])),d}midpoint(e,t){const r=e.position,i=t.position,n=r.clone();return n.fromVector(r.toVector3().multiplyScalar(t.radius).add(i.toVector3().multiplyScalar(e.radius)).divideScalar(e.radius+t.radius)),n}midpointGeographical(e,t){const r=e.position,i=t.position;if(e.radius===t.radius){const e=E.DEGREE.convert(r.longitude,E.RADIAN),t=E.DEGREE.convert(r.latitude,E.RADIAN),n=E.DEGREE.convert(i.longitude,E.RADIAN),s=E.DEGREE.convert(i.latitude,E.RADIAN),o=Math.cos(s)*Math.cos(n-e),a=Math.cos(s)*Math.sin(n-e),c=Math.atan2(Math.sin(t)+Math.sin(s),Math.sqrt((Math.cos(t)+o)*(Math.cos(t)+o)+a*a)),u=e+Math.atan2(a,Math.cos(t)+o),l=new Dt;return l.latitude=E.RADIAN.convert(c,E.DEGREE),l.longitude=E.RADIAN.convert(u,E.DEGREE),l}{const n=r.bearing(i),s=i.bearing(r),o=r.destination(n,e.radius),a=i.destination(s,t.radius),c=this.midpoint(new Sphere(o,1,o.accuracy.valueOf()),new Sphere(a,1,a.accuracy.valueOf()));return c.accuracy=new B(Math.round(o.distanceTo(a)/2*100)/100,c.unit),c}}trilaterate(e){return new Promise((t=>{const r=this.options.maxIterations||900,i=e.map((e=>e.center)),n=i[1].clone().sub(i[0]).normalize(),s=n.clone().dot(i[2].clone().sub(i[0])),o=i[2].clone().sub(i[0]).sub(n.clone().multiplyScalar(s)).normalize(),a=n.clone().cross(o),c=i[1].clone().sub(i[0]).length(),u=o.clone().dot(i[2].clone().sub(i[0]));let l=e[0].radius,h=e[1].radius,p=e[2].radius,_=0,d=0,y=-1,f=0;do{_=(Math.pow(l,2)-Math.pow(h,2)+Math.pow(c,2))/(2*c),d=(Math.pow(l,2)-Math.pow(p,2)+Math.pow(s,2)+Math.pow(u,2))/(2*u)-s/u*_,y=Math.pow(l,2)-Math.pow(_,2)-Math.pow(d,2),l+=this.options.incrementStep,h+=this.options.incrementStep,p+=this.options.incrementStep,f++}while(y<-1e-10&&f<r);const m=Math.sqrt(y)||0,b=e[0].position.clone();return b.fromVector(i[0].clone().add(n.multiplyScalar(_)).add(o.multiplyScalar(d)).add(a.multiplyScalar(m))),t(b)}))}_calculateInit(e){const t=e[0],r=e.map((e=>e.radius)).reduce(((e,t)=>e+t)),i=new m(0,0,0);e.forEach((t=>{const n=(r-t.radius)/((e.length-1)*r);i.add(t.center.clone().multiplyScalar(n))}));const n=Math.min(1,t.radius/t.center.distanceTo(i)*.9);return i.multiplyScalar(n).add(t.center.clone().multiplyScalar(1-n)).toArray()}_calculateError(e,t){return t.map((t=>Math.pow(new m(...e).distanceTo(t.center)-t.radius,2))).reduce(((e,t)=>e+t))}}class Sphere{constructor(e,t,r){this.position=e,this.radius=t,this.accuracy=r}get center(){return this.position.toVector3()}}class TriangulationNode extends RelativePositionProcessing{constructor(e){super(Rt,e)}processRelativePositions(e,t,r){return new Promise(((i,n)=>{const s=[],o=[],a=[];switch(t.forEach(((e,t)=>{e.getPosition()&&(s.push(e),o.push(e.getPosition()),a.push(t.unit.convert(t.angle,E.RADIAN)))})),s.length){case 0:case 1:default:return i(e);case 2:break;case 3:this.triangulate(o,a).then((t=>{null!==t&&(t.timestamp=r.createdTimestamp,e.setPosition(t)),i(e)})).catch(n)}}))}triangulate(e,t){return new Promise(((r,i)=>{const n=[e[0].toVector3(),e[1].toVector3(),e[2].toVector3()],s=n[0].x-n[1].x,o=n[0].y-n[1].y,a=n[2].x-n[1].x,c=n[2].y-n[1].y,u=1/Math.tan(t[1]-t[0]),l=1/Math.tan(t[2]-t[1]),h=(1-u*l)/(u+l),p=s+u*o,_=o-u*s,d=a-l*c,y=c+l*a,f=s*a+o*c+h*(s*c-a*o),b=(p-d)*(y-(c+o-h*(a-s)))-(_-y)*(d-(a+s+h*(c-o)));if(0===b)return i();const v=n[1].x+f*(_-y)/b,g=n[1].y+f*(d-p)/b,w=e[0].clone();return w.unit=e[0].unit,w.fromVector(new m(v,g,0)),r(w)}))}}class AccuracyModifierNode extends ObjectProcessingNode{constructor(e){super(e),this.options.offsetUnit=this.options.offsetUnit||w.METER,this.options.offset=this.options.offset||0,this.options.magnitude=this.options.magnitude||1}processObject(e){return new Promise((t=>{if(e.position)if(this.options.value)e.position.accuracy.value=w.METER.convert(this.options.value,e.position.unit);else{const t=e.position.accuracy.value||this.options.defaultValue;if(t){const r=this.options.offsetUnit.convert(this.options.offset,e.position.unit);e.position.accuracy.value=t*this.options.magnitude+r}}t(e)}))}}class CellIdentificationNode extends RelativePositionProcessing{constructor(e){super(Ut,e),this.options.maxDistance=this.options.maxDistance||2}processRelativePositions(e,t,r){return new Promise((i=>{let n=[];if(t.forEach(((e,t)=>{e.getPosition()&&n.push([e.getPosition(),t.distance])})),n=n.sort(((e,t)=>e[1]-t[1])),n.length>0&&n[0][1]<=this.options.maxDistance){const t=n[0][0].clone();return t.timestamp=r.createdTimestamp,t.accuracy.value=n[0][1],e.setPosition(t),i(e)}i(e)}))}}class CalibrationNode extends ObjectProcessingNode{constructor(e){super(e),this.state=ur.IDLE,this.once("build",this._onBuild.bind(this))}_onBuild(){if(this.service=this.model.findService(this.options.service),!this.service)throw new Error(`Calibration node requires a calibration service of type '${this.options.service.name}'!`);this.service.node=this}processObject(e){return new Promise(((t,r)=>{this.state!==ur.RUNNING?t(e):this.objectCallback?Promise.resolve(this.objectCallback(e)).then((e=>{t(e)})).catch(r):t(e)}))}process(e){return new Promise(((t,r)=>{this.state===ur.SUSPENDED?t(void 0):this.state===ur.RUNNING?this.frameCallback?Promise.resolve(this.frameCallback(e)).then((t=>{var r;return super.process(null!==(r=t)&&void 0!==r?r:e)})).then((()=>{t(void 0)})).catch(r):super.process(e).then((()=>{t(void 0)})):t(e)}))}start(e,t){this.objectCallback=e,this.frameCallback=t,this.state=ur.RUNNING}suspend(){this.state=ur.SUSPENDED}stop(){this.state=ur.IDLE}}var ur;!function(e){e[e.IDLE=0]="IDLE",e[e.SUSPENDED=1]="SUSPENDED",e[e.RUNNING=2]="RUNNING"}(ur||(ur={}));var lr=r(734);class WorkerHandler extends AsyncEventEmitter{constructor(e,t,r){var i;super(),this._serviceOutputResponse=new Map,this.model=e,this.config=r,this.options=t,this.options.timeout=null!==(i=this.options.timeout)&&void 0!==i?i:1e4}build(){return new Promise((e=>{this._pool=(0,lr.Pool)((()=>this._spawnWorker()),{size:this.options.poolSize||4,concurrency:this.options.poolConcurrency||2}),this._pool.events().subscribe((t=>{"initialized"===t.type&&e()}))}))}destroy(){return new Promise(((e,t)=>{if(void 0===this._pool)return e();const r=setTimeout((()=>{this._pool.terminate(!0).then((()=>{e()})).catch((e=>{t(e)}))}),2500);this._pool.terminate().then((()=>{clearTimeout(r),e()})).catch((e=>{clearTimeout(r),t(e)}))}))}pull(e){return new Promise(((t,r)=>{this._pool.queue((t=>(0,t.pull)(e))).then(t).catch(r)}))}push(e,t){return new Promise(((r,i)=>{this._pool.queue((r=>(0,r.push)(l.C.serialize(e),t))).then((()=>{r()})).catch(i)}))}invokeMethod(e,...t){return new Promise(((r,i)=>{this._pool.queue((r=>(0,r.invokeMethod)(e,...t.map((e=>l.C.serialize(e)))))).then((e=>{r(void 0!==e?l.C.deserialize(e):e)})).catch(i)}))}createWorker(){if(this.options.blob){return new lr.BlobWorker(this.options.worker,{type:"typescript"===this.options.type?"classic":this.options.type})}return new lr.Worker(this.options.worker,{type:"typescript"===this.options.type?"classic":this.options.type})}_spawnWorker(){return new Promise(((e,t)=>{const r=this.createWorker();(0,lr.spawn)(r,{timeout:this.options.timeout}).then((i=>{const n=i.init,s=i.pushOutput,o=i.pullOutput,a=i.serviceOutputCall,c=i.serviceInputCall,u=i.eventOutput,l=i.findAllServices,h=r.threadId;this._serviceOutputResponse.set(h,i.serviceOutputResponse),o().subscribe(this._onWorkerPull.bind(this)),s().subscribe(this._onWorkerPush.bind(this)),a().subscribe(this._onWorkerService.bind(this,h)),u().subscribe(this._onWorkerEvent.bind(this)),n(Object.assign({directory:this.options.directory||"/",services:this._getServices(),imports:this.options.imports||[],args:this.options.args||{},type:this.options.type||"classic",methods:this.options.methods?this.options.methods.map((e=>({name:e.name,handlerFn:e.handler.toString()}))):[]},this.config)).then((()=>l())).then((t=>{this._addServices(t,c),e(i)})).catch(t)})).catch(t)}))}_getServices(){return(this.options.services||this.model.findAllServices()).map((e=>{const t=Object.getPrototypeOf(e);return{uid:e.uid,type:t.constructor.name,dataType:e instanceof De&&e.dataType?e.dataType.name:void 0}}))}_addServices(e,t){const r=this.model;e.filter((e=>void 0===(this.model.findService(e.name)||this.model.findDataService(e.name)))).forEach((e=>{if(e.dataType){const i=l.C.findTypeByName(e.dataType);r.addService(new DummyDataService(e.uid,i),new WorkerServiceProxy({uid:e.uid,callFunction:t}))}else r.addService(new DummyService(e.uid),new WorkerServiceProxy({uid:e.uid,callFunction:t}))}))}_onWorkerService(e,t){const r=this.model.findDataService(t.serviceUID)||this.model.findService(t.serviceUID);if(r[t.method]){const i=t.parameters,n=[];i.forEach((e=>{e.__type?n.push(l.C.deserialize(e)):n.push(e)}));const s=r[t.method](...n);Promise.resolve(s).then((r=>{if(Array.isArray(r)){const i=[];r.forEach((e=>{i.push(l.C.serialize(e))})),this._serviceOutputResponse.get(e)({id:t.id,success:!0,result:i})}else{const i=l.C.serialize(r);this._serviceOutputResponse.get(e)({id:t.id,success:!0,result:i})}})).catch((r=>{this._serviceOutputResponse.get(e)({id:t.id,success:!1,result:r})}))}}_onWorkerEvent(e){this.emit("event",e)}_onWorkerPull(e){this.emit("pull",e)}_onWorkerPush(e,t){const r=l.C.deserialize(e);this.emit("push",r,t)}}class WorkerNode extends ze{constructor(e,t){super(t),this.config={},this.options.worker=this.options.worker||"../worker/WorkerRunner",this.options.type=this.options.type||"classic",e instanceof GraphBuilder?this.config.serialized=l.C.serialize(e.graph):e instanceof ze?this.config.serialized=l.C.serialize(e):e instanceof Function?(this.config.builder=e.toString(),"typescript"===this.options.type&&(this.config.builder=r(313).transpile(this.config.builder))):this.config.shape=e,this.once("build",this._onBuild.bind(this)),this.once("destroy",this._onDestroy.bind(this)),this.on("pull",this._onPull.bind(this)),this.on("push",this._onPush.bind(this))}_onBuild(){return new Promise(((e,t)=>{this.handler=new WorkerHandler(this.model,this.options,this.config),this.handler.on("push",this._onWorkerPush.bind(this)),this.handler.on("pull",this._onWorkerPull.bind(this)),this.handler.on("event",this._onWorkerEvent.bind(this)),this.handler.build().then(e).catch(t)}))}_onDestroy(){return new Promise(((e,t)=>{this.handler.destroy().then(e).catch(t)}))}_onPull(e){return new Promise(((t,r)=>{this.options.optimizedPull?Promise.all(this.inlets.map((t=>t.pull(e)))).then((()=>{t()})).catch(r):this.handler.pull(e).then(t).catch(r)}))}_onPush(e,t){return this.handler.push(e,t)}_onWorkerEvent(e){this.inlets.map((t=>t.emit(e.name,e.event)))}_onWorkerPull(e){this.inlets.forEach((t=>t.pull(e)))}_onWorkerPush(e,t){this.outlets.forEach((r=>r.push(e,t)))}invokeMethod(e,...t){return this.handler.invokeMethod(e,...t)}}class CallbackNode extends ze{constructor(e=(()=>!0),t=(()=>null),r){super(r),this.pushCallback=e,this.pullCallback=t,this.on("push",this._onPush.bind(this)),this.on("pull",this._onPull.bind(this)),this.options.autoPush=this.options.autoPush||!0}_onPush(e,t){return new Promise(((r,i)=>{Promise.resolve(this.pushCallback(e,t)).then((()=>{if(this.options.autoPush)return Promise.all(this.outlets.map((r=>r.push(e,t))));r()})).then((()=>{r()})).catch(i)}))}_onPull(e){return new Promise(((t,r)=>{Promise.resolve(this.pullCallback(e)).then((i=>{null!=i?Promise.all(this.outlets.map((t=>t.push(i,e)))).then((()=>{t()})).catch(r):Promise.all(this.inlets.map((t=>t.pull(e)))).then((()=>{t()})).catch(r)})).catch(r)}))}}class GraphShapeNode extends ze{constructor(e){super(e),this.once("build",this._onBuild.bind(this)),this.once("destroy",this._onDestroy.bind(this))}_onBuild(){return new Promise(((e,t)=>{this.construct(this._builder),this._builder.build().then((t=>{this._graph=t,this._builder=null,e()})).catch(t)}))}_onDestroy(){return this._graph.emitAsync("destroy")}pull(e){return this._graph.pull(e)}push(e,t={}){return this._graph.push(e,t)}get processingGraph(){return this._graph}}class ModelSerializer{static get options(){return{serialize:l.C.serialize,deserialize:l.C.deserialize}}static serialize(e){return this.serializeNode(e)}static serializeNode(e){return this.initialize(),this.options.serialize(e)}static deserialize(e){const t=this.deserializeNode(e);return t.nodes.forEach((e=>{e.graph=t})),t}static deserializeNode(e){return this.initialize(),this.options.deserialize(e)}static loadClasses(e=r.c[r.s]){void 0!==e?(this._modules.add(e.id),e.exports&&Object.keys(e.exports).forEach((t=>{const r=e.exports[t];r&&r.prototype instanceof ze?this.NODES.set(t,{constructor:r}):r&&r.prototype instanceof U&&this.SERVICES.set(t,{constructor:r})})),e.children&&e.children.forEach((e=>{this._modules.has(e.id)||this.loadClasses(e)}))):Object.values(r.c).map((e=>this.loadClasses(e)))}static initialize(){0!==this.SERVICES.size&&0!==this.NODES.size||(this.loadClasses(),this._modules.clear(),this.SERVICES.forEach((e=>l.C.registerType(e.constructor))),this.NODES.forEach((e=>l.C.registerType(e.constructor))))}}ModelSerializer.NODES=new Map,ModelSerializer.SERVICES=new Map,ModelSerializer._modules=new Set},750:(e,t,r)=>{function i(e,t){if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0}r.d(t,{o:()=>n});const n={toHexString:function(e){if(e)return e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")},fromHexString:function(e){if(e)return Uint8Array.from(e.match(/.{1,2}/g).map((e=>parseInt(e,16))))},arrayBuffersAreEqual:function(e,t){return i(new DataView(e),new DataView(t))},concatBuffer:function(...e){const t=new Uint8Array(e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)));return e.forEach(((r,i)=>{t.set(r,i>0?e[i-1].byteLength:0)})),t},dataViewsAreEqual:i}},227:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0,n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(i++,"%c"===e&&(n=i))})),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,r)=>{e.exports=function(e){function t(e){let r,n,s,o=null;function a(...e){if(!a.enabled)return;const i=a,n=Number(new Date),s=n-(r||n);i.diff=s,i.prev=r,i.curr=n,r=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,n)=>{if("%%"===r)return"%";o++;const s=t.formatters[n];if("function"==typeof s){const t=e[o];r=s.call(i,t),e.splice(o,1),o--}return r})),t.formatArgs.call(i,e);(i.log||t.log).apply(i,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=i,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(n!==t.namespaces&&(n=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function i(e,r){const i=t(this.namespace+(void 0===r?":":r)+e);return i.log=this.log,i}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(e=i[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},187:e=>{var t,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(r,i){function n(r){e.removeListener(t,s),i(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}y(e,t,s,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,r)}(e,n,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,r,i){var n,s,o,u;if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(n=c(e))>0&&o.length>n&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=l.bind(i);return n.listener=r,i.wrapFn=n,n}function p(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):d(n,n.length)}function _(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function y(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(s){i.once&&e.removeEventListener(t,n),r(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var u=c.length,l=d(c,u);for(r=0;r<u;++r)i(l[r],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,i,n,s,o;if(a(t),void 0===(i=this._events))return this;if(void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)"removeListener"!==(n=s[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_.call(e,t)},s.prototype.listenerCount=_,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},898:e=>{e.exports=e=>!!e&&("symbol"==typeof Symbol.observable&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},465:(e,t,r)=>{e=r.nmd(e);var i="__lodash_hash_undefined__",n=9007199254740991,s="[object Arguments]",o="[object Boolean]",a="[object Date]",c="[object Function]",u="[object GeneratorFunction]",l="[object Map]",h="[object Number]",p="[object Object]",_="[object Promise]",d="[object RegExp]",y="[object Set]",f="[object String]",m="[object Symbol]",b="[object WeakMap]",v="[object ArrayBuffer]",g="[object DataView]",w="[object Float32Array]",x="[object Float64Array]",M="[object Int8Array]",E="[object Int16Array]",k="[object Int32Array]",S="[object Uint8Array]",P="[object Uint8ClampedArray]",N="[object Uint16Array]",T="[object Uint32Array]",z=/\w*$/,A=/^\[object .+?Constructor\]$/,D=/^(?:0|[1-9]\d*)$/,O={};O[s]=O["[object Array]"]=O[v]=O[g]=O[o]=O[a]=O[w]=O[x]=O[M]=O[E]=O[k]=O[l]=O[h]=O[p]=O[d]=O[y]=O[f]=O[m]=O[S]=O[P]=O[N]=O[T]=!0,O["[object Error]"]=O[c]=O[b]=!1;var C="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,j="object"==typeof self&&self&&self.Object===Object&&self,R=C||j||Function("return this")(),U=t&&!t.nodeType&&t,I=U&&e&&!e.nodeType&&e,F=I&&I.exports===U;function L(e,t){return e.set(t[0],t[1]),e}function V(e,t){return e.add(t),e}function B(e,t,r,i){var n=-1,s=e?e.length:0;for(i&&s&&(r=e[++n]);++n<s;)r=t(r,e[n],n,e);return r}function W(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function $(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r}function H(e,t){return function(r){return e(t(r))}}function G(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var q,K=Array.prototype,Q=Function.prototype,J=Object.prototype,Z=R["__core-js_shared__"],Y=(q=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",X=Q.toString,ee=J.hasOwnProperty,te=J.toString,re=RegExp("^"+X.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ie=F?R.Buffer:void 0,ne=R.Symbol,se=R.Uint8Array,oe=H(Object.getPrototypeOf,Object),ae=Object.create,ce=J.propertyIsEnumerable,ue=K.splice,le=Object.getOwnPropertySymbols,he=ie?ie.isBuffer:void 0,pe=H(Object.keys,Object),_e=Ie(R,"DataView"),de=Ie(R,"Map"),ye=Ie(R,"Promise"),fe=Ie(R,"Set"),me=Ie(R,"WeakMap"),be=Ie(Object,"create"),ve=We(_e),ge=We(de),we=We(ye),xe=We(fe),Me=We(me),Ee=ne?ne.prototype:void 0,ke=Ee?Ee.valueOf:void 0;function Se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function Pe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function Ne(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function Te(e){this.__data__=new Pe(e)}function ze(e,t){var r=He(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ge(e)}(e)&&ee.call(e,"callee")&&(!ce.call(e,"callee")||te.call(e)==s)}(e)?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,n=!!i;for(var o in e)!t&&!ee.call(e,o)||n&&("length"==o||Ve(o,i))||r.push(o);return r}function Ae(e,t,r){var i=e[t];ee.call(e,t)&&$e(i,r)&&(void 0!==r||t in e)||(e[t]=r)}function De(e,t){for(var r=e.length;r--;)if($e(e[r][0],t))return r;return-1}function Oe(e,t,r,i,n,_,b){var A;if(i&&(A=_?i(e,n,_,b):i(e)),void 0!==A)return A;if(!Qe(e))return e;var D=He(e);if(D){if(A=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&ee.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,i=e.length;t||(t=Array(i));for(;++r<i;)t[r]=e[r];return t}(e,A)}else{var C=Le(e),j=C==c||C==u;if(qe(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(C==p||C==s||j&&!_){if(W(e))return _?e:{};if(A=function(e){return"function"!=typeof e.constructor||Be(e)?{}:(t=oe(e),Qe(t)?ae(t):{});var t}(j?{}:e),!t)return function(e,t){return Re(e,Fe(e),t)}(e,function(e,t){return e&&Re(t,Je(t),e)}(A,e))}else{if(!O[C])return _?e:{};A=function(e,t,r,i){var n=e.constructor;switch(t){case v:return je(e);case o:case a:return new n(+e);case g:return function(e,t){var r=t?je(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,i);case w:case x:case M:case E:case k:case S:case P:case N:case T:return function(e,t){var r=t?je(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,i);case l:return function(e,t,r){var i=t?r($(e),!0):$(e);return B(i,L,new e.constructor)}(e,i,r);case h:case f:return new n(e);case d:return function(e){var t=new e.constructor(e.source,z.exec(e));return t.lastIndex=e.lastIndex,t}(e);case y:return function(e,t,r){var i=t?r(G(e),!0):G(e);return B(i,V,new e.constructor)}(e,i,r);case m:return s=e,ke?Object(ke.call(s)):{}}var s}(e,C,Oe,t)}}b||(b=new Te);var R=b.get(e);if(R)return R;if(b.set(e,A),!D)var U=r?function(e){return function(e,t,r){var i=t(e);return He(e)?i:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(i,r(e))}(e,Je,Fe)}(e):Je(e);return function(e,t){for(var r=-1,i=e?e.length:0;++r<i&&!1!==t(e[r],r,e););}(U||e,(function(n,s){U&&(n=e[s=n]),Ae(A,s,Oe(n,t,r,i,s,e,b))})),A}function Ce(e){return!(!Qe(e)||(t=e,Y&&Y in t))&&(Ke(e)||W(e)?re:A).test(We(e));var t}function je(e){var t=new e.constructor(e.byteLength);return new se(t).set(new se(e)),t}function Re(e,t,r,i){r||(r={});for(var n=-1,s=t.length;++n<s;){var o=t[n],a=i?i(r[o],e[o],o,r,e):void 0;Ae(r,o,void 0===a?e[o]:a)}return r}function Ue(e,t){var r,i,n=e.__data__;return("string"==(i=typeof(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function Ie(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Ce(r)?r:void 0}Se.prototype.clear=function(){this.__data__=be?be(null):{}},Se.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Se.prototype.get=function(e){var t=this.__data__;if(be){var r=t[e];return r===i?void 0:r}return ee.call(t,e)?t[e]:void 0},Se.prototype.has=function(e){var t=this.__data__;return be?void 0!==t[e]:ee.call(t,e)},Se.prototype.set=function(e,t){return this.__data__[e]=be&&void 0===t?i:t,this},Pe.prototype.clear=function(){this.__data__=[]},Pe.prototype.delete=function(e){var t=this.__data__,r=De(t,e);return!(r<0)&&(r==t.length-1?t.pop():ue.call(t,r,1),!0)},Pe.prototype.get=function(e){var t=this.__data__,r=De(t,e);return r<0?void 0:t[r][1]},Pe.prototype.has=function(e){return De(this.__data__,e)>-1},Pe.prototype.set=function(e,t){var r=this.__data__,i=De(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},Ne.prototype.clear=function(){this.__data__={hash:new Se,map:new(de||Pe),string:new Se}},Ne.prototype.delete=function(e){return Ue(this,e).delete(e)},Ne.prototype.get=function(e){return Ue(this,e).get(e)},Ne.prototype.has=function(e){return Ue(this,e).has(e)},Ne.prototype.set=function(e,t){return Ue(this,e).set(e,t),this},Te.prototype.clear=function(){this.__data__=new Pe},Te.prototype.delete=function(e){return this.__data__.delete(e)},Te.prototype.get=function(e){return this.__data__.get(e)},Te.prototype.has=function(e){return this.__data__.has(e)},Te.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Pe){var i=r.__data__;if(!de||i.length<199)return i.push([e,t]),this;r=this.__data__=new Ne(i)}return r.set(e,t),this};var Fe=le?H(le,Object):function(){return[]},Le=function(e){return te.call(e)};function Ve(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||D.test(e))&&e>-1&&e%1==0&&e<t}function Be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||J)}function We(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function $e(e,t){return e===t||e!=e&&t!=t}(_e&&Le(new _e(new ArrayBuffer(1)))!=g||de&&Le(new de)!=l||ye&&Le(ye.resolve())!=_||fe&&Le(new fe)!=y||me&&Le(new me)!=b)&&(Le=function(e){var t=te.call(e),r=t==p?e.constructor:void 0,i=r?We(r):void 0;if(i)switch(i){case ve:return g;case ge:return l;case we:return _;case xe:return y;case Me:return b}return t});var He=Array.isArray;function Ge(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!Ke(e)}var qe=he||function(){return!1};function Ke(e){var t=Qe(e)?te.call(e):"";return t==c||t==u}function Qe(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Je(e){return Ge(e)?ze(e):function(e){if(!Be(e))return pe(e);var t=[];for(var r in Object(e))ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Oe(e,!0,!0)}},824:e=>{var t=1e3,r=60*t,i=60*r,n=24*i,s=7*n,o=365.25*n;function a(e,t,r,i){var n=t>=1.5*r;return Math.round(e/r)+" "+i+(n?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var s=Math.abs(e);if(s>=n)return a(e,s,n,"day");if(s>=i)return a(e,s,i,"hour");if(s>=r)return a(e,s,r,"minute");if(s>=t)return a(e,s,t,"second");return e+" ms"}(e):function(e){var s=Math.abs(e);if(s>=n)return Math.round(e/n)+"d";if(s>=i)return Math.round(e/i)+"h";if(s>=r)return Math.round(e/r)+"m";if(s>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},49:(e,t,r)=>{r.r(t),r.d(t,{Observable:()=>b,Subject:()=>T,filter:()=>w,flatMap:()=>E,interval:()=>k,map:()=>P,merge:()=>N,multicast:()=>z,scan:()=>D,unsubscribe:()=>v});var i=function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class AsyncSerialScheduler{constructor(e){this._baseObserver=e,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then((()=>this._baseObserver.complete())).catch((e=>this._baseObserver.error(e)))}error(e){this._baseObserver.error(e)}schedule(e){const t=Promise.all(this._pendingPromises),r=[],n=e=>r.push(e),s=Promise.resolve().then((()=>i(this,void 0,void 0,(function*(){yield t,yield e(n),this._pendingPromises.delete(s);for(const e of r)this._baseObserver.next(e)})))).catch((e=>{this._pendingPromises.delete(s),this._baseObserver.error(e)}));this._pendingPromises.add(s)}}const n=()=>"function"==typeof Symbol,s=e=>n()&&Boolean(Symbol[e]),o=e=>s(e)?Symbol[e]:"@@"+e;s("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const a=o("iterator"),c=o("observable"),u=o("species");function l(e,t){const r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function h(e){let t=e.constructor;return void 0!==t&&(t=t[u],null===t&&(t=void 0)),void 0!==t?t:Observable}function p(e){p.log?p.log(e):setTimeout((()=>{throw e}),0)}function _(e){Promise.resolve().then((()=>{try{e()}catch(e){p(e)}}))}function d(e){const t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{const e=l(t,"unsubscribe");e&&e.call(t)}}catch(e){p(e)}}function y(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function f(e,t,r){e._state="running";const i=e._observer;try{const n=i?l(i,t):void 0;switch(t){case"next":n&&n.call(i,r);break;case"error":if(y(e),!n)throw r;n.call(i,r);break;case"complete":y(e),n&&n.call(i)}}catch(e){p(e)}"closed"===e._state?d(e):"running"===e._state&&(e._state="ready")}function m(e,t,r){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:r})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void _((()=>function(e){const t=e._queue;if(t){e._queue=void 0,e._state="ready";for(const r of t)if(f(e,r.type,r.value),"closed"===e._state)break}}(e)))):void f(e,t,r)}class Subscription{constructor(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const r=new SubscriptionObserver(this);try{this._cleanup=t.call(void 0,r)}catch(e){r.error(e)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(y(this),d(this))}}class SubscriptionObserver{constructor(e){this._subscription=e}get closed(){return"closed"===this._subscription._state}next(e){m(this._subscription,"next",e)}error(e){m(this._subscription,"error",e)}complete(){m(this._subscription,"complete")}}class Observable{constructor(e){if(!(this instanceof Observable))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,t,r){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:r}),new Subscription(e,this._subscriber)}pipe(e,...t){let r=this;for(const i of[e,...t])r=i(r);return r}tap(e,t,r){const i="object"!=typeof e||null===e?{next:e,error:t,complete:r}:e;return new Observable((e=>this.subscribe({next(t){i.next&&i.next(t),e.next(t)},error(t){i.error&&i.error(t),e.error(t)},complete(){i.complete&&i.complete(),e.complete()},start(e){i.start&&i.start(e)}})))}forEach(e){return new Promise(((t,r)=>{if("function"!=typeof e)return void r(new TypeError(e+" is not a function"));function i(){n.unsubscribe(),t(void 0)}const n=this.subscribe({next(t){try{e(t,i)}catch(e){r(e),n.unsubscribe()}},error(e){r(e)},complete(){t(void 0)}})}))}map(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(h(this))((t=>this.subscribe({next(r){let i=r;try{i=e(r)}catch(e){return t.error(e)}t.next(i)},error(e){t.error(e)},complete(){t.complete()}})))}filter(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(h(this))((t=>this.subscribe({next(r){try{if(!e(r))return}catch(e){return t.error(e)}t.next(r)},error(e){t.error(e)},complete(){t.complete()}})))}reduce(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");const r=h(this),i=arguments.length>1;let n=!1,s=t;return new r((t=>this.subscribe({next(r){const o=!n;if(n=!0,!o||i)try{s=e(s,r)}catch(e){return t.error(e)}else s=r},error(e){t.error(e)},complete(){if(!n&&!i)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(s),t.complete()}})))}concat(...e){const t=h(this);return new t((r=>{let i,n=0;return function s(o){i=o.subscribe({next(e){r.next(e)},error(e){r.error(e)},complete(){n===e.length?(i=void 0,r.complete()):s(t.from(e[n++]))}})}(this),()=>{i&&(i.unsubscribe(),i=void 0)}}))}flatMap(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");const t=h(this);return new t((r=>{const i=[],n=this.subscribe({next(n){let o;if(e)try{o=e(n)}catch(e){return r.error(e)}else o=n;const a=t.from(o).subscribe({next(e){r.next(e)},error(e){r.error(e)},complete(){const e=i.indexOf(a);e>=0&&i.splice(e,1),s()}});i.push(a)},error(e){r.error(e)},complete(){s()}});function s(){n.closed&&0===i.length&&r.complete()}return()=>{i.forEach((e=>e.unsubscribe())),n.unsubscribe()}}))}[(Symbol.observable,c)](){return this}static from(e){const t="function"==typeof this?this:Observable;if(null==e)throw new TypeError(e+" is not an object");const r=l(e,c);if(r){const i=r.call(e);if(Object(i)!==i)throw new TypeError(i+" is not an object");return function(e){return e instanceof Observable}(i)&&i.constructor===t?i:new t((e=>i.subscribe(e)))}if(s("iterator")){const r=l(e,a);if(r)return new t((t=>{_((()=>{if(!t.closed){for(const i of r.call(e))if(t.next(i),t.closed)return;t.complete()}}))}))}if(Array.isArray(e))return new t((t=>{_((()=>{if(!t.closed){for(const r of e)if(t.next(r),t.closed)return;t.complete()}}))}));throw new TypeError(e+" is not observable")}static of(...e){return new("function"==typeof this?this:Observable)((t=>{_((()=>{if(!t.closed){for(const r of e)if(t.next(r),t.closed)return;t.complete()}}))}))}static get[u](){return this}}n()&&Object.defineProperty(Observable,Symbol("extensions"),{value:{symbol:c,hostReportError:p},configurable:!0});const b=Observable;const v=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()};var g=function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const w=function(e){return t=>new b((r=>{const i=new AsyncSerialScheduler(r),n=t.subscribe({complete(){i.complete()},error(e){i.error(e)},next(t){i.schedule((r=>g(this,void 0,void 0,(function*(){(yield e(t))&&r(t)}))))}});return()=>v(n)}))};var x=function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},M=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){(function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)})(i,n,(t=e[r](t)).done,t.value)}))}}};const E=function(e){return t=>new b((r=>{const i=new AsyncSerialScheduler(r),n=t.subscribe({complete(){i.complete()},error(e){i.error(e)},next(t){i.schedule((r=>x(this,void 0,void 0,(function*(){var i,n;const o=yield e(t);if((u=o)&&s("iterator")&&u[Symbol.iterator]||function(e){return e&&s("asyncIterator")&&e[Symbol.asyncIterator]}(o))try{for(var a,c=M(o);!(a=yield c.next()).done;){const e=a.value;r(e)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=c.return)&&(yield n.call(c))}finally{if(i)throw i.error}}else o.map((e=>r(e)));var u}))))}});return()=>v(n)}))};function k(e){return new Observable((t=>{let r=0;const i=setInterval((()=>{t.next(r++)}),e);return()=>clearInterval(i)}))}var S=function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const P=function(e){return t=>new b((r=>{const i=new AsyncSerialScheduler(r),n=t.subscribe({complete(){i.complete()},error(e){i.error(e)},next(t){i.schedule((r=>S(this,void 0,void 0,(function*(){const i=yield e(t);r(i)}))))}});return()=>v(n)}))};const N=function(...e){return 0===e.length?Observable.from([]):new Observable((t=>{let r=0;const i=e.map((i=>i.subscribe({error(e){t.error(e),n()},next(e){t.next(e)},complete(){++r===e.length&&(t.complete(),n())}}))),n=()=>{i.forEach((e=>v(e)))};return n}))};const T=class MulticastSubject extends b{constructor(){super((e=>(this._observers.add(e),()=>this._observers.delete(e)))),this._observers=new Set}next(e){for(const t of this._observers)t.next(e)}error(e){for(const t of this._observers)t.error(e)}complete(){for(const e of this._observers)e.complete()}};const z=function(e){const t=new T;let r,i=0;return new b((n=>{r||(r=e.subscribe(t));const s=t.subscribe(n);return i++,()=>{i--,s.unsubscribe(),0===i&&(v(r),r=void 0)}}))};var A=function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const D=function(e,t){return r=>new b((i=>{let n,s=0;const o=new AsyncSerialScheduler(i),a=r.subscribe({complete(){o.complete()},error(e){o.error(e)},next(r){o.schedule((i=>A(this,void 0,void 0,(function*(){const o=0===s?void 0===t?r:t:n;n=yield e(o,r,s++),i(n)}))))}});return()=>v(a)}))}},660:(e,t,r)=>{var i;!function(e){!function(t){var i="object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=s(e);function s(e,t){return function(r,i){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0===i.Reflect?i.Reflect=e:n=s(i.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",n=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,o={__proto__:[]}instanceof Array,a=!s&&!o,c={create:s?function(){return ie(Object.create(null))}:o?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:a?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,p=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,_=new(l||"function"!=typeof WeakMap?re():WeakMap);function d(e,t,r,i){if(j(r)){if(!$(e))throw new TypeError;if(!G(t))throw new TypeError;return E(e,t)}if(!$(e))throw new TypeError;if(!I(t))throw new TypeError;if(!I(i)&&!j(i)&&!R(i))throw new TypeError;return R(i)&&(i=void 0),k(e,t,r=W(r),i)}function y(e,t){function r(r,i){if(!I(r))throw new TypeError;if(!j(i)&&!q(i))throw new TypeError;A(e,t,r,i)}return r}function f(e,t,r,i){if(!I(r))throw new TypeError;return j(i)||(i=W(i)),A(e,t,r,i)}function m(e,t,r){if(!I(t))throw new TypeError;return j(r)||(r=W(r)),P(e,t,r)}function b(e,t,r){if(!I(t))throw new TypeError;return j(r)||(r=W(r)),N(e,t,r)}function v(e,t,r){if(!I(t))throw new TypeError;return j(r)||(r=W(r)),T(e,t,r)}function g(e,t,r){if(!I(t))throw new TypeError;return j(r)||(r=W(r)),z(e,t,r)}function w(e,t){if(!I(e))throw new TypeError;return j(t)||(t=W(t)),D(e,t)}function x(e,t){if(!I(e))throw new TypeError;return j(t)||(t=W(t)),O(e,t)}function M(e,t,r){if(!I(t))throw new TypeError;j(r)||(r=W(r));var i=S(t,r,!1);if(j(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var n=_.get(t);return n.delete(r),n.size>0||_.delete(t),!0}function E(e,t){for(var r=e.length-1;r>=0;--r){var i=(0,e[r])(t);if(!j(i)&&!R(i)){if(!G(i))throw new TypeError;t=i}}return t}function k(e,t,r,i){for(var n=e.length-1;n>=0;--n){var s=(0,e[n])(t,r,i);if(!j(s)&&!R(s)){if(!I(s))throw new TypeError;i=s}}return i}function S(e,t,r){var i=_.get(e);if(j(i)){if(!r)return;i=new h,_.set(e,i)}var n=i.get(t);if(j(n)){if(!r)return;n=new h,i.set(t,n)}return n}function P(e,t,r){if(N(e,t,r))return!0;var i=X(t);return!R(i)&&P(e,i,r)}function N(e,t,r){var i=S(t,r,!1);return!j(i)&&V(i.has(e))}function T(e,t,r){if(N(e,t,r))return z(e,t,r);var i=X(t);return R(i)?void 0:T(e,i,r)}function z(e,t,r){var i=S(t,r,!1);if(!j(i))return i.get(e)}function A(e,t,r,i){S(r,i,!0).set(e,t)}function D(e,t){var r=O(e,t),i=X(e);if(null===i)return r;var n=D(i,t);if(n.length<=0)return r;if(r.length<=0)return n;for(var s=new p,o=[],a=0,c=r;a<c.length;a++){var u=c[a];s.has(u)||(s.add(u),o.push(u))}for(var l=0,h=n;l<h.length;l++){u=h[l];s.has(u)||(s.add(u),o.push(u))}return o}function O(e,t){var r=[],i=S(e,t,!1);if(j(i))return r;for(var n=Q(i.keys()),s=0;;){var o=Z(n);if(!o)return r.length=s,r;var a=J(o);try{r[s]=a}catch(e){try{Y(n)}finally{throw e}}s++}}function C(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function j(e){return void 0===e}function R(e){return null===e}function U(e){return"symbol"==typeof e}function I(e){return"object"==typeof e?null!==e:"function"==typeof e}function F(e,t){switch(C(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=K(e,i);if(void 0!==n){var s=n.call(e,r);if(I(s))throw new TypeError;return s}return L(e,"default"===r?"number":r)}function L(e,t){if("string"===t){var r=e.toString;if(H(r))if(!I(n=r.call(e)))return n;if(H(i=e.valueOf))if(!I(n=i.call(e)))return n}else{var i;if(H(i=e.valueOf))if(!I(n=i.call(e)))return n;var n,s=e.toString;if(H(s))if(!I(n=s.call(e)))return n}throw new TypeError}function V(e){return!!e}function B(e){return""+e}function W(e){var t=F(e,3);return U(t)?t:B(t)}function $(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function H(e){return"function"==typeof e}function G(e){return"function"==typeof e}function q(e){switch(C(e)){case 3:case 4:return!0;default:return!1}}function K(e,t){var r=e[t];if(null!=r){if(!H(r))throw new TypeError;return r}}function Q(e){var t=K(e,n);if(!H(t))throw new TypeError;var r=t.call(e);if(!I(r))throw new TypeError;return r}function J(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function Y(e){var t=e.return;t&&t.call(e)}function X(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[n]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,i)},t.prototype.values=function(){return new r(this._keys,this._values,s)},t.prototype.entries=function(){return new r(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[n]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function s(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[n]=function(){return this.keys()},e}()}function re(){var e=16,r=c.create(),i=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=s(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=s(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return s(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=s(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var e;do{e="@@WeakMap@@"+u()}while(c.has(r,e));return r[e]=!0,e}function s(e,r){if(!t.call(e,i)){if(!r)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",i=0;i<e;++i){var n=t[i];4!==i&&6!==i&&8!==i||(r+="-"),n<16&&(r+="0"),r+=n.toString(16).toLowerCase()}return r}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",d),e("metadata",y),e("defineMetadata",f),e("hasMetadata",m),e("hasOwnMetadata",b),e("getMetadata",v),e("getOwnMetadata",g),e("getMetadataKeys",w),e("getOwnMetadataKeys",x),e("deleteMetadata",M)}(n)}()}(i||(i={}))},467:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserialize=t.registerSerializer=void 0;const i=r(381);let n=i.DefaultSerializer;t.registerSerializer=function(e){n=i.extendSerializer(n,e)},t.deserialize=function(e){return n.deserialize(e)},t.serialize=function(e){return n.serialize(e)}},734:function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.DefaultSerializer=t.expose=t.registerSerializer=void 0;var s=r(467);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return s.registerSerializer}}),n(r(63),t);var o=r(934);Object.defineProperty(t,"expose",{enumerable:!0,get:function(){return o.expose}});var a=r(381);Object.defineProperty(t,"DefaultSerializer",{enumerable:!0,get:function(){return a.DefaultSerializer}});var c=r(180);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return c.Transfer}})},211:(e,t)=>{let r;function i(e){return(""+e).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.getBundleURL=t.getBaseURL=void 0,t.getBundleURL=function(){return r||(r=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return i(t[0])}return"/"}()),r},t.getBaseURL=i},390:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerRuntime=t.getWorkerImplementation=t.defaultPoolSize=void 0;const i=r(211);t.defaultPoolSize="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;const n=e=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(e);function s(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}let o;t.getWorkerImplementation=function(){return o||(o=function(){if("undefined"==typeof Worker)return class NoWebWorker{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class WebWorker extends Worker{constructor(e,t){var r,o;"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!n(e)&&i.getBundleURL().match(/^file:\/\//i)&&(e=new URL(e,i.getBundleURL().replace(/\/[^\/]+$/,"/")),(null===(r=null==t?void 0:t.CORSWorkaround)||void 0===r||r)&&(e=s(`importScripts(${JSON.stringify(e)});`))),"string"==typeof e&&n(e)&&(null===(o=null==t?void 0:t.CORSWorkaround)||void 0===o||o)&&(e=s(`importScripts(${JSON.stringify(e)});`)),super(e,t)}}class BlobWorker extends WebWorker{constructor(e,t){super(window.URL.createObjectURL(e),t)}static fromText(e,t){const r=new window.Blob([e],{type:"text/javascript"});return new BlobWorker(r,t)}}return{blob:BlobWorker,default:WebWorker}}()),o},t.isWorkerRuntime=function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)}},63:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Worker=t.BlobWorker=t.isWorkerRuntime=t.Thread=t.spawn=t.Pool=void 0;const i=r(390);Object.defineProperty(t,"isWorkerRuntime",{enumerable:!0,get:function(){return i.isWorkerRuntime}});var n=r(483);Object.defineProperty(t,"Pool",{enumerable:!0,get:function(){return n.Pool}});var s=r(264);Object.defineProperty(t,"spawn",{enumerable:!0,get:function(){return s.spawn}});var o=r(235);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return o.Thread}}),t.BlobWorker=i.getWorkerImplementation().blob,t.Worker=i.getWorkerImplementation().default},891:function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createProxyModule=t.createProxyFunction=void 0;const n=i(r(227)),s=r(49),o=r(467),a=r(15),c=r(180),u=r(229),l=n.default("threads:master:messages");let h=1;const p=e=>Array.from(new Set(e)),_=e=>e&&e.type===u.WorkerMessageType.error,d=e=>e&&e.type===u.WorkerMessageType.result,y=e=>e&&e.type===u.WorkerMessageType.running;function f(e,t){return(...r)=>{const i=h++,{args:n,transferables:f}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],r=[];for(const i of e)c.isTransferDescriptor(i)?(t.push(o.serialize(i.send)),r.push(...i.transferables)):t.push(o.serialize(i));return{args:t,transferables:0===r.length?r:p(r)}}(r),m={type:u.MasterMessageType.run,uid:i,method:t,args:n};l("Sending command to run function to worker:",m);try{e.postMessage(m,f)}catch(e){return a.ObservablePromise.from(Promise.reject(e))}return a.ObservablePromise.from(s.multicast(function(e,t){return new s.Observable((r=>{let i;const n=s=>{if(l("Message from worker:",s.data),s.data&&s.data.uid===t)if(y(s.data))i=s.data.resultType;else if(d(s.data))"promise"===i?(void 0!==s.data.payload&&r.next(o.deserialize(s.data.payload)),r.complete(),e.removeEventListener("message",n)):(s.data.payload&&r.next(o.deserialize(s.data.payload)),s.data.complete&&(r.complete(),e.removeEventListener("message",n)));else if(_(s.data)){const t=o.deserialize(s.data.error);r.error(t),e.removeEventListener("message",n)}};return e.addEventListener("message",n),()=>{if("observable"===i||!i){const r={type:u.MasterMessageType.cancel,uid:t};e.postMessage(r)}e.removeEventListener("message",n)}}))}(e,i)))}}t.createProxyFunction=f,t.createProxyModule=function(e,t){const r={};for(const i of t)r[i]=f(e,i);return r}},774:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PoolEventType=void 0,function(e){e.initialized="initialized",e.taskCanceled="taskCanceled",e.taskCompleted="taskCompleted",e.taskFailed="taskFailed",e.taskQueued="taskQueued",e.taskQueueDrained="taskQueueDrained",e.taskStart="taskStart",e.terminated="terminated"}(t.PoolEventType||(t.PoolEventType={}))},483:function(e,t,r){var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pool=t.Thread=t.PoolEventType=void 0;const s=n(r(227)),o=r(49),a=r(531),c=r(390),u=r(774);Object.defineProperty(t,"PoolEventType",{enumerable:!0,get:function(){return u.PoolEventType}});const l=r(235);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return l.Thread}});let h=1;class WorkerPool{constructor(e,t){this.eventSubject=new o.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const r="number"==typeof t?{size:t}:t||{},{size:i=c.defaultPoolSize}=r;var n;this.debug=s.default(`threads:pool:${n=r.name||String(h++),n.replace(/\W/g," ").trim().replace(/\s+/g,"-")}`),this.options=r,this.workers=function(e,t){return function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t}(t).map((()=>({init:e(),runningTasks:[]})))}(e,i),this.eventObservable=o.multicast(o.Observable.from(this.eventSubject)),Promise.all(this.workers.map((e=>e.init))).then((()=>this.eventSubject.next({type:u.PoolEventType.initialized,size:this.workers.length})),(e=>{this.debug("Error while initializing pool worker:",e),this.eventSubject.error(e),this.initErrors.push(e)}))}findIdlingWorker(){const{concurrency:e=1}=this.options;return this.workers.find((t=>t.runningTasks.length<e))}runPoolTask(e,t){return i(this,void 0,void 0,(function*(){const r=this.workers.indexOf(e)+1;this.debug(`Running task #${t.id} on worker #${r}...`),this.eventSubject.next({type:u.PoolEventType.taskStart,taskID:t.id,workerID:r});try{const i=yield t.run(yield e.init);this.debug(`Task #${t.id} completed successfully`),this.eventSubject.next({type:u.PoolEventType.taskCompleted,returnValue:i,taskID:t.id,workerID:r})}catch(e){this.debug(`Task #${t.id} failed`),this.eventSubject.next({type:u.PoolEventType.taskFailed,taskID:t.id,error:e,workerID:r})}}))}run(e,t){return i(this,void 0,void 0,(function*(){const r=(()=>i(this,void 0,void 0,(function*(){var i;yield(i=0,new Promise((e=>setTimeout(e,i))));try{yield this.runPoolTask(e,t)}finally{e.runningTasks=e.runningTasks.filter((e=>e!==r)),this.isClosing||this.scheduleWork()}})))();e.runningTasks.push(r)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const e=this.findIdlingWorker();if(!e)return;const t=this.taskQueue.shift();if(!t)return this.debug("Task queue is empty"),void this.eventSubject.next({type:u.PoolEventType.taskQueueDrained});this.run(e,t)}taskCompletion(e){return new Promise(((t,r)=>{const i=this.events().subscribe((n=>{n.type===u.PoolEventType.taskCompleted&&n.taskID===e?(i.unsubscribe(),t(n.returnValue)):n.type===u.PoolEventType.taskFailed&&n.taskID===e?(i.unsubscribe(),r(n.error)):n.type===u.PoolEventType.terminated&&(i.unsubscribe(),r(Error("Pool has been terminated before task was run.")))}))}))}settled(e=!1){return i(this,void 0,void 0,(function*(){const t=()=>{return e=this.workers,t=e=>e.runningTasks,e.reduce(((e,r)=>[...e,...t(r)]),[]);var e,t},r=[],i=this.eventObservable.subscribe((e=>{e.type===u.PoolEventType.taskFailed&&r.push(e.error)}));return this.initErrors.length>0?Promise.reject(this.initErrors[0]):e&&0===this.taskQueue.length?(yield a.allSettled(t()),r):(yield new Promise(((e,t)=>{const r=this.eventObservable.subscribe({next(t){t.type===u.PoolEventType.taskQueueDrained&&(r.unsubscribe(),e(void 0))},error:t})})),yield a.allSettled(t()),i.unsubscribe(),r)}))}completed(e=!1){return i(this,void 0,void 0,(function*(){const t=this.settled(e),r=new Promise(((e,r)=>{const i=this.eventObservable.subscribe({next(n){n.type===u.PoolEventType.taskQueueDrained?(i.unsubscribe(),e(t)):n.type===u.PoolEventType.taskFailed&&(i.unsubscribe(),r(n.error))},error:r})})),i=yield Promise.race([t,r]);if(i.length>0)throw i[0]}))}events(){return this.eventObservable}queue(e){const{maxQueuedJobs:t=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const r=this.nextTaskID++,i=this.taskCompletion(r);i.catch((e=>{this.debug(`Task #${r} errored:`,e)}));const n={id:r,run:e,cancel:()=>{-1!==this.taskQueue.indexOf(n)&&(this.taskQueue=this.taskQueue.filter((e=>e!==n)),this.eventSubject.next({type:u.PoolEventType.taskCanceled,taskID:n.id}))},then:i.then.bind(i)};if(this.taskQueue.length>=t)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${n.id}...`),this.taskQueue.push(n),this.eventSubject.next({type:u.PoolEventType.taskQueued,taskID:n.id}),this.scheduleWork(),n}terminate(e){return i(this,void 0,void 0,(function*(){this.isClosing=!0,e||(yield this.completed(!0)),this.eventSubject.next({type:u.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map((e=>i(this,void 0,void 0,(function*(){return l.Thread.terminate(yield e.init)})))))}))}}function p(e,t){return new WorkerPool(e,t)}WorkerPool.EventType=u.PoolEventType,p.EventType=u.PoolEventType,t.Pool=p},264:function(e,t,r){var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.spawn=void 0;const s=n(r(227)),o=r(49),a=r(467),c=r(104),u=r(258),l=r(356),h=r(891),p=s.default("threads:master:messages"),_=s.default("threads:master:spawn"),d=s.default("threads:master:thread-utils"),y=e=>e&&"init"===e.type,f=e=>e&&"uncaughtError"===e.type,m="undefined"!=typeof process&&process.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(process.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function b(e,t,r,i){const n=r.filter((e=>e.type===l.WorkerEventType.internalError)).map((e=>e.error));return Object.assign(e,{[u.$errors]:n,[u.$events]:r,[u.$terminate]:i,[u.$worker]:t})}t.spawn=function(e,t){return i(this,void 0,void 0,(function*(){_("Initializing new thread");const r=t&&t.timeout?t.timeout:m,n=yield function(e,t,r){return i(this,void 0,void 0,(function*(){let i;const n=new Promise(((e,n)=>{i=setTimeout((()=>n(Error(r))),t)})),s=yield Promise.race([e,n]);return clearTimeout(i),s}))}(function(e){return new Promise(((t,r)=>{const i=n=>{p("Message from worker before finishing initialization:",n.data),y(n.data)?(e.removeEventListener("message",i),t(n.data)):f(n.data)&&(e.removeEventListener("message",i),r(a.deserialize(n.data.error)))};e.addEventListener("message",i)}))}(e),r,`Timeout: Did not receive an init message from worker after ${r}ms. Make sure the worker calls expose().`),s=n.exposed,{termination:u,terminate:v}=function(e){const[t,r]=c.createPromiseWithResolver();return{terminate:()=>i(this,void 0,void 0,(function*(){d("Terminating worker"),yield e.terminate(),r()})),termination:t}}(e),g=function(e,t){return new o.Observable((r=>{const i=e=>{const t={type:l.WorkerEventType.message,data:e.data};r.next(t)},n=e=>{d("Unhandled promise rejection event in thread:",e);const t={type:l.WorkerEventType.internalError,error:Error(e.reason)};r.next(t)};e.addEventListener("message",i),e.addEventListener("unhandledrejection",n),t.then((()=>{const t={type:l.WorkerEventType.termination};e.removeEventListener("message",i),e.removeEventListener("unhandledrejection",n),r.next(t),r.complete()}))}))}(e,u);if("function"===s.type){return b(h.createProxyFunction(e),e,g,v)}if("module"===s.type){return b(h.createProxyModule(e,s.methods),e,g,v)}{const e=s.type;throw Error(`Worker init message states unexpected type of expose(): ${e}`)}}))}},235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const i=r(258);function n(e){throw Error(e)}t.Thread={errors:e=>e[i.$errors]||n("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:e=>e[i.$events]||n("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:e=>e[i.$terminate]()}},15:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObservablePromise=void 0;const i=r(49),n=()=>{},s=e=>e,o=e=>Promise.resolve().then(e);function a(e){throw e}class ObservablePromise extends i.Observable{constructor(e){super((t=>{const r=this,i=Object.assign(Object.assign({},t),{complete(){t.complete(),r.onCompletion()},error(e){t.error(e),r.onError(e)},next(e){t.next(e),r.onNext(e)}});try{return this.initHasRun=!0,e(i)}catch(e){i.error(e)}})),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)o((()=>t(e)))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)o((()=>e(this.firstValue)))}then(e,t){const r=e||s,i=t||a;let n=!1;return new Promise(((e,t)=>{const s=r=>{if(!n){n=!0;try{e(i(r))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:s}),"fulfilled"===this.state?e(r(this.firstValue)):"rejected"===this.state?(n=!0,e(i(this.rejection))):(this.fulfillmentCallbacks.push((t=>{try{e(r(t))}catch(e){s(e)}})),void this.rejectionCallbacks.push(s))}))}catch(e){return this.then(void 0,e)}finally(e){const t=e||n;return this.then((e=>(t(),e)),(()=>t()))}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new ObservablePromise((t=>{e.then((e=>{t.next(e),t.complete()}),(e=>{t.error(e)}))})):super.from(e)}}t.ObservablePromise=ObservablePromise},531:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.allSettled=void 0,t.allSettled=function(e){return Promise.all(e.map((e=>{const t=e=>({status:"fulfilled",value:e}),r=e=>({status:"rejected",reason:e}),i=Promise.resolve(e);try{return i.then(t,r)}catch(e){return Promise.reject(e)}})))}},104:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPromiseWithResolver=void 0;const r=()=>{};t.createPromiseWithResolver=function(){let e,t=!1,i=r;return[new Promise((r=>{t?r(e):i=r})),r=>{t=!0,e=r,i(e)}]}},381:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultSerializer=t.extendSerializer=void 0,t.extendSerializer=function(e,t){const r=e.deserialize.bind(e),i=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,r),serialize:e=>t.serialize(e,i)}};const r={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})};t.DefaultSerializer={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r.deserialize(e):e;var t},serialize:e=>e instanceof Error?r.serialize(e):e}},258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.$worker=t.$transferable=t.$terminate=t.$events=t.$errors=void 0,t.$errors=Symbol("thread.errors"),t.$events=Symbol("thread.events"),t.$terminate=Symbol("thread.terminate"),t.$transferable=Symbol("thread.transferable"),t.$worker=Symbol("thread.worker")},180:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.isTransferDescriptor=void 0;const i=r(258);t.isTransferDescriptor=function(e){return e&&"object"==typeof e&&e[i.$transferable]},t.Transfer=function(e,t){if(!t){if(!(r=e)||"object"!=typeof r)throw Error();t=[e]}var r;return{[i.$transferable]:!0,send:e,transferables:t}}},356:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerEventType=void 0;r(258);!function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(t.WorkerEventType||(t.WorkerEventType={}))},229:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageType=t.MasterMessageType=void 0,function(e){e.cancel="cancel",e.run="run"}(t.MasterMessageType||(t.MasterMessageType={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(t.WorkerMessageType||(t.WorkerMessageType={}))},398:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default={isWorkerRuntime:function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}},934:function(e,t,r){var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expose=t.isWorkerRuntime=t.Transfer=t.registerSerializer=void 0;const s=n(r(898)),o=r(467),a=r(180),c=r(229),u=n(r(398));var l=r(467);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var h=r(180);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return h.Transfer}}),t.isWorkerRuntime=u.default.isWorkerRuntime;let p=!1;const _=new Map,d=e=>e&&e.type===c.MasterMessageType.run,y=e=>s.default(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e);function f(e){return a.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function m(e,t){const{payload:r,transferables:i}=f(t),n={type:c.WorkerMessageType.error,uid:e,error:o.serialize(r)};u.default.postMessageToMaster(n,i)}function b(e,t,r){const{payload:i,transferables:n}=f(r),s={type:c.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:i};u.default.postMessageToMaster(s,n)}function v(e){try{const t={type:c.WorkerMessageType.uncaughtError,error:o.serialize(e)};u.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}function g(e,t,r){return i(this,void 0,void 0,(function*(){let i;try{i=t(...r)}catch(t){return m(e,t)}const n=y(i)?"observable":"promise";if(function(e,t){const r={type:c.WorkerMessageType.running,uid:e,resultType:t};u.default.postMessageToMaster(r)}(e,n),y(i)){const t=i.subscribe((t=>b(e,!1,o.serialize(t))),(t=>{m(e,o.serialize(t)),_.delete(e)}),(()=>{b(e,!0),_.delete(e)}));_.set(e,t)}else try{const t=yield i;b(e,!0,o.serialize(t))}catch(t){m(e,o.serialize(t))}}))}t.expose=function(e){if(!u.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(p)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(p=!0,"function"==typeof e)u.default.subscribeToMasterMessages((t=>{d(t)&&!t.method&&g(t.uid,e,t.args.map(o.deserialize))})),function(){const e={type:c.WorkerMessageType.init,exposed:{type:"function"}};u.default.postMessageToMaster(e)}();else{if("object"!=typeof e||!e)throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);u.default.subscribeToMasterMessages((t=>{d(t)&&t.method&&g(t.uid,e[t.method],t.args.map(o.deserialize))}));!function(e){const t={type:c.WorkerMessageType.init,exposed:{type:"module",methods:e}};u.default.postMessageToMaster(t)}(Object.keys(e).filter((t=>"function"==typeof e[t])))}u.default.subscribeToMasterMessages((e=>{if((t=e)&&t.type===c.MasterMessageType.cancel){const t=e.uid,r=_.get(t);r&&(r.unsubscribe(),_.delete(t))}var t}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&u.default.isWorkerRuntime()&&(self.addEventListener("error",(e=>{setTimeout((()=>v(e.error||e)),250)})),self.addEventListener("unhandledrejection",(e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout((()=>v(t)),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&u.default.isWorkerRuntime()&&(process.on("uncaughtException",(e=>{setTimeout((()=>v(e)),250)})),process.on("unhandledRejection",(e=>{e&&"string"==typeof e.message&&setTimeout((()=>v(e)),250)})))},188:(e,t,r)=>{r.d(t,{Z:()=>c,m:()=>a});var i=r(77),n=r(606),s=r(651),o=r(665);function a(e,t){if(null!=e.__type)return t.get(e.__type)}var c=function(){function e(){this.typeResolver=a,this.errorHandler=i.H,this.deserializationStrategy=new Map([[o.IK.ctor,i.yR],[Number,p],[String,p],[Boolean,p],[Date,f],[ArrayBuffer,m],[DataView,b],[Array,_],[Set,d],[Map,y],[Float32Array,g],[Float64Array,g],[Uint8Array,w],[Uint8ClampedArray,w],[Uint16Array,w],[Uint32Array,w]])}return e.prototype.setDeserializationStrategy=function(e,t){this.deserializationStrategy.set(e,t)},e.prototype.setNameResolver=function(e){this.nameResolver=e},e.prototype.setTypeResolver=function(e){if("function"!=typeof e)throw new TypeError("'typeResolverCallback' is not a function.");this.typeResolver=e},e.prototype.getTypeResolver=function(){return this.typeResolver},e.prototype.setErrorHandler=function(e){if("function"!=typeof e)throw new TypeError("'errorHandlerCallback' is not a function.");this.errorHandler=e},e.prototype.getErrorHandler=function(){return this.errorHandler},e.prototype.convertSingleValue=function(e,t,r,a,c){if(void 0===a&&(a="object"),this.retrievePreserveNull(c)&&null===e)return null;if((0,i.Jf)(e)){var u=this.deserializationStrategy.get(t.ctor);if(void 0!==u)return u(e,t,r,a,this,c);if("object"==typeof e)return function(e,t,r,a,c){if("object"!=typeof e||null===e)return void c.getErrorHandler()(new TypeError("Cannot deserialize "+a+": 'sourceObject' must be a defined object."));var u=t.ctor,l=n.WR.getFromConstructor(u),h=r,p=c.getTypeResolver();void 0!==l&&(l.processDeferredKnownTypes(),h=c.mergeKnownTypes(h,c.createKnownTypesMap(l.knownTypes)),null!=l.typeResolver&&(p=l.typeResolver));var _=p(e,h);null!=_&&(0,i.me)(_,u)&&(u=_,void 0!==(l=n.WR.getFromConstructor(_))&&(h=c.mergeKnownTypes(h,c.createKnownTypesMap(l.knownTypes))));if(!0===(null==l?void 0:l.isExplicitlyMarked)){var d=l,y={},f=(0,s.JH)(c.options,d.options);d.dataMembers.forEach((function(t,n){var a,u=e[n],l=(0,i.$0)(d.classType)+"."+n,p=(0,s.JH)(f,t.options);if(null!=t.deserializer)a=t.deserializer(u,{fallback:function(e,t){return c.convertSingleValue(e,(0,o._k)(t),r)}});else{if(null==t.type)throw new TypeError("Cannot deserialize "+l+" there is no constructor nor deserialization function to use.");a=c.convertSingleValue(u,t.type(),h,l,p)}(0,i.Jf)(a)||c.retrievePreserveNull(p)&&null===a?y[t.key]=a:!0===t.isRequired&&c.getErrorHandler()(new TypeError("Missing required member '"+l+"'."))}));var m=void 0;if("function"==typeof l.initializerCallback)try{if(null==(m=l.initializerCallback(y,e)))throw new TypeError("Cannot deserialize "+a+": 'initializer' function returned undefined/null, but '"+(0,i.$0)(l.classType)+"' was expected.");if(!(m instanceof l.classType))throw new TypeError("Cannot deserialize "+a+":'initializer' returned '"+(0,i.$0)(m.constructor)+"', but '"+(0,i.$0)(l.classType)+"' was expected, and '"+(0,i.$0)(m.constructor)+"' is not a subtype of '"+(0,i.$0)(l.classType)+"'")}catch(e){return void c.getErrorHandler()(e)}else m=c.instantiateType(u);Object.assign(m,y);var b=l.onDeserializedMethodName;return null!=b&&("function"==typeof m[b]?m[b]():"function"==typeof m.constructor[b]?m.constructor[b]():c.getErrorHandler()(new TypeError("onDeserialized callback'"+(0,i.$0)(l.classType)+"."+b+"' is not a method."))),m}var v={};return Object.keys(e).forEach((function(t){v[t]=c.convertSingleValue(e[t],new o.h2(e[t].constructor),r,t)})),v}(e,t,r,a,this);var l="Could not deserialize '"+a+"'; don't know how to deserialize type";t.hasFriendlyName()&&(l+=" '"+t.ctor.name+"'"),this.errorHandler(new TypeError(l+"."))}},e.prototype.instantiateType=function(e){return new e},e.prototype.mergeKnownTypes=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=new Map;return t.forEach((function(t){t.forEach((function(t,r){void 0===e.nameResolver?i.set(r,t):i.set(e.nameResolver(t),t)}))})),i},e.prototype.createKnownTypesMap=function(e){var t=this,r=new Map;return e.forEach((function(e){if(void 0===t.nameResolver){var i=n.WR.getFromConstructor(e),s=!0===(null==i?void 0:i.isExplicitlyMarked)?i.name:null;r.set(null!=s?s:e.name,e)}else r.set(t.nameResolver(e),e)})),r},e.prototype.retrievePreserveNull=function(e){return(0,s.l_)("preserveNull",(0,s.JH)(this.options,e))},e}();function u(e,t,r,i){throw new TypeError("Could not deserialize "+i+" as "+e+": expected "+t+", got "+r+".")}function l(e,t,r){return"Could not deserialize "+r+": expected '"+("function"==typeof e?(0,i.$0)(e):e)+"', got '"+("function"==typeof t?(0,i.$0)(t):t)+"'."}function h(e){return null==e?"undefined":(0,i.$0)(e.constructor)}function p(e,t,r,n){if(e.constructor!==t.ctor)throw new TypeError(l((0,i.$0)(t.ctor),e.constructor,n));return e}function _(e,t,r,i,n,s){if(!(t instanceof o.GJ))throw new TypeError("Could not deserialize "+i+" as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type");return Array.isArray(e)?null==t.elementType?(n.getErrorHandler()(new TypeError("Could not deserialize "+i+" as Array: missing constructor reference of Array elements.")),[]):e.map((function(e,o){try{return n.convertSingleValue(e,t.elementType,r,i+"["+o+"]",s)}catch(e){return void n.getErrorHandler()(e)}})):(n.getErrorHandler()(new TypeError(l(Array,e.constructor,i))),[])}function d(e,t,r,i,n,s){if(!(t instanceof o.do))throw new TypeError("Could not deserialize "+i+" as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(!Array.isArray(e))return n.getErrorHandler()(new TypeError(l(Array,e.constructor,i))),new Set;if(null==t.elementType)return n.getErrorHandler()(new TypeError("Could not deserialize "+i+" as Set: missing constructor reference of Set elements.")),new Set;var a=new Set;return e.forEach((function(e,o){try{a.add(n.convertSingleValue(e,t.elementType,r,i+"["+o+"]",s))}catch(e){n.getErrorHandler()(e)}})),a}function y(e,t,r,n,s,a){if(!(t instanceof o.br))throw new TypeError("Could not deserialize "+n+" as Map: incorrect TypeDescriptor detected,please use proper annotation or function for this type");var c=t.getCompleteOptions().shape;if(!function(e,t){return 0===t&&Array.isArray(e)||1===t&&"object"==typeof e}(e,c)){var u=0===c?Array:Object;return s.getErrorHandler()(new TypeError(l(u,e.constructor,n))),new Map}if(null==t.keyType)return s.getErrorHandler()(new TypeError("Could not deserialize "+n+" as Map: missing key constructor.")),new Map;if(null==t.valueType)return s.getErrorHandler()(new TypeError("Could not deserialize "+n+" as Map: missing value constructor.")),new Map;var h=n+"[].key",p=n+"[].value",_=new Map;return 1===c?Object.keys(e).forEach((function(n){try{var o=s.convertSingleValue(n,t.keyType,r,h,a);(0,i.Jf)(o)&&_.set(o,s.convertSingleValue(e[n],t.valueType,r,p,a))}catch(e){s.getErrorHandler()(e)}})):e.forEach((function(e){try{var n=s.convertSingleValue(e.key,t.keyType,r,h,a);(0,i.Jf)(n)&&_.set(n,s.convertSingleValue(e.value,t.valueType,r,p,a))}catch(e){s.getErrorHandler()(e)}})),_}function f(e,t,r,i){if("number"==typeof e){if(!(e%1==0))throw new TypeError("Could not deserialize "+i+" as Date: expected an integer, got a number with decimal places.");return new Date(e)}return"string"==typeof e?new Date(e):e instanceof Date?e:void u("Date","an ISO-8601 string",h(e),i)}function m(e,t,r,i){return"string"!=typeof e&&u("ArrayBuffer","a string source",h(e),i),v(e)}function b(e,t,r,i){return"string"!=typeof e&&u("DataView","a string source",h(e),i),new DataView(v(e))}function v(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),i=0,n=e.length;i<n;i++)r[i]=e.charCodeAt(i);return t}function g(e,t,r,i){var n=t.ctor;return Array.isArray(e)&&e.every((function(e){return!isNaN(e)}))?new n(e):u(n.name,"a numeric source array",h(e),i)}function w(e,t,r,i){var n=t.ctor;return Array.isArray(e)&&e.every((function(e){return!isNaN(e)}))?new n(e.map((function(e){return~~e}))):u(t.ctor.name,"a numeric source array",h(e),i)}},77:(e,t,r)=>{r.d(t,{$0:()=>f,AZ:()=>o,H:()=>h,Jf:()=>_,KE:()=>p,V9:()=>d,Vf:()=>s,W0:()=>u,by:()=>c,df:()=>y,lW:()=>a,me:()=>l,yR:()=>m});var i=r(582),n=r(665),s="If the type is not yet defined, for example due to circular references, add '() => ' before it. E.g. @jsonMember(() => Foo)",o='Make sure that you have both "experimentalDecorators" and "emitDecoratorMetadata" enabled in your tsconfig.json';function a(e){return-1!==[Date,Number,String,Boolean].indexOf(e)}function c(e){return-1!==[Float32Array,Float64Array,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array].indexOf(e)}function u(e,t){return"string"!=typeof e||function(e,t){var r=t===String||t===ArrayBuffer||t===DataView,i=e.length>=2&&'"'===e[0]&&'"'===e[e.length-1];if(t===Date){var n=!isNaN(Number(e.trim()));return!i&&!n}return r&&!i}(e,t)?e:JSON.parse(e)}function l(e,t){return e===t||e.prototype instanceof t}function h(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.error?console.error.apply(console,(0,i.pr)([e],t)):"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,(0,i.pr)(["ERROR: "+e],t))}function p(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];"object"==typeof console&&"function"==typeof console.warn?console.warn.apply(console,(0,i.pr)([e],t)):"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,(0,i.pr)(["WARNING: "+e],t))}function _(e){return!(null==e)}function d(e,t){return t===n.IK.ctor||("number"==typeof e?t===Number:"string"==typeof e?t===String:"boolean"==typeof e?t===Boolean:!!function(e){return"object"==typeof e}(e)&&e instanceof t)}var y="object"==typeof Reflect&&"function"==typeof Reflect.getMetadata;function f(e){return"string"==typeof e.name?e.name:"undefined"}function m(e){return e}},255:(e,t,r)=>{r.d(t,{R:()=>a});var i=r(77),n=r(606),s=r(651),o=r(665);function a(e,t){var r,a;if("string"!=typeof t&&"symbol"!=typeof t)return r=e,a=t,function(e,t){var c,l,h="@jsonMember on "+(0,i.$0)(e.constructor)+"."+String(t);if((0,o.nW)(r)||(0,o.p3)(r)?l=(0,o.JD)(r,h):a=r,a=null!=a?a:{},Object.prototype.hasOwnProperty.call(a,"constructor")){if(void 0!==l)throw new Error("Cannot both define constructor option and type. Only one allowed.");if(!(0,i.Jf)(a.constructor))return void(0,i.H)(h+": cannot resolve specified property constructor at runtime. "+i.Vf);var p=(0,o._k)(a.constructor);l=function(){return p},i.df&&!(0,i.me)(p.ctor,Reflect.getMetadata("design:type",e,t))&&(0,i.KE)(h+": detected property type does not match 'constructor' option.")}else if(void 0!==l);else if(i.df){var _=Reflect.getMetadata("design:type",e,t);if(null==_)return void(0,i.H)(h+": cannot resolve detected property constructor at runtime. "+i.Vf);l=function(){return(0,o._k)(_)}}else if(void 0===a.deserializer)return void(0,i.H)(h+": Cannot determine type");var d=null==l?void 0:l();void 0!==d&&u(h,d)||(0,n.d3)(e,t,{type:void 0===l?void 0:function(){return(0,o._k)(l())},emitDefaultValue:a.emitDefaultValue,isRequired:a.isRequired,options:(0,s.M3)(a),key:t.toString(),name:null!==(c=a.name)&&void 0!==c?c:t.toString(),deserializer:a.deserializer,serializer:a.serializer})};var c=t,l=e,h="@jsonMember on "+(0,i.$0)(l.constructor)+"."+String(c);if(i.df){var p=Reflect.getMetadata("design:type",l,c);if(null!=p){var _=(0,o._k)(p);u(h,_)||(0,n.d3)(l,c,{type:function(){return _},key:t.toString(),name:t.toString()})}else(0,i.H)(h+": could not resolve detected property constructor at runtime. Potential solutions:\n - "+i.Vf+"\n - "+i.AZ)}else(0,i.H)(h+": ReflectDecorators is required if the type is not explicitly provided with e.g. @jsonMember(Number)")}function c(e,t){return e instanceof o.eh?e.ctor===t:e===t}function u(e,t){return t instanceof o.GJ||!c(t,Array)?t instanceof o.do||!c(t,Set)?!(t instanceof o.br||!c(t,Map))&&((0,i.H)(e+": property is a Map. Use the jsonMapMember decorator to serialize this property."),!0):((0,i.H)(e+": property is a Set. Use the jsonSetMember decorator to serialize this property."),!0):((0,i.H)(e+": property is an Array. Use the jsonArrayMember decorator to serialize this property."),!0)}},606:(e,t,r)=>{r.d(t,{WR:()=>s,d3:()=>o});var i=r(77),n="__typedJsonJsonObjectMetadataInformation__",s=function(){function e(e){this.dataMembers=new Map,this.knownTypes=new Set,this.knownTypesDeferred=[],this.isExplicitlyMarked=!1,this.isHandledWithoutAnnotation=!1,this.classType=e}return e.getJsonObjectName=function(t){var r=e.getFromConstructor(t);return void 0===r?(0,i.$0)(t):(0,i.$0)(r.classType)},e.getFromConstructor=function(t){var r=t.prototype;if(null!=r){var i;if(Object.prototype.hasOwnProperty.call(r,n)&&(i=r[n]),!0===(null==i?void 0:i.isExplicitlyMarked))return i;if(e.doesHandleWithoutAnnotation(t)){var s=new e(t);return s.isExplicitlyMarked=!0,s}}},e.ensurePresentInPrototype=function(t){if(Object.prototype.hasOwnProperty.call(t,n))return t[n];var r=new e(t.constructor),i=t[n];return void 0!==i&&(i.dataMembers.forEach((function(e,t){r.dataMembers.set(t,e)})),i.knownTypes.forEach((function(e){r.knownTypes.add(e)})),r.typeResolver=i.typeResolver,r.typeHintEmitter=i.typeHintEmitter),Object.defineProperty(t,n,{enumerable:!1,configurable:!1,writable:!1,value:r}),r},e.getKnownTypeNameFromType=function(t){var r=e.getFromConstructor(t);return void 0===r?(0,i.$0)(t):(0,i.$0)(r.classType)},e.doesHandleWithoutAnnotation=function(e){return(0,i.lW)(e)||(0,i.by)(e)||e===DataView||e===ArrayBuffer},e.prototype.processDeferredKnownTypes=function(){var e=this;this.knownTypesDeferred.forEach((function(t){t().getTypes().forEach((function(t){return e.knownTypes.add(t)}))})),this.knownTypesDeferred=[]},e}();function o(e,t,r){var n="@jsonMember on "+(0,i.$0)(e.constructor)+"."+String(t);if("function"!=typeof e)if("function"!=typeof e[t])if(null==r||void 0===r.type&&void 0===r.deserializer)(0,i.H)(n+": JsonMemberMetadata has unknown type.");else{var o=s.ensurePresentInPrototype(e);void 0===r.deserializer&&o.knownTypesDeferred.push(r.type),Object.keys(r).forEach((function(e){return void 0===r[e]&&delete r[e]})),o.dataMembers.set(r.name,r)}else(0,i.H)(n+": cannot use a method property.");else(0,i.H)(n+": cannot use a static property.")}},651:(e,t,r)=>{r.d(t,{JH:()=>a,M3:()=>s,l_:()=>o});var i=r(582),n=["preserveNull"];function s(e){var t=Object.keys(e).filter((function(e){return n.indexOf(e)>-1})).reduce((function(t,r){return t[r]=e[r],t}),{});return Object.keys(t).length>0?t:void 0}function o(e,t){return null!=t&&null!=t[e]?t[e]:function(e){return"preserveNull"!==e&&null}(e)}function a(e,t){return null==t?e:(0,i.pi)((0,i.pi)({},e),t)}},844:(e,t,r)=>{r.d(t,{C:()=>c,e:()=>u});var i=r(582),n=r(77),s=r(606),o=r(651),a=r(665);function c(e,t,r,i){var s;t.constructor!==r&&(e.__type=null!==(s=null==i?void 0:i.name)&&void 0!==s?s:(0,n.$0)(t.constructor))}var u=function(){function e(){this.typeHintEmitter=c,this.errorHandler=n.H,this.serializationStrategy=new Map([[a.IK.ctor,n.yR],[Date,n.yR],[Number,n.yR],[String,n.yR],[Boolean,n.yR],[ArrayBuffer,d],[DataView,y],[Array,l],[Set,h],[Map,p],[Float32Array,_],[Float64Array,_],[Int8Array,_],[Uint8Array,_],[Uint8ClampedArray,_],[Int16Array,_],[Uint16Array,_],[Int32Array,_],[Uint32Array,_]])}return e.prototype.setSerializationStrategy=function(e,t){this.serializationStrategy.set(e,t)},e.prototype.setTypeHintEmitter=function(e){if("function"!=typeof e)throw new TypeError("'typeEmitterCallback' is not a function.");this.typeHintEmitter=e},e.prototype.getTypeHintEmitter=function(){return this.typeHintEmitter},e.prototype.setErrorHandler=function(e){if("function"!=typeof e)throw new TypeError("'errorHandlerCallback' is not a function.");this.errorHandler=e},e.prototype.getErrorHandler=function(){return this.errorHandler},e.prototype.retrievePreserveNull=function(e){return(0,o.l_)("preserveNull",(0,o.JH)(this.options,e))},e.prototype.convertSingleValue=function(e,t,r,c){if(void 0===r&&(r="object"),this.retrievePreserveNull(c)&&null===e)return null;if((0,n.Jf)(e))if((0,n.V9)(e,t.ctor)){var u=this.serializationStrategy.get(t.ctor);if(void 0!==u)return u(e,t,r,this,c);if("object"==typeof e)return function(e,t,r,c,u){var l,h,p=c.getTypeHintEmitter();l=e.constructor!==t.ctor&&e instanceof t.ctor?s.WR.getFromConstructor(e.constructor):s.WR.getFromConstructor(t.ctor);if(void 0===l)h=(0,i.pi)({},e);else{var _=l.beforeSerializationMethodName;null!=_&&("function"==typeof e[_]?e[_]():"function"==typeof e.constructor[_]?e.constructor[_]():c.getErrorHandler()(new TypeError("beforeSerialization callback '"+(0,n.$0)(l.classType)+"."+_+"' is not a method.")));var d=l;h={};var y=(0,o.JH)(c.options,d.options);null!=d.typeHintEmitter&&(p=d.typeHintEmitter),d.dataMembers.forEach((function(t){var r,i=(0,o.JH)(y,t.options);if(null!=t.serializer)r=t.serializer(e[t.key],{fallback:function(e,t){return c.convertSingleValue(e,(0,a._k)(t))}});else{if(null==t.type)throw new TypeError("Could not serialize "+t.name+", there is no constructor nor serialization function to use.");r=c.convertSingleValue(e[t.key],t.type(),(0,n.$0)(d.classType)+"."+t.key,i)}(c.retrievePreserveNull(i)&&null===r||(0,n.Jf)(r))&&(h[t.name]=r)}))}return p(h,e,t.ctor,l),h}(e,t,0,this);var l="Could not serialize '"+r+"'; don't know how to serialize type";t.hasFriendlyName()&&(l+=" '"+t.ctor.name+"'"),this.errorHandler(new TypeError(l+"."))}else{var h=(0,n.$0)(t.ctor),p=(0,n.$0)(e.constructor);this.errorHandler(new TypeError("Could not serialize '"+r+"': expected '"+h+"', got '"+p+"'."))}},e}();function l(e,t,r,i,s){if(!(t instanceof a.GJ))throw new TypeError("Could not serialize "+r+" as Array: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(null==t.elementType)throw new TypeError("Could not serialize "+r+" as Array: missing element type definition.");return e.forEach((function(e,o){if(!(i.retrievePreserveNull(s)&&null===e||(0,n.V9)(e,t.elementType.ctor))){var a=(0,n.$0)(t.elementType.ctor),c=e&&(0,n.$0)(e.constructor);throw new TypeError("Could not serialize "+r+"["+o+"]: expected '"+a+"', got '"+c+"'.")}})),e.map((function(e,n){return i.convertSingleValue(e,t.elementType,r+"["+n+"]",s)}))}function h(e,t,r,i,s){if(!(t instanceof a.do))throw new TypeError("Could not serialize "+r+" as Set: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(null==t.elementType)throw new TypeError("Could not serialize "+r+" as Set: missing element type definition.");r+="[]";var o=[];return e.forEach((function(e){var a=i.convertSingleValue(e,t.elementType,r,s);(0,n.Jf)(e)&&!(0,n.Jf)(a)||o.push(a)})),o}function p(e,t,r,i,s){if(!(t instanceof a.br))throw new TypeError("Could not serialize "+r+" as Map: incorrect TypeDescriptor detected, please use proper annotation or function for this type");if(null==t.valueType)throw new TypeError("Could not serialize "+r+" as Map: missing value type definition.");if(null==t.keyType)throw new TypeError("Could not serialize "+r+" as Map: missing key type definition.");var o=r+"[].key",c=r+"[].value",u=t.getCompleteOptions().shape,l=1===u?{}:[],h=i.retrievePreserveNull(s);return e.forEach((function(e,r){var a={key:i.convertSingleValue(r,t.keyType,o,s),value:i.convertSingleValue(e,t.valueType,c,s)},p=(0,n.Jf)(a.key),_=null===a.value&&h||(0,n.Jf)(a.value);p&&_&&(1===u?l[a.key]=a.value:l.push(a))})),l}function _(e){return Array.from(e)}function d(e){return Array.from(new Uint16Array(e)).map((function(e){return String.fromCharCode(e)})).join("")}function y(e){return d(e.buffer)}},665:(e,t,r)=>{r.d(t,{AJ:()=>u,GJ:()=>c,IK:()=>d,JD:()=>b,_k:()=>m,br:()=>p,do:()=>l,eh:()=>s,h2:()=>o,mY:()=>_,nW:()=>y,p3:()=>f,zc:()=>h});var i=r(582),n=r(77),s=function(){function e(e){this.ctor=e}return e.prototype.getTypes=function(){return[this.ctor]},e.prototype.hasFriendlyName=function(){return"Object"!==this.ctor.name},e}(),o=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t}(s),a=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t}(s),c=function(e){function t(t){var r=e.call(this,Array)||this;return r.elementType=t,r}return(0,i.ZT)(t,e),t.prototype.getTypes=function(){return e.prototype.getTypes.call(this).concat(this.elementType.getTypes())},t}(a);function u(e){return new c(m(e))}var l=function(e){function t(t){var r=e.call(this,Set)||this;return r.elementType=t,r}return(0,i.ZT)(t,e),t.prototype.getTypes=function(){return e.prototype.getTypes.call(this).concat(this.elementType.getTypes())},t}(a);function h(e){return new l(m(e))}var p=function(e){function t(t,r,i){var n=e.call(this,Map)||this;return n.keyType=t,n.valueType=r,n.options=i,n}return(0,i.ZT)(t,e),t.prototype.getTypes=function(){return e.prototype.getTypes.call(this).concat(this.keyType.getTypes(),this.valueType.getTypes())},t.prototype.getCompleteOptions=function(){var e,t;return{shape:null!==(t=null===(e=this.options)||void 0===e?void 0:e.shape)&&void 0!==t?t:0}},t}(a);function _(e,t,r){return new p(m(e),m(t),r)}var d=new o((function(){}));function y(e){return null!=e&&("function"==typeof e||e instanceof s)}function f(e){return"function"==typeof e&&""===e.name}function m(e){return e instanceof s?e:new o(e)}function b(e,t){if(null==e)throw new Error("No type given on "+t+". "+n.Vf);return f(e)?e:function(){return e}}},759:()=>{},313:()=>{},801:()=>{},582:(e,t,r)=>{r.d(t,{ZT:()=>n,gn:()=>o,mG:()=>c,pi:()=>s,pr:()=>u,w6:()=>a});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)};function o(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function a(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))}Object.create;function u(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}Object.create;"function"==typeof SuppressedError&&SuppressedError}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.c=__webpack_module_cache__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__=__webpack_require__(__webpack_require__.s=154),__webpack_exports__Absolute2DPosition=__webpack_exports__.Sb,__webpack_exports__Absolute3DPosition=__webpack_exports__.WW,__webpack_exports__AbsoluteOrientationSensor=__webpack_exports__.AO,__webpack_exports__AbsolutePosition=__webpack_exports__.dE,__webpack_exports__Acceleration=__webpack_exports__.Rb,__webpack_exports__AccelerationUnit=__webpack_exports__.tF,__webpack_exports__Accelerometer=__webpack_exports__.M3,__webpack_exports__Accuracy=__webpack_exports__.DO,__webpack_exports__Accuracy1D=__webpack_exports__.Yv,__webpack_exports__Accuracy2D=__webpack_exports__.RM,__webpack_exports__Accuracy3D=__webpack_exports__.PX,__webpack_exports__AccuracyModifierNode=__webpack_exports__.vA,__webpack_exports__ActuatableObject=__webpack_exports__.WV,__webpack_exports__ActuatableProperty=__webpack_exports__.cW,__webpack_exports__AngleUnit=__webpack_exports__.KL,__webpack_exports__AngularVelocity=__webpack_exports__.dt,__webpack_exports__AngularVelocityUnit=__webpack_exports__.m0,__webpack_exports__AxisAngle=__webpack_exports__.lp,__webpack_exports__BalanceNode=__webpack_exports__.wl,__webpack_exports__BufferNode=__webpack_exports__.qz,__webpack_exports__BufferUtils=__webpack_exports__.oY,__webpack_exports__CANBERRA=__webpack_exports__.DX,__webpack_exports__CHEBYSHEV=__webpack_exports__.IS,__webpack_exports__CalibrationNode=__webpack_exports__.Fw,__webpack_exports__CalibrationService=__webpack_exports__.hX,__webpack_exports__CallbackNode=__webpack_exports__.yS,__webpack_exports__CallbackSinkNode=__webpack_exports__.jg,__webpack_exports__CallbackSourceNode=__webpack_exports__.PR,__webpack_exports__CellIdentificationNode=__webpack_exports__.mt,__webpack_exports__ConcreteTypeDescriptor=__webpack_exports__.h2,__webpack_exports__DataFrame=__webpack_exports__.NE,__webpack_exports__DataFrameService=__webpack_exports__.U9,__webpack_exports__DataObject=__webpack_exports__.Lo,__webpack_exports__DataObjectService=__webpack_exports__.J1,__webpack_exports__DataSerializer=__webpack_exports__.CO,__webpack_exports__DataSerializerUtils=__webpack_exports__.jL,__webpack_exports__DataService=__webpack_exports__.Do,__webpack_exports__DataServiceDriver=__webpack_exports__.yW,__webpack_exports__DerivedUnit=__webpack_exports__.x9,__webpack_exports__Deserializer=__webpack_exports__.ZK,__webpack_exports__DummyDataService=__webpack_exports__.mW,__webpack_exports__DummyService=__webpack_exports__.sx,__webpack_exports__EMAFilterNode=__webpack_exports__.qv,__webpack_exports__EUCLIDEAN=__webpack_exports__.yt,__webpack_exports__Edge=__webpack_exports__.kS,__webpack_exports__Euler=__webpack_exports__.US,__webpack_exports__FilterProcessingNode=__webpack_exports__.dD,__webpack_exports__FrameChunkNode=__webpack_exports__.M$,__webpack_exports__FrameCloneNode=__webpack_exports__.Kq,__webpack_exports__FrameDelayNode=__webpack_exports__.To,__webpack_exports__FrameFilterNode=__webpack_exports__.cm,__webpack_exports__FrameFlattenNode=__webpack_exports__.fj,__webpack_exports__FrameMergeNode=__webpack_exports__.HW,__webpack_exports__GCS=__webpack_exports__._N,__webpack_exports__GeographicalPosition=__webpack_exports__.sX,__webpack_exports__GraphBuilder=__webpack_exports__.iX,__webpack_exports__GraphShapeBuilder=__webpack_exports__.tg,__webpack_exports__GraphShapeNode=__webpack_exports__.ym,__webpack_exports__GravitySensor=__webpack_exports__.vM,__webpack_exports__Gyroscope=__webpack_exports__.ad,__webpack_exports__HAVERSINE=__webpack_exports__.zd,__webpack_exports__HPFilterNode=__webpack_exports__.JG,__webpack_exports__HistorySourceNode=__webpack_exports__.SQ,__webpack_exports__Humidity=__webpack_exports__.Dn,__webpack_exports__KalmanFilter=__webpack_exports__.M0,__webpack_exports__KalmanFilterNode=__webpack_exports__.su,__webpack_exports__KeyValueDataService=__webpack_exports__._v,__webpack_exports__LPFilterNode=__webpack_exports__.Mj,__webpack_exports__LengthUnit=__webpack_exports__.MD,__webpack_exports__LinearAccelerationSensor=__webpack_exports__.Mn,__webpack_exports__LinearVelocity=__webpack_exports__.uE,__webpack_exports__LinearVelocitySensor=__webpack_exports__.v5,__webpack_exports__LinearVelocityUnit=__webpack_exports__.hi,__webpack_exports__ListSourceNode=__webpack_exports__.Nv,__webpack_exports__LocationBasedService=__webpack_exports__.xJ,__webpack_exports__LoggingSinkNode=__webpack_exports__.WA,__webpack_exports__LuminanceIntensityUnit=__webpack_exports__.cN,__webpack_exports__LuminanceUnit=__webpack_exports__.to,__webpack_exports__MANHATTAN=__webpack_exports__.iz,__webpack_exports__Magnetism=__webpack_exports__.rE,__webpack_exports__MagnetismUnit=__webpack_exports__.Oy,__webpack_exports__Magnetometer=__webpack_exports__.N7,__webpack_exports__Matrix3=__webpack_exports__.Vk,__webpack_exports__Matrix4=__webpack_exports__.yG,__webpack_exports__MemoryBufferNode=__webpack_exports__.n,__webpack_exports__MemoryDataService=__webpack_exports__.Zs,__webpack_exports__MemoryQueryEvaluator=__webpack_exports__.oF,__webpack_exports__MergeShape=__webpack_exports__.KH,__webpack_exports__ModelBuilder=__webpack_exports__.gm,__webpack_exports__ModelSerializer=__webpack_exports__.Nx,__webpack_exports__MultilaterationNode=__webpack_exports__.od,__webpack_exports__Node=__webpack_exports__.NB,__webpack_exports__NodeData=__webpack_exports__.Z5,__webpack_exports__NodeDataService=__webpack_exports__.IG,__webpack_exports__NumberType=__webpack_exports__.sw,__webpack_exports__ObjectMergeNode=__webpack_exports__.Ko,__webpack_exports__ObjectProcessingNode=__webpack_exports__.rQ,__webpack_exports__Orientation=__webpack_exports__.i5,__webpack_exports__Pose=__webpack_exports__.DJ,__webpack_exports__Pressure=__webpack_exports__.wD,__webpack_exports__PressureUnit=__webpack_exports__.jU,__webpack_exports__ProcessingNode=__webpack_exports__.xk,__webpack_exports__PropertyFilterProcessingNode=__webpack_exports__.cS,__webpack_exports__PushError=__webpack_exports__.FD,__webpack_exports__Quaternion=__webpack_exports__._f,__webpack_exports__ReferenceSpace=__webpack_exports__.kG,__webpack_exports__ReferenceSpaceConversionNode=__webpack_exports__.ow,__webpack_exports__Relative2DPosition=__webpack_exports__.MV,__webpack_exports__Relative3DPosition=__webpack_exports__._o,__webpack_exports__RelativeAngle=__webpack_exports__.E4,__webpack_exports__RelativeAngularVelocity=__webpack_exports__.Hd,__webpack_exports__RelativeDistance=__webpack_exports__.N1,__webpack_exports__RelativeLinearVelocity=__webpack_exports__.vZ,__webpack_exports__RelativeOrientation=__webpack_exports__.ur,__webpack_exports__RelativeOrientationSensor=__webpack_exports__.FW,__webpack_exports__RelativePosition=__webpack_exports__.Zi,__webpack_exports__RelativePositionFilter=__webpack_exports__.EU,__webpack_exports__RelativePositionProcessing=__webpack_exports__.Qm,__webpack_exports__RemoteNode=__webpack_exports__.VF,__webpack_exports__RemoteService=__webpack_exports__.K2,__webpack_exports__RemoteServiceProxy=__webpack_exports__.Zk,__webpack_exports__RemoteSinkNode=__webpack_exports__.qH,__webpack_exports__RemoteSourceNode=__webpack_exports__.Mg,__webpack_exports__SMAFilterNode=__webpack_exports__.Ms,__webpack_exports__SensorCalibrationData=__webpack_exports__.wK,__webpack_exports__SensorObject=__webpack_exports__.ci,__webpack_exports__SensorValue=__webpack_exports__.GO,__webpack_exports__SerializableArrayMember=__webpack_exports__.hZ,__webpack_exports__SerializableMapMember=__webpack_exports__.bc,__webpack_exports__SerializableMember=__webpack_exports__._J,__webpack_exports__SerializableMemberFunction=__webpack_exports__.X,__webpack_exports__SerializableObject=__webpack_exports__.iN,__webpack_exports__SerializableSetMember=__webpack_exports__.F6,__webpack_exports__SerializationUtils=__webpack_exports__.Cn,__webpack_exports__Serializer=__webpack_exports__.ei,__webpack_exports__Service=__webpack_exports__.t6,__webpack_exports__SinkNode=__webpack_exports__.cb,__webpack_exports__SourceMergeNode=__webpack_exports__.sh,__webpack_exports__SourceNode=__webpack_exports__.lW,__webpack_exports__Temperature=__webpack_exports__.In,__webpack_exports__TemperatureUnit=__webpack_exports__.kU,__webpack_exports__ThrottleNode=__webpack_exports__.Bx,__webpack_exports__TimeService=__webpack_exports__.OY,__webpack_exports__TimeSyncNode=__webpack_exports__.$i,__webpack_exports__TimeUnit=__webpack_exports__.j1,__webpack_exports__TimedPullNode=__webpack_exports__.wz,__webpack_exports__Trajectory=__webpack_exports__.D_,__webpack_exports__TrajectoryService=__webpack_exports__.Op,__webpack_exports__TriangulationNode=__webpack_exports__.as,__webpack_exports__TypeDescriptor=__webpack_exports__.eh,__webpack_exports__TypedJSON=__webpack_exports__.r5,__webpack_exports__UUID=__webpack_exports__.hb,__webpack_exports__Unit=__webpack_exports__.fb,__webpack_exports__UnitConversionNode=__webpack_exports__.A8,__webpack_exports__UnitPrefix=__webpack_exports__.O7,__webpack_exports__UnitValue=__webpack_exports__.Zw,__webpack_exports__Vector2=__webpack_exports__.FM,__webpack_exports__Vector3=__webpack_exports__.P,__webpack_exports__Vector4=__webpack_exports__.Lt,__webpack_exports__Velocity=__webpack_exports__.Mk,__webpack_exports__WorkerHandler=__webpack_exports__.Yc,__webpack_exports__WorkerNode=__webpack_exports__.cX,__webpack_exports__WorkerServiceProxy=__webpack_exports__.o8,__webpack_exports__mergeMemberOptions=__webpack_exports__.W5,__webpack_exports__updateSerializableMember=__webpack_exports__.EB,__webpack_exports__updateSerializableObject=__webpack_exports__.hs;export{__webpack_exports__Absolute2DPosition as Absolute2DPosition,__webpack_exports__Absolute3DPosition as Absolute3DPosition,__webpack_exports__AbsoluteOrientationSensor as AbsoluteOrientationSensor,__webpack_exports__AbsolutePosition as AbsolutePosition,__webpack_exports__Acceleration as Acceleration,__webpack_exports__AccelerationUnit as AccelerationUnit,__webpack_exports__Accelerometer as Accelerometer,__webpack_exports__Accuracy as Accuracy,__webpack_exports__Accuracy1D as Accuracy1D,__webpack_exports__Accuracy2D as Accuracy2D,__webpack_exports__Accuracy3D as Accuracy3D,__webpack_exports__AccuracyModifierNode as AccuracyModifierNode,__webpack_exports__ActuatableObject as ActuatableObject,__webpack_exports__ActuatableProperty as ActuatableProperty,__webpack_exports__AngleUnit as AngleUnit,__webpack_exports__AngularVelocity as AngularVelocity,__webpack_exports__AngularVelocityUnit as AngularVelocityUnit,__webpack_exports__AxisAngle as AxisAngle,__webpack_exports__BalanceNode as BalanceNode,__webpack_exports__BufferNode as BufferNode,__webpack_exports__BufferUtils as BufferUtils,__webpack_exports__CANBERRA as CANBERRA,__webpack_exports__CHEBYSHEV as CHEBYSHEV,__webpack_exports__CalibrationNode as CalibrationNode,__webpack_exports__CalibrationService as CalibrationService,__webpack_exports__CallbackNode as CallbackNode,__webpack_exports__CallbackSinkNode as CallbackSinkNode,__webpack_exports__CallbackSourceNode as CallbackSourceNode,__webpack_exports__CellIdentificationNode as CellIdentificationNode,__webpack_exports__ConcreteTypeDescriptor as ConcreteTypeDescriptor,__webpack_exports__DataFrame as DataFrame,__webpack_exports__DataFrameService as DataFrameService,__webpack_exports__DataObject as DataObject,__webpack_exports__DataObjectService as DataObjectService,__webpack_exports__DataSerializer as DataSerializer,__webpack_exports__DataSerializerUtils as DataSerializerUtils,__webpack_exports__DataService as DataService,__webpack_exports__DataServiceDriver as DataServiceDriver,__webpack_exports__DerivedUnit as DerivedUnit,__webpack_exports__Deserializer as Deserializer,__webpack_exports__DummyDataService as DummyDataService,__webpack_exports__DummyService as DummyService,__webpack_exports__EMAFilterNode as EMAFilterNode,__webpack_exports__EUCLIDEAN as EUCLIDEAN,__webpack_exports__Edge as Edge,__webpack_exports__Euler as Euler,__webpack_exports__FilterProcessingNode as FilterProcessingNode,__webpack_exports__FrameChunkNode as FrameChunkNode,__webpack_exports__FrameCloneNode as FrameCloneNode,__webpack_exports__FrameDelayNode as FrameDelayNode,__webpack_exports__FrameFilterNode as FrameFilterNode,__webpack_exports__FrameFlattenNode as FrameFlattenNode,__webpack_exports__FrameMergeNode as FrameMergeNode,__webpack_exports__GCS as GCS,__webpack_exports__GeographicalPosition as GeographicalPosition,__webpack_exports__GraphBuilder as GraphBuilder,__webpack_exports__GraphShapeBuilder as GraphShapeBuilder,__webpack_exports__GraphShapeNode as GraphShapeNode,__webpack_exports__GravitySensor as GravitySensor,__webpack_exports__Gyroscope as Gyroscope,__webpack_exports__HAVERSINE as HAVERSINE,__webpack_exports__HPFilterNode as HPFilterNode,__webpack_exports__HistorySourceNode as HistorySourceNode,__webpack_exports__Humidity as Humidity,__webpack_exports__KalmanFilter as KalmanFilter,__webpack_exports__KalmanFilterNode as KalmanFilterNode,__webpack_exports__KeyValueDataService as KeyValueDataService,__webpack_exports__LPFilterNode as LPFilterNode,__webpack_exports__LengthUnit as LengthUnit,__webpack_exports__LinearAccelerationSensor as LinearAccelerationSensor,__webpack_exports__LinearVelocity as LinearVelocity,__webpack_exports__LinearVelocitySensor as LinearVelocitySensor,__webpack_exports__LinearVelocityUnit as LinearVelocityUnit,__webpack_exports__ListSourceNode as ListSourceNode,__webpack_exports__LocationBasedService as LocationBasedService,__webpack_exports__LoggingSinkNode as LoggingSinkNode,__webpack_exports__LuminanceIntensityUnit as LuminanceIntensityUnit,__webpack_exports__LuminanceUnit as LuminanceUnit,__webpack_exports__MANHATTAN as MANHATTAN,__webpack_exports__Magnetism as Magnetism,__webpack_exports__MagnetismUnit as MagnetismUnit,__webpack_exports__Magnetometer as Magnetometer,__webpack_exports__Matrix3 as Matrix3,__webpack_exports__Matrix4 as Matrix4,__webpack_exports__MemoryBufferNode as MemoryBufferNode,__webpack_exports__MemoryDataService as MemoryDataService,__webpack_exports__MemoryQueryEvaluator as MemoryQueryEvaluator,__webpack_exports__MergeShape as MergeShape,__webpack_exports__ModelBuilder as ModelBuilder,__webpack_exports__ModelSerializer as ModelSerializer,__webpack_exports__MultilaterationNode as MultilaterationNode,__webpack_exports__Node as Node,__webpack_exports__NodeData as NodeData,__webpack_exports__NodeDataService as NodeDataService,__webpack_exports__NumberType as NumberType,__webpack_exports__ObjectMergeNode as ObjectMergeNode,__webpack_exports__ObjectProcessingNode as ObjectProcessingNode,__webpack_exports__Orientation as Orientation,__webpack_exports__Pose as Pose,__webpack_exports__Pressure as Pressure,__webpack_exports__PressureUnit as PressureUnit,__webpack_exports__ProcessingNode as ProcessingNode,__webpack_exports__PropertyFilterProcessingNode as PropertyFilterProcessingNode,__webpack_exports__PushError as PushError,__webpack_exports__Quaternion as Quaternion,__webpack_exports__ReferenceSpace as ReferenceSpace,__webpack_exports__ReferenceSpaceConversionNode as ReferenceSpaceConversionNode,__webpack_exports__Relative2DPosition as Relative2DPosition,__webpack_exports__Relative3DPosition as Relative3DPosition,__webpack_exports__RelativeAngle as RelativeAngle,__webpack_exports__RelativeAngularVelocity as RelativeAngularVelocity,__webpack_exports__RelativeDistance as RelativeDistance,__webpack_exports__RelativeLinearVelocity as RelativeLinearVelocity,__webpack_exports__RelativeOrientation as RelativeOrientation,__webpack_exports__RelativeOrientationSensor as RelativeOrientationSensor,__webpack_exports__RelativePosition as RelativePosition,__webpack_exports__RelativePositionFilter as RelativePositionFilter,__webpack_exports__RelativePositionProcessing as RelativePositionProcessing,__webpack_exports__RemoteNode as RemoteNode,__webpack_exports__RemoteService as RemoteService,__webpack_exports__RemoteServiceProxy as RemoteServiceProxy,__webpack_exports__RemoteSinkNode as RemoteSinkNode,__webpack_exports__RemoteSourceNode as RemoteSourceNode,__webpack_exports__SMAFilterNode as SMAFilterNode,__webpack_exports__SensorCalibrationData as SensorCalibrationData,__webpack_exports__SensorObject as SensorObject,__webpack_exports__SensorValue as SensorValue,__webpack_exports__SerializableArrayMember as SerializableArrayMember,__webpack_exports__SerializableMapMember as SerializableMapMember,__webpack_exports__SerializableMember as SerializableMember,__webpack_exports__SerializableMemberFunction as SerializableMemberFunction,__webpack_exports__SerializableObject as SerializableObject,__webpack_exports__SerializableSetMember as SerializableSetMember,__webpack_exports__SerializationUtils as SerializationUtils,__webpack_exports__Serializer as Serializer,__webpack_exports__Service as Service,__webpack_exports__SinkNode as SinkNode,__webpack_exports__SourceMergeNode as SourceMergeNode,__webpack_exports__SourceNode as SourceNode,__webpack_exports__Temperature as Temperature,__webpack_exports__TemperatureUnit as TemperatureUnit,__webpack_exports__ThrottleNode as ThrottleNode,__webpack_exports__TimeService as TimeService,__webpack_exports__TimeSyncNode as TimeSyncNode,__webpack_exports__TimeUnit as TimeUnit,__webpack_exports__TimedPullNode as TimedPullNode,__webpack_exports__Trajectory as Trajectory,__webpack_exports__TrajectoryService as TrajectoryService,__webpack_exports__TriangulationNode as TriangulationNode,__webpack_exports__TypeDescriptor as TypeDescriptor,__webpack_exports__TypedJSON as TypedJSON,__webpack_exports__UUID as UUID,__webpack_exports__Unit as Unit,__webpack_exports__UnitConversionNode as UnitConversionNode,__webpack_exports__UnitPrefix as UnitPrefix,__webpack_exports__UnitValue as UnitValue,__webpack_exports__Vector2 as Vector2,__webpack_exports__Vector3 as Vector3,__webpack_exports__Vector4 as Vector4,__webpack_exports__Velocity as Velocity,__webpack_exports__WorkerHandler as WorkerHandler,__webpack_exports__WorkerNode as WorkerNode,__webpack_exports__WorkerServiceProxy as WorkerServiceProxy,__webpack_exports__mergeMemberOptions as mergeMemberOptions,__webpack_exports__updateSerializableMember as updateSerializableMember,__webpack_exports__updateSerializableObject as updateSerializableObject};
//# sourceMappingURL=openhps-core.es.min.js.map